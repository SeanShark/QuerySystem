import{a as b,c as it,aN as $t,f as st,k as ut,bt as Lt,r as H,bl as Pt,w as ne,d as v,aw as xe,x as ct,g as dt,bu as jt,s as Ve,Q as V,a7 as Nt,ac as Et,aU as vt,ab as at,R as Ae,bv as Ft,q as ft,o as Rt,af as It,ay as Vt,D as At,J as ce,K as De,L as j,O as I,N as F,M as Ut,X as Yt,b2 as Pe,T as He,b3 as Qt,b4 as Kt,U as Wt,V as je,t as Jt,Z as Gt,P as Xt,S as Zt}from"./index.c5216a1f.js";import{d as ea}from"./use-panel.b7e29401.js";import{p as ve,t as ta,a as ot,f as aa,g as oa,j as Ne,_ as na,u as la}from"./store.6d6a3883.js";import{Q as ra}from"./QSpace.ff1d4ab4.js";import{a as mt,Q as ia}from"./QPage.15c1a3c0.js";import{Q as sa}from"./QBtnDropdown.23143786.js";import{a as nt,Q as ua}from"./QItemLabel.392feda9.js";import{u as ca,a as da,b as va}from"./use-fullscreen.fe498e6d.js";import{Q as fa,a as ma}from"./QTabPanels.c770706d.js";import{Q as Ee}from"./QSelect.f0b80b75.js";import{C as ha}from"./ClosePopup.3e0fd4d4.js";import"./touch.3df10340.js";import"./axios.7331a07d.js";import"./rtl.b51694b1.js";const ga=["gregorian","persian"],ya={modelValue:{required:!0},mask:{type:String},locale:Object,calendar:{type:String,validator:e=>ga.includes(e),default:"gregorian"},landscape:Boolean,color:String,textColor:String,square:Boolean,flat:Boolean,bordered:Boolean,readonly:Boolean,disable:Boolean},pa=["update:modelValue"];function ae(e){return e.year+"/"+ve(e.month)+"/"+ve(e.day)}function ba(e,a){const l=b(()=>e.disable!==!0&&e.readonly!==!0),s=b(()=>l.value===!0?0:-1),c=b(()=>{const _=[];return e.color!==void 0&&_.push(`bg-${e.color}`),e.textColor!==void 0&&_.push(`text-${e.textColor}`),_.join(" ")});function q(){return e.locale!==void 0?{...a.lang.date,...e.locale}:a.lang.date}function m(_){const M=new Date,P=_===!0?null:0;if(e.calendar==="persian"){const w=ta(M);return{year:w.jy,month:w.jm,day:w.jd}}return{year:M.getFullYear(),month:M.getMonth()+1,day:M.getDate(),hour:P,minute:P,second:P,millisecond:P}}return{editable:l,tabindex:s,headerClass:c,getLocale:q,getCurrentDate:m}}const de=20,_a=["Calendar","Years","Months"],lt=e=>_a.includes(e),Fe=e=>/^-?[\d]+\/[0-1]\d$/.test(e),ge=" \u2014 ";function oe(e){return e.year+"/"+ve(e.month)}var Ca=it({name:"QDate",props:{...ya,...$t,...st,multiple:Boolean,range:Boolean,title:String,subtitle:String,mask:{default:"YYYY/MM/DD"},defaultYearMonth:{type:String,validator:Fe},yearsInMonthView:Boolean,events:[Array,Function],eventColor:[String,Function],emitImmediately:Boolean,options:[Array,Function],navigationMinYearMonth:{type:String,validator:Fe},navigationMaxYearMonth:{type:String,validator:Fe},noUnset:Boolean,firstDayOfWeek:[String,Number],todayBtn:Boolean,minimal:Boolean,defaultView:{type:String,default:"Calendar",validator:lt}},emits:[...pa,"rangeStart","rangeEnd","navigation"],setup(e,{slots:a,emit:l}){const{proxy:s}=dt(),{$q:c}=s,q=ut(e,c),{getCache:m}=ea(),{tabindex:_,headerClass:M,getLocale:P,getCurrentDate:w}=ba(e,c);let N;const D=Lt(e),B=jt(D),Y=H(null),A=H(We()),z=H(P()),Q=b(()=>We()),G=b(()=>P()),k=b(()=>w()),y=H(Je(A.value,z.value)),E=H(e.defaultView),le=c.lang.rtl===!0?"right":"left",R=H(le.value),re=H(le.value),ie=y.value.year,X=H(ie-ie%de-(ie<0?de:0)),p=H(null),h=b(()=>{const t=e.landscape===!0?"landscape":"portrait";return`q-date q-date--${t} q-date--${t}-${e.minimal===!0?"minimal":"standard"}`+(q.value===!0?" q-date--dark q-dark":"")+(e.bordered===!0?" q-date--bordered":"")+(e.square===!0?" q-date--square no-border-radius":"")+(e.flat===!0?" q-date--flat no-shadow":"")+(e.disable===!0?" disabled":e.readonly===!0?" q-date--readonly":"")}),g=b(()=>e.color||"primary"),$=b(()=>e.textColor||"white"),U=b(()=>e.emitImmediately===!0&&e.multiple!==!0&&e.range!==!0),se=b(()=>Array.isArray(e.modelValue)===!0?e.modelValue:e.modelValue!==null&&e.modelValue!==void 0?[e.modelValue]:[]),K=b(()=>se.value.filter(t=>typeof t=="string").map(t=>Me(t,A.value,z.value)).filter(t=>t.dateHash!==null&&t.day!==null&&t.month!==null&&t.year!==null)),Z=b(()=>{const t=o=>Me(o,A.value,z.value);return se.value.filter(o=>Pt(o)===!0&&o.from!==void 0&&o.to!==void 0).map(o=>({from:t(o.from),to:t(o.to)})).filter(o=>o.from.dateHash!==null&&o.to.dateHash!==null&&o.from.dateHash<o.to.dateHash)}),fe=b(()=>e.calendar!=="persian"?t=>new Date(t.year,t.month-1,t.day):t=>{const o=ot(t.year,t.month,t.day);return new Date(o.gy,o.gm-1,o.gd)}),ye=b(()=>e.calendar==="persian"?ae:(t,o,n)=>aa(new Date(t.year,t.month-1,t.day,t.hour,t.minute,t.second,t.millisecond),o===void 0?A.value:o,n===void 0?z.value:n,t.year,t.timezoneOffset)),ee=b(()=>K.value.length+Z.value.reduce((t,o)=>t+1+oa(fe.value(o.to),fe.value(o.from)),0)),pe=b(()=>{if(e.title!==void 0&&e.title!==null&&e.title.length!==0)return e.title;if(p.value!==null){const n=p.value.init,d=fe.value(n);return z.value.daysShort[d.getDay()]+", "+z.value.monthsShort[n.month-1]+" "+n.day+ge+"?"}if(ee.value===0)return ge;if(ee.value>1)return`${ee.value} ${z.value.pluralDay}`;const t=K.value[0],o=fe.value(t);return isNaN(o.valueOf())===!0?ge:z.value.headerTitle!==void 0?z.value.headerTitle(o,t):z.value.daysShort[o.getDay()]+", "+z.value.monthsShort[t.month-1]+" "+t.day}),be=b(()=>K.value.concat(Z.value.map(o=>o.from)).sort((o,n)=>o.year-n.year||o.month-n.month)[0]),_e=b(()=>K.value.concat(Z.value.map(o=>o.to)).sort((o,n)=>n.year-o.year||n.month-o.month)[0]),J=b(()=>{if(e.subtitle!==void 0&&e.subtitle!==null&&e.subtitle.length!==0)return e.subtitle;if(ee.value===0)return ge;if(ee.value>1){const t=be.value,o=_e.value,n=z.value.monthsShort;return n[t.month-1]+(t.year!==o.year?" "+t.year+ge+n[o.month-1]+" ":t.month!==o.month?ge+n[o.month-1]:"")+" "+o.year}return K.value[0].year}),te=b(()=>{const t=[c.iconSet.datetime.arrowLeft,c.iconSet.datetime.arrowRight];return c.lang.rtl===!0?t.reverse():t}),qe=b(()=>e.firstDayOfWeek!==void 0?Number(e.firstDayOfWeek):z.value.firstDayOfWeek),r=b(()=>{const t=z.value.daysShort,o=qe.value;return o>0?t.slice(o,7).concat(t.slice(0,o)):t}),i=b(()=>{const t=y.value;return e.calendar!=="persian"?new Date(t.year,t.month,0).getDate():Ne(t.year,t.month)}),S=b(()=>typeof e.eventColor=="function"?e.eventColor:()=>e.eventColor),x=b(()=>{if(e.navigationMinYearMonth===void 0)return null;const t=e.navigationMinYearMonth.split("/");return{year:parseInt(t[0],10),month:parseInt(t[1],10)}}),L=b(()=>{if(e.navigationMaxYearMonth===void 0)return null;const t=e.navigationMaxYearMonth.split("/");return{year:parseInt(t[0],10),month:parseInt(t[1],10)}}),Ce=b(()=>{const t={month:{prev:!0,next:!0},year:{prev:!0,next:!0}};return x.value!==null&&x.value.year>=y.value.year&&(t.year.prev=!1,x.value.year===y.value.year&&x.value.month>=y.value.month&&(t.month.prev=!1)),L.value!==null&&L.value.year<=y.value.year&&(t.year.next=!1,L.value.year===y.value.year&&L.value.month<=y.value.month&&(t.month.next=!1)),t}),Se=b(()=>{const t={};return K.value.forEach(o=>{const n=oe(o);t[n]===void 0&&(t[n]=[]),t[n].push(o.day)}),t}),Ye=b(()=>{const t={};return Z.value.forEach(o=>{const n=oe(o.from),d=oe(o.to);if(t[n]===void 0&&(t[n]=[]),t[n].push({from:o.from.day,to:n===d?o.to.day:void 0,range:o}),n<d){let u;const{year:T,month:f}=o.from,C=f<12?{year:T,month:f+1}:{year:T+1,month:1};for(;(u=oe(C))<=d;)t[u]===void 0&&(t[u]=[]),t[u].push({from:void 0,to:u===d?o.to.day:void 0,range:o}),C.month++,C.month>12&&(C.year++,C.month=1)}}),t}),ke=b(()=>{if(p.value===null)return;const{init:t,initHash:o,final:n,finalHash:d}=p.value,[u,T]=o<=d?[t,n]:[n,t],f=oe(u),C=oe(T);if(f!==W.value&&C!==W.value)return;const O={};return f===W.value?(O.from=u.day,O.includeFrom=!0):O.from=1,C===W.value?(O.to=T.day,O.includeTo=!0):O.to=i.value,O}),W=b(()=>oe(y.value)),_t=b(()=>{const t={};if(e.options===void 0){for(let n=1;n<=i.value;n++)t[n]=!0;return t}const o=typeof e.options=="function"?e.options:n=>e.options.includes(n);for(let n=1;n<=i.value;n++){const d=W.value+"/"+ve(n);t[n]=o(d)}return t}),Ct=b(()=>{const t={};if(e.events===void 0)for(let o=1;o<=i.value;o++)t[o]=!1;else{const o=typeof e.events=="function"?e.events:n=>e.events.includes(n);for(let n=1;n<=i.value;n++){const d=W.value+"/"+ve(n);t[n]=o(d)===!0&&S.value(d)}}return t}),kt=b(()=>{let t,o;const{year:n,month:d}=y.value;if(e.calendar!=="persian")t=new Date(n,d-1,1),o=new Date(n,d-1,0).getDate();else{const u=ot(n,d,1);t=new Date(u.gy,u.gm-1,u.gd);let T=d-1,f=n;T===0&&(T=12,f--),o=Ne(f,T)}return{days:t.getDay()-qe.value-1,endDay:o}}),Qe=b(()=>{const t=[],{days:o,endDay:n}=kt.value,d=o<0?o+7:o;if(d<6)for(let f=n-d;f<=n;f++)t.push({i:f,fill:!0});const u=t.length;for(let f=1;f<=i.value;f++){const C={i:f,event:Ct.value[f],classes:[]};_t.value[f]===!0&&(C.in=!0,C.flat=!0),t.push(C)}if(Se.value[W.value]!==void 0&&Se.value[W.value].forEach(f=>{const C=u+f-1;Object.assign(t[C],{selected:!0,unelevated:!0,flat:!1,color:g.value,textColor:$.value})}),Ye.value[W.value]!==void 0&&Ye.value[W.value].forEach(f=>{if(f.from!==void 0){const C=u+f.from-1,O=u+(f.to||i.value)-1;for(let we=C;we<=O;we++)Object.assign(t[we],{range:f.range,unelevated:!0,color:g.value,textColor:$.value});Object.assign(t[C],{rangeFrom:!0,flat:!1}),f.to!==void 0&&Object.assign(t[O],{rangeTo:!0,flat:!1})}else if(f.to!==void 0){const C=u+f.to-1;for(let O=u;O<=C;O++)Object.assign(t[O],{range:f.range,unelevated:!0,color:g.value,textColor:$.value});Object.assign(t[C],{flat:!1,rangeTo:!0})}else{const C=u+i.value-1;for(let O=u;O<=C;O++)Object.assign(t[O],{range:f.range,unelevated:!0,color:g.value,textColor:$.value})}}),ke.value!==void 0){const f=u+ke.value.from-1,C=u+ke.value.to-1;for(let O=f;O<=C;O++)t[O].color=g.value,t[O].editRange=!0;ke.value.includeFrom===!0&&(t[f].editRangeFrom=!0),ke.value.includeTo===!0&&(t[C].editRangeTo=!0)}y.value.year===k.value.year&&y.value.month===k.value.month&&(t[u+k.value.day-1].today=!0);const T=t.length%7;if(T>0){const f=7-T;for(let C=1;C<=f;C++)t.push({i:C,fill:!0})}return t.forEach(f=>{let C="q-date__calendar-item ";f.fill===!0?C+="q-date__calendar-item--fill":(C+=`q-date__calendar-item--${f.in===!0?"in":"out"}`,f.range!==void 0&&(C+=` q-date__range${f.rangeTo===!0?"-to":f.rangeFrom===!0?"-from":""}`),f.editRange===!0&&(C+=` q-date__edit-range${f.editRangeFrom===!0?"-from":""}${f.editRangeTo===!0?"-to":""}`),(f.range!==void 0||f.editRange===!0)&&(C+=` text-${f.color}`)),f.classes=C}),t}),wt=b(()=>e.disable===!0?{"aria-disabled":"true"}:e.readonly===!0?{"aria-readonly":"true"}:{});ne(()=>e.modelValue,t=>{if(N===t)N=0;else{const o=Je(A.value,z.value);me(o.year,o.month,o)}}),ne(E,()=>{Y.value!==null&&s.$el.contains(document.activeElement)===!0&&Y.value.focus()}),ne(()=>y.value.year+"|"+y.value.month,()=>{l("navigation",{year:y.value.year,month:y.value.month})}),ne(Q,t=>{tt(t,z.value,"mask"),A.value=t}),ne(G,t=>{tt(A.value,t,"locale"),z.value=t});function Ke(){const t=k.value,o=Se.value[oe(t)];(o===void 0||o.includes(t.day)===!1)&&Be(t),ze(t.year,t.month)}function xt(t){lt(t)===!0&&(E.value=t)}function qt(t,o){["month","year"].includes(t)&&(t==="month"?Xe:Oe)(o===!0?-1:1)}function ze(t,o){E.value="Calendar",me(t,o)}function St(t,o){if(e.range===!1||!t){p.value=null;return}const n=Object.assign({...y.value},t),d=o!==void 0?Object.assign({...y.value},o):n;p.value={init:n,initHash:ae(n),final:d,finalHash:ae(d)},ze(n.year,n.month)}function We(){return e.calendar==="persian"?"YYYY/MM/DD":e.mask}function Me(t,o,n){return na(t,o,n,e.calendar,{hour:0,minute:0,second:0,millisecond:0})}function Je(t,o){const n=Array.isArray(e.modelValue)===!0?e.modelValue:e.modelValue?[e.modelValue]:[];if(n.length===0)return Ge();const d=n[n.length-1],u=Me(d.from!==void 0?d.from:d,t,o);return u.dateHash===null?Ge():u}function Ge(){let t,o;if(e.defaultYearMonth!==void 0){const n=e.defaultYearMonth.split("/");t=parseInt(n[0],10),o=parseInt(n[1],10)}else{const n=k.value!==void 0?k.value:w();t=n.year,o=n.month}return{year:t,month:o,day:1,hour:0,minute:0,second:0,millisecond:0,dateHash:t+"/"+ve(o)+"/01"}}function Xe(t){let o=y.value.year,n=Number(y.value.month)+t;n===13?(n=1,o++):n===0&&(n=12,o--),me(o,n),U.value===!0&&Te("month")}function Oe(t){const o=Number(y.value.year)+t;me(o,y.value.month),U.value===!0&&Te("year")}function Tt(t){me(t,y.value.month),E.value=e.defaultView==="Years"?"Months":"Calendar",U.value===!0&&Te("year")}function Dt(t){me(y.value.year,t),E.value="Calendar",U.value===!0&&Te("month")}function Ht(t,o){const n=Se.value[o];(n!==void 0&&n.includes(t.day)===!0?$e:Be)(t)}function ue(t){return{year:t.year,month:t.month,day:t.day}}function me(t,o,n){if(x.value!==null&&t<=x.value.year&&(t=x.value.year,o<x.value.month&&(o=x.value.month)),L.value!==null&&t>=L.value.year&&(t=L.value.year,o>L.value.month&&(o=L.value.month)),n!==void 0){const{hour:u,minute:T,second:f,millisecond:C,timezoneOffset:O,timeHash:we}=n;Object.assign(y.value,{hour:u,minute:T,second:f,millisecond:C,timezoneOffset:O,timeHash:we})}const d=t+"/"+ve(o)+"/01";d!==y.value.dateHash&&(R.value=y.value.dateHash<d==(c.lang.rtl!==!0)?"left":"right",t!==y.value.year&&(re.value=R.value),Ve(()=>{X.value=t-t%de-(t<0?de:0),Object.assign(y.value,{year:t,month:o,day:1,dateHash:d})}))}function Ze(t,o,n){const d=t!==null&&t.length===1&&e.multiple===!1?t[0]:t;N=d;const{reason:u,details:T}=et(o,n);l("update:modelValue",d,u,T)}function Te(t){const o=K.value[0]!==void 0&&K.value[0].dateHash!==null?{...K.value[0]}:{...y.value};Ve(()=>{o.year=y.value.year,o.month=y.value.month;const n=e.calendar!=="persian"?new Date(o.year,o.month,0).getDate():Ne(o.year,o.month);o.day=Math.min(Math.max(1,o.day),n);const d=he(o);N=d;const{details:u}=et("",o);l("update:modelValue",d,t,u)})}function et(t,o){return o.from!==void 0?{reason:`${t}-range`,details:{...ue(o.target),from:ue(o.from),to:ue(o.to)}}:{reason:`${t}-day`,details:ue(o)}}function he(t,o,n){return t.from!==void 0?{from:ye.value(t.from,o,n),to:ye.value(t.to,o,n)}:ye.value(t,o,n)}function Be(t){let o;if(e.multiple===!0)if(t.from!==void 0){const n=ae(t.from),d=ae(t.to),u=K.value.filter(f=>f.dateHash<n||f.dateHash>d),T=Z.value.filter(({from:f,to:C})=>C.dateHash<n||f.dateHash>d);o=u.concat(T).concat(t).map(f=>he(f))}else{const n=se.value.slice();n.push(he(t)),o=n}else o=he(t);Ze(o,"add",t)}function $e(t){if(e.noUnset===!0)return;let o=null;if(e.multiple===!0&&Array.isArray(e.modelValue)===!0){const n=he(t);t.from!==void 0?o=e.modelValue.filter(d=>d.from!==void 0?d.from!==n.from&&d.to!==n.to:!0):o=e.modelValue.filter(d=>d!==n),o.length===0&&(o=null)}Ze(o,"remove",t)}function tt(t,o,n){const d=K.value.concat(Z.value).map(u=>he(u,t,o)).filter(u=>u.from!==void 0?u.from.dateHash!==null&&u.to.dateHash!==null:u.dateHash!==null);l("update:modelValue",(e.multiple===!0?d:d[0])||null,n)}function zt(){if(e.minimal!==!0)return v("div",{class:"q-date__header "+M.value},[v("div",{class:"relative-position"},[v(xe,{name:"q-transition--fade"},()=>v("div",{key:"h-yr-"+J.value,class:"q-date__header-subtitle q-date__header-link "+(E.value==="Years"?"q-date__header-link--active":"cursor-pointer"),tabindex:_.value,...m("vY",{onClick(){E.value="Years"},onKeyup(t){t.keyCode===13&&(E.value="Years")}})},[J.value]))]),v("div",{class:"q-date__header-title relative-position flex no-wrap"},[v("div",{class:"relative-position col"},[v(xe,{name:"q-transition--fade"},()=>v("div",{key:"h-sub"+pe.value,class:"q-date__header-title-label q-date__header-link "+(E.value==="Calendar"?"q-date__header-link--active":"cursor-pointer"),tabindex:_.value,...m("vC",{onClick(){E.value="Calendar"},onKeyup(t){t.keyCode===13&&(E.value="Calendar")}})},[pe.value]))]),e.todayBtn===!0?v(V,{class:"q-date__header-today self-start",icon:c.iconSet.datetime.today,flat:!0,size:"sm",round:!0,tabindex:_.value,onClick:Ke}):null])])}function Le({label:t,type:o,key:n,dir:d,goTo:u,boundaries:T,cls:f}){return[v("div",{class:"row items-center q-date__arrow"},[v(V,{round:!0,dense:!0,size:"sm",flat:!0,icon:te.value[0],tabindex:_.value,disable:T.prev===!1,...m("go-#"+o,{onClick(){u(-1)}})})]),v("div",{class:"relative-position overflow-hidden flex flex-center"+f},[v(xe,{name:"q-transition--jump-"+d},()=>v("div",{key:n},[v(V,{flat:!0,dense:!0,noCaps:!0,label:t,tabindex:_.value,...m("view#"+o,{onClick:()=>{E.value=o}})})]))]),v("div",{class:"row items-center q-date__arrow"},[v(V,{round:!0,dense:!0,size:"sm",flat:!0,icon:te.value[1],tabindex:_.value,disable:T.next===!1,...m("go+#"+o,{onClick(){u(1)}})})])]}const Mt={Calendar:()=>[v("div",{key:"calendar-view",class:"q-date__view q-date__calendar"},[v("div",{class:"q-date__navigation row items-center no-wrap"},Le({label:z.value.months[y.value.month-1],type:"Months",key:y.value.month,dir:R.value,goTo:Xe,boundaries:Ce.value.month,cls:" col"}).concat(Le({label:y.value.year,type:"Years",key:y.value.year,dir:re.value,goTo:Oe,boundaries:Ce.value.year,cls:""}))),v("div",{class:"q-date__calendar-weekdays row items-center no-wrap"},r.value.map(t=>v("div",{class:"q-date__calendar-item"},[v("div",t)]))),v("div",{class:"q-date__calendar-days-container relative-position overflow-hidden"},[v(xe,{name:"q-transition--slide-"+R.value},()=>v("div",{key:W.value,class:"q-date__calendar-days fit"},Qe.value.map(t=>v("div",{class:t.classes},[t.in===!0?v(V,{class:t.today===!0?"q-date__today":"",dense:!0,flat:t.flat,unelevated:t.unelevated,color:t.color,textColor:t.textColor,label:t.i,tabindex:_.value,...m("day#"+t.i,{onClick:()=>{Ot(t.i)},onMouseover:()=>{Bt(t.i)}})},t.event!==!1?()=>v("div",{class:"q-date__event bg-"+t.event}):null):v("div",""+t.i)]))))])])],Months(){const t=y.value.year===k.value.year,o=d=>x.value!==null&&y.value.year===x.value.year&&x.value.month>d||L.value!==null&&y.value.year===L.value.year&&L.value.month<d,n=z.value.monthsShort.map((d,u)=>{const T=y.value.month===u+1;return v("div",{class:"q-date__months-item flex flex-center"},[v(V,{class:t===!0&&k.value.month===u+1?"q-date__today":null,flat:T!==!0,label:d,unelevated:T,color:T===!0?g.value:null,textColor:T===!0?$.value:null,tabindex:_.value,disable:o(u+1),...m("month#"+u,{onClick:()=>{Dt(u+1)}})})])});return e.yearsInMonthView===!0&&n.unshift(v("div",{class:"row no-wrap full-width"},[Le({label:y.value.year,type:"Years",key:y.value.year,dir:re.value,goTo:Oe,boundaries:Ce.value.year,cls:" col"})])),v("div",{key:"months-view",class:"q-date__view q-date__months flex flex-center"},n)},Years(){const t=X.value,o=t+de,n=[],d=u=>x.value!==null&&x.value.year>u||L.value!==null&&L.value.year<u;for(let u=t;u<=o;u++){const T=y.value.year===u;n.push(v("div",{class:"q-date__years-item flex flex-center"},[v(V,{key:"yr"+u,class:k.value.year===u?"q-date__today":null,flat:!T,label:u,dense:!0,unelevated:T,color:T===!0?g.value:null,textColor:T===!0?$.value:null,tabindex:_.value,disable:d(u),...m("yr#"+u,{onClick:()=>{Tt(u)}})})]))}return v("div",{class:"q-date__view q-date__years flex flex-center"},[v("div",{class:"col-auto"},[v(V,{round:!0,dense:!0,flat:!0,icon:te.value[0],tabindex:_.value,disable:d(t),...m("y-",{onClick:()=>{X.value-=de}})})]),v("div",{class:"q-date__years-content col self-stretch row items-center"},n),v("div",{class:"col-auto"},[v(V,{round:!0,dense:!0,flat:!0,icon:te.value[1],tabindex:_.value,disable:d(o),...m("y+",{onClick:()=>{X.value+=de}})})])])}};function Ot(t){const o={...y.value,day:t};if(e.range===!1){Ht(o,W.value);return}if(p.value===null){const n=Qe.value.find(u=>u.fill!==!0&&u.i===t);if(e.noUnset!==!0&&n.range!==void 0){$e({target:o,from:n.range.from,to:n.range.to});return}if(n.selected===!0){$e(o);return}const d=ae(o);p.value={init:o,initHash:d,final:o,finalHash:d},l("rangeStart",ue(o))}else{const n=p.value.initHash,d=ae(o),u=n<=d?{from:p.value.init,to:o}:{from:o,to:p.value.init};p.value=null,Be(n===d?o:{target:o,...u}),l("rangeEnd",{from:ue(u.from),to:ue(u.to)})}}function Bt(t){if(p.value!==null){const o={...y.value,day:t};Object.assign(p.value,{final:o,finalHash:ae(o)})}}return Object.assign(s,{setToday:Ke,setView:xt,offsetCalendar:qt,setCalendarTo:ze,setEditingRange:St}),()=>{const t=[v("div",{class:"q-date__content col relative-position"},[v(xe,{name:"q-transition--fade"},Mt[E.value])])],o=ct(a.default);return o!==void 0&&t.push(v("div",{class:"q-date__actions"},o)),e.name!==void 0&&e.disable!==!0&&B(t,"push"),v("div",{class:h.value,...wt.value},[zt(),v("div",{ref:Y,class:"q-date__main col column",tabindex:-1},t)])}}});function ht(e,a){if(a&&e===a)return null;const l=e.nodeName.toLowerCase();if(["div","li","ul","ol","blockquote"].includes(l)===!0)return e;const s=window.getComputedStyle?window.getComputedStyle(e):e.currentStyle,c=s.display;return c==="block"||c==="table"?e:ht(e.parentNode)}function Re(e,a,l){return!e||e===document.body?!1:l===!0&&e===a||(a===document?document.body:a).contains(e.parentNode)}function gt(e,a,l){if(l||(l=document.createRange(),l.selectNode(e),l.setStart(e,0)),a.count===0)l.setEnd(e,a.count);else if(a.count>0)if(e.nodeType===Node.TEXT_NODE)e.textContent.length<a.count?a.count-=e.textContent.length:(l.setEnd(e,a.count),a.count=0);else for(let s=0;a.count!==0&&s<e.childNodes.length;s++)l=gt(e.childNodes[s],a,l);return l}const ka=/^https?:\/\//;class wa{constructor(a,l){this.el=a,this.eVm=l,this._range=null}get selection(){if(this.el){const a=document.getSelection();if(Re(a.anchorNode,this.el,!0)&&Re(a.focusNode,this.el,!0))return a}return null}get hasSelection(){return this.selection!==null?this.selection.toString().length!==0:!1}get range(){const a=this.selection;return a!==null&&a.rangeCount?a.getRangeAt(0):this._range}get parent(){const a=this.range;if(a!==null){const l=a.startContainer;return l.nodeType===document.ELEMENT_NODE?l:l.parentNode}return null}get blockParent(){const a=this.parent;return a!==null?ht(a,this.el):null}save(a=this.range){a!==null&&(this._range=a)}restore(a=this._range){const l=document.createRange(),s=document.getSelection();a!==null?(l.setStart(a.startContainer,a.startOffset),l.setEnd(a.endContainer,a.endOffset),s.removeAllRanges(),s.addRange(l)):(s.selectAllChildren(this.el),s.collapseToEnd())}savePosition(){let a=-1,l;const s=document.getSelection(),c=this.el.parentNode;if(s.focusNode&&Re(s.focusNode,c))for(l=s.focusNode,a=s.focusOffset;l&&l!==c;)l!==this.el&&l.previousSibling?(l=l.previousSibling,a+=l.textContent.length):l=l.parentNode;this.savedPos=a}restorePosition(a=0){if(this.savedPos>0&&this.savedPos<a){const l=window.getSelection(),s=gt(this.el,{count:this.savedPos});s&&(s.collapse(!1),l.removeAllRanges(),l.addRange(s))}}hasParent(a,l){const s=l?this.parent:this.blockParent;return s!==null?s.nodeName.toLowerCase()===a.toLowerCase():!1}hasParents(a,l,s=this.parent){return s===null?!1:a.includes(s.nodeName.toLowerCase())===!0?!0:l===!0?this.hasParents(a,l,s.parentNode):!1}is(a,l){if(this.selection===null)return!1;switch(a){case"formatBlock":return l==="DIV"&&this.parent===this.el||this.hasParent(l,l==="PRE");case"link":return this.hasParent("A",!0);case"fontSize":return document.queryCommandValue(a)===l;case"fontName":const s=document.queryCommandValue(a);return s===`"${l}"`||s===l;case"fullscreen":return this.eVm.inFullscreen.value;case"viewsource":return this.eVm.isViewingSource.value;case void 0:return!1;default:const c=document.queryCommandState(a);return l!==void 0?c===l:c}}getParentAttribute(a){return this.parent!==null?this.parent.getAttribute(a):null}can(a){if(a==="outdent")return this.hasParents(["blockquote","li"],!0);if(a==="indent")return this.hasParents(["li"],!0);if(a==="link")return this.selection!==null||this.is("link")}apply(a,l,s=Nt){if(a==="formatBlock")["BLOCKQUOTE","H1","H2","H3","H4","H5","H6"].includes(l)&&this.is(a,l)&&(a="outdent",l=null),l==="PRE"&&this.is(a,"PRE")&&(l="P");else if(a==="print"){s();const c=window.open();c.document.write(`
        <!doctype html>
        <html>
          <head>
            <title>Print - ${document.title}</title>
          </head>
          <body>
            <div>${this.el.innerHTML}</div>
          </body>
        </html>
      `),c.print(),c.close();return}else if(a==="link"){const c=this.getParentAttribute("href");if(c===null){const q=this.selectWord(this.selection),m=q?q.toString():"";if(!m.length&&(!this.range||!this.range.cloneContents().querySelector("img")))return;this.eVm.editLinkUrl.value=ka.test(m)?m:"https://",document.execCommand("createLink",!1,this.eVm.editLinkUrl.value),this.save(q.getRangeAt(0))}else this.eVm.editLinkUrl.value=c,this.range.selectNodeContents(this.parent),this.save();return}else if(a==="fullscreen"){this.eVm.toggleFullscreen(),s();return}else if(a==="viewsource"){this.eVm.isViewingSource.value=this.eVm.isViewingSource.value===!1,this.eVm.setContent(this.eVm.props.modelValue),s();return}document.execCommand(a,!1,l),s()}selectWord(a){if(a===null||a.isCollapsed!==!0||a.modify===void 0)return a;const l=document.createRange();l.setStart(a.anchorNode,a.anchorOffset),l.setEnd(a.focusNode,a.focusOffset);const s=l.collapsed?["backward","forward"]:["forward","backward"];l.detach();const c=a.focusNode,q=a.focusOffset;return a.collapse(a.anchorNode,a.anchorOffset),a.modify("move",s[0],"character"),a.modify("move",s[1],"word"),a.extend(c,q),a.modify("extend",s[1],"character"),a.modify("extend",s[0],"word"),a}}function yt(e,a,l){a.handler?a.handler(e,l,l.caret):l.runCmd(a.cmd,a.param)}function Ue(e){return v("div",{class:"q-editor__toolbar-group"},e)}function pt(e,a,l,s=!1){const c=s||(a.type==="toggle"?a.toggled?a.toggled(e):a.cmd&&e.caret.is(a.cmd,a.param):!1),q=[];if(a.tip&&e.$q.platform.is.desktop){const m=a.key?v("div",[v("small",`(CTRL + ${String.fromCharCode(a.key)})`)]):null;q.push(v(mt,{delay:1e3},()=>[v("div",{innerHTML:a.tip}),m]))}return v(V,{...e.buttonProps.value,icon:a.icon!==null?a.icon:void 0,color:c?a.toggleColor||e.props.toolbarToggleColor:a.color||e.props.toolbarColor,textColor:c&&!e.props.toolbarPush?null:a.textColor||e.props.toolbarTextColor,label:a.label,disable:a.disable?typeof a.disable=="function"?a.disable(e):!0:!1,size:"sm",onClick(m){l&&l(),yt(m,a,e)}},()=>q)}function xa(e,a){const l=a.list==="only-icons";let s=a.label,c=a.icon!==null?a.icon:void 0,q,m;function _(){P.component.proxy.hide()}if(l)m=a.options.map(w=>{const N=w.type===void 0?e.caret.is(w.cmd,w.param):!1;return N&&(s=w.tip,c=w.icon!==null?w.icon:void 0),pt(e,w,_,N)}),q=e.toolbarBackgroundClass.value,m=[Ue(m)];else{const w=e.props.toolbarToggleColor!==void 0?`text-${e.props.toolbarToggleColor}`:null,N=e.props.toolbarTextColor!==void 0?`text-${e.props.toolbarTextColor}`:null,D=a.list==="no-icons";m=a.options.map(B=>{const Y=B.disable?B.disable(e):!1,A=B.type===void 0?e.caret.is(B.cmd,B.param):!1;A&&(s=B.tip,c=B.icon!==null?B.icon:void 0);const z=B.htmlTip;return v(ua,{active:A,activeClass:w,clickable:!0,disable:Y,dense:!0,onClick(Q){_(),e.contentRef.value!==null&&e.contentRef.value.focus(),e.caret.restore(),yt(Q,B,e)}},()=>[D===!0?null:v(nt,{class:A?w:N,side:!0},()=>v(Ae,{name:B.icon!==null?B.icon:void 0})),v(nt,z?()=>v("div",{class:"text-no-wrap",innerHTML:B.htmlTip}):B.tip?()=>v("div",{class:"text-no-wrap"},B.tip):void 0)])}),q=[e.toolbarBackgroundClass.value,N]}const M=a.highlight&&s!==a.label,P=v(sa,{...e.buttonProps.value,noCaps:!0,noWrap:!0,color:M?e.props.toolbarToggleColor:e.props.toolbarColor,textColor:M&&!e.props.toolbarPush?null:e.props.toolbarTextColor,label:a.fixedLabel?a.label:s,icon:a.fixedIcon?a.icon!==null?a.icon:void 0:c,contentClass:q,onShow:w=>e.emit("dropdownShow",w),onHide:w=>e.emit("dropdownHide",w),onBeforeShow:w=>e.emit("dropdownBeforeShow",w),onBeforeHide:w=>e.emit("dropdownBeforeHide",w)},()=>m);return P}function qa(e){if(e.caret)return e.buttons.value.filter(a=>!e.isViewingSource.value||a.find(l=>l.cmd==="viewsource")).map(a=>Ue(a.map(l=>e.isViewingSource.value&&l.cmd!=="viewsource"?!1:l.type==="slot"?ct(e.slots[l.slot]):l.type==="dropdown"?xa(e,l):pt(e,l))))}function Sa(e,a,l,s={}){const c=Object.keys(s);if(c.length===0)return{};const q={default_font:{cmd:"fontName",param:e,icon:l,tip:a}};return c.forEach(m=>{const _=s[m];q[m]={cmd:"fontName",param:_,icon:l,tip:_,htmlTip:`<font face="${_}">${_}</font>`}}),q}function Ta(e){if(e.caret){const a=e.props.toolbarColor||e.props.toolbarTextColor;let l=e.editLinkUrl.value;const s=()=>{e.caret.restore(),l!==e.editLinkUrl.value&&document.execCommand("createLink",!1,l===""?" ":l),e.editLinkUrl.value=null};return[v("div",{class:`q-mx-xs text-${a}`},`${e.$q.lang.editor.url}: `),v("input",{key:"qedt_btm_input",class:"col q-editor__link-input",value:l,onInput:c=>{Et(c),l=c.target.value},onKeydown:c=>{if(vt(c)!==!0)switch(c.keyCode){case 13:return at(c),s();case 27:at(c),e.caret.restore(),(!e.editLinkUrl.value||e.editLinkUrl.value==="https://")&&document.execCommand("unlink"),e.editLinkUrl.value=null;break}}}),Ue([v(V,{key:"qedt_btm_rem",tabindex:-1,...e.buttonProps.value,label:e.$q.lang.label.remove,noCaps:!0,onClick:()=>{e.caret.restore(),document.execCommand("unlink"),e.editLinkUrl.value=null}}),v(V,{key:"qedt_btm_upd",...e.buttonProps.value,label:e.$q.lang.label.update,noCaps:!0,onClick:s})])]}}const Da=Object.prototype.toString,Ie=Object.prototype.hasOwnProperty,Ha=new Set(["Boolean","Number","String","Function","Array","Date","RegExp"].map(e=>"[object "+e+"]"));function rt(e){if(e!==Object(e)||Ha.has(Da.call(e))===!0||e.constructor&&Ie.call(e,"constructor")===!1&&Ie.call(e.constructor.prototype,"isPrototypeOf")===!1)return!1;let a;for(a in e);return a===void 0||Ie.call(e,a)}function bt(){let e,a,l,s,c,q,m=arguments[0]||{},_=1,M=!1;const P=arguments.length;for(typeof m=="boolean"&&(M=m,m=arguments[1]||{},_=2),Object(m)!==m&&typeof m!="function"&&(m={}),P===_&&(m=this,_--);_<P;_++)if((e=arguments[_])!==null)for(a in e)l=m[a],s=e[a],m!==s&&(M===!0&&s&&((c=Array.isArray(s))||rt(s)===!0)?(c===!0?q=Array.isArray(l)===!0?l:[]:q=rt(l)===!0?l:{},m[a]=bt(M,q,s)):s!==void 0&&(m[a]=s));return m}var za=it({name:"QEditor",props:{...st,...ca,modelValue:{type:String,required:!0},readonly:Boolean,disable:Boolean,minHeight:{type:String,default:"10rem"},maxHeight:String,height:String,definitions:Object,fonts:Object,placeholder:String,toolbar:{type:Array,validator:e=>e.length===0||e.every(a=>a.length),default(){return[["left","center","right","justify"],["bold","italic","underline","strike"],["undo","redo"]]}},toolbarColor:String,toolbarBg:String,toolbarTextColor:String,toolbarToggleColor:{type:String,default:"primary"},toolbarOutline:Boolean,toolbarPush:Boolean,toolbarRounded:Boolean,paragraphTag:{type:String,validator:e=>["div","p"].includes(e),default:"div"},contentStyle:Object,contentClass:[Object,Array,String],square:Boolean,flat:Boolean,dense:Boolean},emits:[...da,"update:modelValue","keydown","click","mouseup","keyup","touchend","focus","blur","dropdownShow","dropdownHide","dropdownBeforeShow","dropdownBeforeHide","linkShow","linkHide"],setup(e,{slots:a,emit:l,attrs:s}){const{proxy:c,vnode:q}=dt(),{$q:m}=c,_=ut(e,m),{inFullscreen:M,toggleFullscreen:P}=va(),w=Ft(s,q),N=H(null),D=H(null),B=H(null),Y=H(!1),A=b(()=>!e.readonly&&!e.disable);let z,Q,G=e.modelValue;document.execCommand("defaultParagraphSeparator",!1,e.paragraphTag),z=window.getComputedStyle(document.body).fontFamily;const k=b(()=>e.toolbarBg?` bg-${e.toolbarBg}`:""),y=b(()=>{const r=e.toolbarOutline!==!0&&e.toolbarPush!==!0;return{type:"a",flat:r,noWrap:!0,outline:e.toolbarOutline,push:e.toolbarPush,rounded:e.toolbarRounded,dense:!0,color:e.toolbarColor,disable:!A.value,size:"sm"}}),E=b(()=>{const r=m.lang.editor,i=m.iconSet.editor;return{bold:{cmd:"bold",icon:i.bold,tip:r.bold,key:66},italic:{cmd:"italic",icon:i.italic,tip:r.italic,key:73},strike:{cmd:"strikeThrough",icon:i.strikethrough,tip:r.strikethrough,key:83},underline:{cmd:"underline",icon:i.underline,tip:r.underline,key:85},unordered:{cmd:"insertUnorderedList",icon:i.unorderedList,tip:r.unorderedList},ordered:{cmd:"insertOrderedList",icon:i.orderedList,tip:r.orderedList},subscript:{cmd:"subscript",icon:i.subscript,tip:r.subscript,htmlTip:"x<subscript>2</subscript>"},superscript:{cmd:"superscript",icon:i.superscript,tip:r.superscript,htmlTip:"x<superscript>2</superscript>"},link:{cmd:"link",disable:S=>S.caret&&!S.caret.can("link"),icon:i.hyperlink,tip:r.hyperlink,key:76},fullscreen:{cmd:"fullscreen",icon:i.toggleFullscreen,tip:r.toggleFullscreen,key:70},viewsource:{cmd:"viewsource",icon:i.viewSource,tip:r.viewSource},quote:{cmd:"formatBlock",param:"BLOCKQUOTE",icon:i.quote,tip:r.quote,key:81},left:{cmd:"justifyLeft",icon:i.left,tip:r.left},center:{cmd:"justifyCenter",icon:i.center,tip:r.center},right:{cmd:"justifyRight",icon:i.right,tip:r.right},justify:{cmd:"justifyFull",icon:i.justify,tip:r.justify},print:{type:"no-state",cmd:"print",icon:i.print,tip:r.print,key:80},outdent:{type:"no-state",disable:S=>S.caret&&!S.caret.can("outdent"),cmd:"outdent",icon:i.outdent,tip:r.outdent},indent:{type:"no-state",disable:S=>S.caret&&!S.caret.can("indent"),cmd:"indent",icon:i.indent,tip:r.indent},removeFormat:{type:"no-state",cmd:"removeFormat",icon:i.removeFormat,tip:r.removeFormat},hr:{type:"no-state",cmd:"insertHorizontalRule",icon:i.hr,tip:r.hr},undo:{type:"no-state",cmd:"undo",icon:i.undo,tip:r.undo,key:90},redo:{type:"no-state",cmd:"redo",icon:i.redo,tip:r.redo,key:89},h1:{cmd:"formatBlock",param:"H1",icon:i.heading1||i.heading,tip:r.heading1,htmlTip:`<h1 class="q-ma-none">${r.heading1}</h1>`},h2:{cmd:"formatBlock",param:"H2",icon:i.heading2||i.heading,tip:r.heading2,htmlTip:`<h2 class="q-ma-none">${r.heading2}</h2>`},h3:{cmd:"formatBlock",param:"H3",icon:i.heading3||i.heading,tip:r.heading3,htmlTip:`<h3 class="q-ma-none">${r.heading3}</h3>`},h4:{cmd:"formatBlock",param:"H4",icon:i.heading4||i.heading,tip:r.heading4,htmlTip:`<h4 class="q-ma-none">${r.heading4}</h4>`},h5:{cmd:"formatBlock",param:"H5",icon:i.heading5||i.heading,tip:r.heading5,htmlTip:`<h5 class="q-ma-none">${r.heading5}</h5>`},h6:{cmd:"formatBlock",param:"H6",icon:i.heading6||i.heading,tip:r.heading6,htmlTip:`<h6 class="q-ma-none">${r.heading6}</h6>`},p:{cmd:"formatBlock",param:e.paragraphTag,icon:i.heading,tip:r.paragraph},code:{cmd:"formatBlock",param:"PRE",icon:i.code,htmlTip:`<code>${r.code}</code>`},"size-1":{cmd:"fontSize",param:"1",icon:i.size1||i.size,tip:r.size1,htmlTip:`<font size="1">${r.size1}</font>`},"size-2":{cmd:"fontSize",param:"2",icon:i.size2||i.size,tip:r.size2,htmlTip:`<font size="2">${r.size2}</font>`},"size-3":{cmd:"fontSize",param:"3",icon:i.size3||i.size,tip:r.size3,htmlTip:`<font size="3">${r.size3}</font>`},"size-4":{cmd:"fontSize",param:"4",icon:i.size4||i.size,tip:r.size4,htmlTip:`<font size="4">${r.size4}</font>`},"size-5":{cmd:"fontSize",param:"5",icon:i.size5||i.size,tip:r.size5,htmlTip:`<font size="5">${r.size5}</font>`},"size-6":{cmd:"fontSize",param:"6",icon:i.size6||i.size,tip:r.size6,htmlTip:`<font size="6">${r.size6}</font>`},"size-7":{cmd:"fontSize",param:"7",icon:i.size7||i.size,tip:r.size7,htmlTip:`<font size="7">${r.size7}</font>`}}}),le=b(()=>{const r=e.definitions||{},i=e.definitions||e.fonts?bt(!0,{},E.value,r,Sa(z,m.lang.editor.defaultFont,m.iconSet.editor.font,e.fonts)):E.value;return e.toolbar.map(S=>S.map(x=>{if(x.options)return{type:"dropdown",icon:x.icon,label:x.label,size:"sm",dense:!0,fixedLabel:x.fixedLabel,fixedIcon:x.fixedIcon,highlight:x.highlight,list:x.list,options:x.options.map(Ce=>i[Ce])};const L=i[x];return L?L.type==="no-state"||r[x]&&(L.cmd===void 0||E.value[L.cmd]&&E.value[L.cmd].type==="no-state")?L:Object.assign({type:"toggle"},L):{type:"slot",slot:x}}))}),R={$q:m,props:e,slots:a,emit:l,inFullscreen:M,toggleFullscreen:P,runCmd:_e,isViewingSource:Y,editLinkUrl:B,toolbarBackgroundClass:k,buttonProps:y,contentRef:D,buttons:le,setContent:be};ne(()=>e.modelValue,r=>{G!==r&&(G=r,be(r,!0))}),ne(B,r=>{l(`link-${r?"Show":"Hide"}`)});const re=b(()=>e.toolbar&&e.toolbar.length!==0),ie=b(()=>{const r={},i=S=>{S.key&&(r[S.key]={cmd:S.cmd,param:S.param})};return le.value.forEach(S=>{S.forEach(x=>{x.options?x.options.forEach(i):i(x)})}),r}),X=b(()=>M.value?e.contentStyle:[{minHeight:e.minHeight,height:e.height,maxHeight:e.maxHeight},e.contentStyle]),p=b(()=>`q-editor q-editor--${Y.value===!0?"source":"default"}`+(e.disable===!0?" disabled":"")+(M.value===!0?" fullscreen column":"")+(e.square===!0?" q-editor--square no-border-radius":"")+(e.flat===!0?" q-editor--flat":"")+(e.dense===!0?" q-editor--dense":"")+(_.value===!0?" q-editor--dark q-dark":"")),h=b(()=>[e.contentClass,"q-editor__content",{col:M.value,"overflow-auto":M.value||e.maxHeight}]),g=b(()=>e.disable===!0?{"aria-disabled":"true"}:e.readonly===!0?{"aria-readonly":"true"}:{});function $(){if(D.value!==null){const r=`inner${Y.value===!0?"Text":"HTML"}`,i=D.value[r];i!==e.modelValue&&(G=i,l("update:modelValue",i))}}function U(r){if(l("keydown",r),r.ctrlKey!==!0||vt(r)===!0){J();return}const i=r.keyCode,S=ie.value[i];if(S!==void 0){const{cmd:x,param:L}=S;It(r),_e(x,L,!1)}}function se(r){J(),l("click",r)}function K(r){if(D.value!==null){const{scrollTop:i,scrollHeight:S}=D.value;Q=S-i}R.caret.save(),l("blur",r)}function Z(r){Ve(()=>{D.value!==null&&Q!==void 0&&(D.value.scrollTop=D.value.scrollHeight-Q)}),l("focus",r)}function fe(r){const i=N.value;if(i!==null&&i.contains(r.target)===!0&&(r.relatedTarget===null||i.contains(r.relatedTarget)!==!0)){const S=`inner${Y.value===!0?"Text":"HTML"}`;R.caret.restorePosition(D.value[S].length),J()}}function ye(r){const i=N.value;i!==null&&i.contains(r.target)===!0&&(r.relatedTarget===null||i.contains(r.relatedTarget)!==!0)&&(R.caret.savePosition(),J())}function ee(){Q=void 0}function pe(r){R.caret.save()}function be(r,i){if(D.value!==null){i===!0&&R.caret.savePosition();const S=`inner${Y.value===!0?"Text":"HTML"}`;D.value[S]=r,i===!0&&(R.caret.restorePosition(D.value[S].length),J())}}function _e(r,i,S=!0){te(),R.caret.restore(),R.caret.apply(r,i,()=>{te(),R.caret.save(),S&&J()})}function J(){setTimeout(()=>{B.value=null,c.$forceUpdate()},1)}function te(){Vt(()=>{D.value!==null&&D.value.focus({preventScroll:!0})})}function qe(){return D.value}return ft(()=>{R.caret=c.caret=new wa(D.value,R),be(e.modelValue),J(),document.addEventListener("selectionchange",pe)}),Rt(()=>{document.removeEventListener("selectionchange",pe)}),Object.assign(c,{runCmd:_e,refreshToolbar:J,focus:te,getContentEl:qe}),()=>{let r;if(re.value){const i=[v("div",{key:"qedt_top",class:"q-editor__toolbar row no-wrap scroll-x"+k.value},qa(R))];B.value!==null&&i.push(v("div",{key:"qedt_btm",class:"q-editor__toolbar row no-wrap items-center scroll-x"+k.value},Ta(R))),r=v("div",{key:"toolbar_ctainer",class:"q-editor__toolbars-container"},i)}return v("div",{ref:N,class:p.value,style:{height:M.value===!0?"100%":null},...g.value,onFocusin:fe,onFocusout:ye},[r,v("div",{ref:D,style:X.value,class:h.value,contenteditable:A.value,placeholder:e.placeholder,...w.listeners.value,onInput:$,onKeydown:U,onClick:se,onBlur:K,onFocus:Z,onMousedown:ee,onTouchstartPassive:ee})])}}});const Ma={class:"row q-pa-xs"},Oa={class:"col-12"},Ba={class:"column items-center"},$a={class:"row justify-end"},La={class:"col-12"},Pa={key:0,class:"no-tasks text-center",style:{height:"100%"}},ja={autocorrect:"off",autocapitalize:"off",autocomplete:"off",spellcheck:"false"},Na={class:"row justify-end q-pa-md q-gutter-x-sm"},Ea={class:"text-h5"},Fa={key:0},Ra=I("div",{class:"text-h6 text-center"},"\u8BBE \u7F6E",-1),Ia={class:"q-gutter-sm q-pa-sm"},Va=I("div",{class:"text-subtitle2"},"\u4E8B\u4EF6\u8303\u56F4\uFF1A",-1),Aa=I("div",{class:"text-subtitle2"},"\u6700\u8FD1\uFF1A",-1),Ua=I("div",{class:"text-subtitle2"},"\u6708",-1),Ya=I("div",{class:"text-subtitle2"},"\u65E5\u5386\u989C\u8272\uFF1A",-1),Qa=I("div",{class:"text-subtitle2"},null,-1),Ka=I("div",{class:"text-subtitle2"},null,-1),Wa=I("div",{class:"text-subtitle2"},"\u4E8B\u4EF6\u989C\u8272\uFF1A",-1),Ja=I("div",{class:"text-subtitle2"},null,-1),Ga=I("div",{class:"text-subtitle2"},null,-1),Xa={class:"row q-gutter-xs justify-end q-pa-sm"},mo={__name:"LoggerPage",setup(e){const a=la(),l=H(!1),s=H(a.todayDate),c=H([]),q=H([]),m=H(""),_=H(""),M=H(),P=H(!1),w=H(!0),N=H(!1),D=H([]),B=H(!1),Y=[1,3,6,0],A=H(null),z=H(null),Q=H(!1),G=[{label:"\u84DD\u8272",value:"primary"},{label:"\u6A59\u8272",value:"orange"},{label:"\u7EFF\u8272",value:"green"},{label:"\u9752\u8272",value:"teal"},{label:"\u68D5\u8272",value:"brown"},{label:"\u7D2B\u8272",value:"purple"}],k=At({_id:"",date:"",user:"",logger:""});ne(()=>s.value,p=>{for(const h of q.value)if(p===h){N.value=!0;break}else N.value=!1});const y=async()=>{var p,h;if(await((p=A.value)==null?void 0:p.validate())&&await((h=z.value)==null?void 0:h.validate())){const g={user:a.user.email,monthRange:M.value,themeColor:m.value,eventColor:_.value};await a.axios.post("/user/loggersetting",g).then($=>{E(),a.successTip($.data.msg),Q.value=!1}).catch($=>{a.failureTip($.response.data.msg)})}},E=async()=>{await a.axios.get("/query/logger",{params:{user:a.user.email,month:M.value}}).then(p=>{c.value=p.data,D.value=c.value.map(h=>h.logger),q.value=c.value.map(h=>h.date)}).catch(p=>{a.failureTip(p.response.data.msg)})},le=p=>{const h=c.value[p].logger,g=D.value[p];h!==g?P.value=!0:P.value=!1},R=p=>{c.value[p].logger=D.value[p],P.value=!1},re=async()=>{if(!s.value){a.failureTip("\u8BF7\u9009\u62E9\u65E5\u671F");return}k.logger.length>0&&(k.date=s.value,k.user=a.user.email,await a.axios.post("/query/addlogger",k).then(p=>{p.data.id&&(k._id=p.data.id),p.data.logger?k.logger=p.data.logger+"<ul><li>"+k.logger+"</li></ul>":k.logger="<ul><li>"+k.logger+"</li></ul>",c.value.unshift(JSON.parse(JSON.stringify(k))),D.value=c.value.map(h=>h.logger),q.value=c.value.map(h=>h.date),a.successTip(p.data.msg),N.value=!0}).catch(p=>{a.failureTip(p.response.data.msg)}).finally(()=>{k.logger=""}))},ie=async(p,h,g,$)=>{h==="<br><ul><li>"||h==="<div><br></div>"||h.length===0?X(p,$):(k._id=p,k.date=g,k.user=a.user.email,k.logger=h,await a.axios.post("/query/editlogger",k).then(U=>{c.value[$].logger=h,D.value=c.value.map(se=>se.logger),a.successTip(U.data.msg)}).catch(U=>{a.failureTip(U.response.data.msg)}).finally(()=>{k.date="",k.logger="",k._id="",P.value=!1,w.value=!0}))},X=(p,h)=>{a.$q.dialog({title:"\u786E\u5B9A",message:"\u786E\u5B9A\u8981\u5220\u9664\u8BB0\u5F55?",cancel:!0,persistent:!0,ok:{push:!0,label:"\u786E\u5B9A",color:"green"},cancel:{push:!0,color:"blue-grey",label:"\u53D6\u6D88"}}).onOk(async()=>{await a.axios.delete("/query/deletelogger",{params:{id:p,user:a.user.email}}).then(g=>{c.value.splice(h,1),D.value=c.value.map($=>$.logger),q.value=c.value.map($=>$.date),a.successTip(g.data.msg),P.value=!1,N.value=!1}).catch(g=>{a.failureTip(g.response.data.msg)})}).onCancel(()=>{})};return ft(async()=>{if(localStorage.getItem("token")!==null)try{await a.verifyUser().then(()=>{a.user?(M.value=a.user.loggerSetting.monthRange,m.value=a.user.loggerSetting.themeColor,_.value=a.user.loggerSetting.eventColor,E()):router.push("/index")}).catch(()=>{router.push("/index")})}catch{router.push("/index")}else router.push("/index");N.value=!0}),(p,h)=>(ce(),De(ia,{class:"q-pa-xs column"},{default:j(()=>[I("div",Ma,[I("div",Oa,[I("div",Ba,[F(Ca,{modelValue:s.value,"onUpdate:modelValue":h[1]||(h[1]=g=>s.value=g),class:"item-center",landscape:Ut(a).$q.screen.gt.md,events:q.value,"years-in-month-view":"",color:m.value,"event-color":_.value,"today-btn":"",style:{width:"100%","max-width":"550px"}},{default:j(()=>[I("div",$a,[F(V,{label:"\u8BBE\u7F6E",flat:"",onClick:h[0]||(h[0]=g=>Q.value=!0)})])]),_:1},8,["modelValue","landscape","events","color","event-color"])])]),I("div",La,[F(Yt,{modelValue:k.logger,"onUpdate:modelValue":h[2]||(h[2]=g=>k.logger=g),outlined:"",type:"textarea",autogrow:"",class:"q-py-md",placeholder:"\u8BB0\u5F55\u70B9\u4E8B\u60C5\u5427...",onFocus:h[3]||(h[3]=g=>l.value=!0),onBlur:h[4]||(h[4]=g=>l.value=!1)},{prepend:j(()=>[F(Ae,{name:l.value?"tips_and_updates":"lightbulb",color:l.value?"orange":"grey"},null,8,["name","color"])]),append:j(()=>[F(V,{round:"",dense:"",flat:"",icon:"send",color:l.value?"primary":"grey",onClick:re},null,8,["color"])]),_:1},8,["modelValue"]),N.value?He("",!0):(ce(),Pe("div",Pa,[F(Ae,{name:"psychology_alt",size:"150px",color:"primary"})])),F(fa,{modelValue:s.value,"onUpdate:modelValue":h[6]||(h[6]=g=>s.value=g),animated:"","transition-prev":"jump-up","transition-next":"jump-up"},{default:j(()=>[(ce(!0),Pe(Kt,null,Qt(c.value,(g,$)=>(ce(),De(ma,{key:g._id,item:g,index:$,name:g.date,class:"q-pa-none"},{default:j(()=>[I("form",ja,[I("div",Na,[I("div",Ea,Xt(g.date),1),F(ra),P.value?(ce(),De(V,{key:0,label:"\u4FEE \u6539",class:"q-px-md",color:"primary",disable:B.value,onClick:U=>ie(g._id,g.logger,g.date,$)},null,8,["disable","onClick"])):He("",!0),P.value?(ce(),De(V,{key:1,label:"\u53D6 \u6D88",class:"q-px-md",color:"grey",onClick:U=>R($)},null,8,["onClick"])):He("",!0)]),F(za,{modelValue:g.logger,"onUpdate:modelValue":U=>g.logger=U,dense:p.$q.screen.lt.md,readonly:w.value,toolbar:[["fullscreen"],[{label:"\u529F\u80FD",size:"lg",icon:"filter_2",fixedLabel:!0,list:"only-icons",options:["left","center","right","justify","bold","italic","strike","quote","underline","unordered","ordered","outdent","indent","print","hr","link","undo","redo"]}],[{label:"\u5B57\u4F53\u5927\u5C0F",icon:p.$q.iconSet.editor.fontSize,fixedLabel:!0,size:"md",fixedIcon:!0,list:"no-icons",options:["size-1","size-2","size-3","size-4","size-5","size-6","size-7"]},"removeFormat"],["viewsource"],["edit"]],fonts:{arial:"Arial",arial_black:"Arial Black",comic_sans:"Comic Sans MS",courier_new:"Courier New",impact:"Impact",lucida_grande:"Lucida Grande",times_new_roman:"Times New Roman",verdana:"Verdana"},onInput:U=>le($)},{edit:j(()=>[F(V,{icon:"edit",color:"primary",size:"sm",flat:"",padding:"none",onClick:h[5]||(h[5]=U=>w.value=!w.value)},{default:j(()=>[w.value?He("",!0):(ce(),Pe("div",Fa,".....")),F(mt,null,{default:j(()=>[Zt(" \u70B9\u51FB\u5F00\u59CB\u7F16\u8F91 ")]),_:1})]),_:1})]),_:2},1032,["modelValue","onUpdate:modelValue","dense","readonly","toolbar","onInput"])])]),_:2},1032,["item","index","name"]))),128))]),_:1},8,["modelValue"])])]),F(Gt,{modelValue:Q.value,"onUpdate:modelValue":h[10]||(h[10]=g=>Q.value=g),persistent:""},{default:j(()=>[F(Wt,{style:{"min-width":"400px","min-height":"350px"}},{default:j(()=>[F(je,null,{default:j(()=>[Ra]),_:1}),F(je,null,{default:j(()=>[I("div",Ia,[F(Ee,{modelValue:M.value,"onUpdate:modelValue":h[7]||(h[7]=g=>M.value=g),outlined:"",dense:"",options:Y,"transition-show":"jump-up","transition-hide":"jump-up",hint:"0\u4EE3\u8868\u5168\u90E8","hide-hint":"","hide-bottom-space":""},{before:j(()=>[Va]),prepend:j(()=>[Aa]),append:j(()=>[Ua]),_:1},8,["modelValue"]),F(Ee,{ref_key:"themeColoRef",ref:A,modelValue:m.value,"onUpdate:modelValue":h[8]||(h[8]=g=>m.value=g),outlined:"",dense:"",options:G,"hide-bottom-space":"","emit-value":"","map-options":"","option-label":"label","option-value":"value","transition-show":"jump-up","transition-hide":"jump-up",rules:[g=>!!g||"\u8BF7\u9009\u62E9\u989C\u8272"]},{before:j(()=>[Ya]),prepend:j(()=>[Qa]),append:j(()=>[Ka]),_:1},8,["modelValue","rules"]),F(Ee,{ref_key:"eventColoRef",ref:z,modelValue:_.value,"onUpdate:modelValue":h[9]||(h[9]=g=>_.value=g),outlined:"",dense:"","hide-bottom-space":"","emit-value":"","map-options":"",options:G,"option-label":"label","option-value":"value","transition-show":"jump-up","transition-hide":"jump-up",rules:[g=>!!g||"\u8BF7\u9009\u62E9\u989C\u8272"]},{before:j(()=>[Wa]),prepend:j(()=>[Ja]),append:j(()=>[Ga]),_:1},8,["modelValue","rules"])])]),_:1}),F(je,null,{default:j(()=>[I("div",Xa,[F(V,{outline:"",label:"\u63D0 \u4EA4",color:"primary",onClick:y}),Jt(F(V,{outline:"",label:"\u53D6 \u6D88",color:"grey"},null,512),[[ha]])])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1}))}};export{mo as default};
