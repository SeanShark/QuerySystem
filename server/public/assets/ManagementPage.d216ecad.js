import{bC as de,c as se,am as z,u as ue,f as re,j as ce,k as me,r as I,be,n as ge,a as v,w as Q,o as fe,d as m,g as ve,bc as Ve,X as O,t as _e,bw as pe,x as he,R as j,ah as xe,H as ke,q as Ie,J as _,K as h,L as n,N as t,Y as x,O as g,b5 as Pe,b6 as Ue,b7 as Ce,b9 as Se,S as L,P as ye,bh as B,T as C,U as S,W as y,bi as c,M as Ae,Q as Te}from"./index.48789ced.js";import{Q as we,a as D}from"./QPage.4fa71f49.js";import{Q as qe,b as M,a as N}from"./position-engine.1f8748e9.js";import{Q as Le}from"./QSlideTransition.00dc81e2.js";import{Q as $e}from"./QList.1073e0e8.js";import{u as Qe}from"./store.56a5cbb1.js";import"./axios.6b484fa5.js";const k=de({}),Be=Object.keys(z);var A=se({name:"QExpansionItem",props:{...z,...ue,...re,icon:String,label:String,labelLines:[Number,String],caption:String,captionLines:[Number,String],dense:Boolean,toggleAriaLabel:String,expandIcon:String,expandedIcon:String,expandIconClass:[Array,String,Object],duration:Number,headerInsetLevel:Number,contentInsetLevel:Number,expandSeparator:Boolean,defaultOpened:Boolean,hideExpandIcon:Boolean,expandIconToggle:Boolean,switchToggleSide:Boolean,denseToggle:Boolean,group:String,popup:Boolean,headerStyle:[Array,String,Object],headerClass:[Array,String,Object]},emits:[...ce,"click","afterShow","afterHide"],setup(a,{slots:u,emit:P}){const{proxy:{$q:f}}=ve(),p=me(a,f),b=I(a.modelValue!==null?a.modelValue:a.defaultOpened),i=I(null),s=be(),{show:$,hide:T,toggle:r}=ge({showing:b});let d,e;const U=v(()=>`q-expansion-item q-item-type q-expansion-item--${b.value===!0?"expanded":"collapsed"} q-expansion-item--${a.popup===!0?"popup":"standard"}`),l=v(()=>{if(a.contentInsetLevel===void 0)return null;const o=f.lang.rtl===!0?"Right":"Left";return{["padding"+o]:a.contentInsetLevel*56+"px"}}),w=v(()=>a.disable!==!0&&(a.href!==void 0||a.to!==void 0&&a.to!==null&&a.to!=="")),K=v(()=>{const o={};return Be.forEach(V=>{o[V]=a[V]}),o}),G=v(()=>w.value===!0||a.expandIconToggle!==!0),F=v(()=>a.expandedIcon!==void 0&&b.value===!0?a.expandedIcon:a.expandIcon||f.iconSet.expansionItem[a.denseToggle===!0?"denseIcon":"icon"]),J=v(()=>a.disable!==!0&&(w.value===!0||a.expandIconToggle===!0)),W=v(()=>({expanded:b.value===!0,detailsId:a.targetUid,toggle:r,show:$,hide:T})),E=v(()=>{const o=a.toggleAriaLabel!==void 0?a.toggleAriaLabel:f.lang.label[b.value===!0?"collapse":"expand"](a.label);return{role:"button","aria-expanded":b.value===!0?"true":"false","aria-controls":s.value,"aria-label":o}});Q(()=>a.group,o=>{e!==void 0&&e(),o!==void 0&&R()});function X(o){w.value!==!0&&r(o),P("click",o)}function Y(o){o.keyCode===13&&H(o,!0)}function H(o,V){V!==!0&&i.value!==null&&i.value.focus(),r(o),xe(o)}function Z(){P("afterShow")}function ee(){P("afterHide")}function R(){d===void 0&&(d=Ve()),b.value===!0&&(k[a.group]=d);const o=Q(b,q=>{q===!0?k[a.group]=d:k[a.group]===d&&delete k[a.group]}),V=Q(()=>k[a.group],(q,ie)=>{ie===d&&q!==void 0&&q!==d&&T()});e=()=>{o(),V(),k[a.group]===d&&delete k[a.group],e=void 0}}function le(){const o={class:[`q-focusable relative-position cursor-pointer${a.denseToggle===!0&&a.switchToggleSide===!0?" items-end":""}`,a.expandIconClass],side:a.switchToggleSide!==!0,avatar:a.switchToggleSide},V=[m(j,{class:"q-expansion-item__toggle-icon"+(a.expandedIcon===void 0&&b.value===!0?" q-expansion-item__toggle-icon--rotated":""),name:F.value})];return J.value===!0&&(Object.assign(o,{tabindex:0,...E.value,onClick:H,onKeyup:Y}),V.unshift(m("div",{ref:i,class:"q-expansion-item__toggle-focus q-icon q-focus-helper q-focus-helper--rounded",tabindex:-1}))),m(N,o,()=>V)}function ae(){let o;return u.header!==void 0?o=[].concat(u.header(W.value)):(o=[m(N,()=>[m(M,{lines:a.labelLines},()=>a.label||""),a.caption?m(M,{lines:a.captionLines,caption:!0},()=>a.caption):null])],a.icon&&o[a.switchToggleSide===!0?"push":"unshift"](m(N,{side:a.switchToggleSide===!0,avatar:a.switchToggleSide!==!0},()=>m(j,{name:a.icon})))),a.disable!==!0&&a.hideExpandIcon!==!0&&o[a.switchToggleSide===!0?"unshift":"push"](le()),o}function te(){const o={ref:"item",style:a.headerStyle,class:a.headerClass,dark:p.value,disable:a.disable,dense:a.dense,insetLevel:a.headerInsetLevel};return G.value===!0&&(o.clickable=!0,o.onClick=X,Object.assign(o,w.value===!0?K.value:E.value)),m(qe,o,ae)}function oe(){return _e(m("div",{key:"e-content",class:"q-expansion-item__content relative-position",style:l.value,id:s.value},he(u.default)),[[pe,b.value]])}function ne(){const o=[te(),m(Le,{duration:a.duration,onShow:Z,onHide:ee},oe)];return a.expandSeparator===!0&&o.push(m(O,{class:"q-expansion-item__border q-expansion-item__border--top absolute-top",dark:p.value}),m(O,{class:"q-expansion-item__border q-expansion-item__border--bottom absolute-bottom",dark:p.value})),o}return a.group!==void 0&&R(),fe(()=>{e!==void 0&&e()}),()=>m("div",{class:U.value},[m("div",{class:"q-expansion-item__container relative-position"},ne())])}});const De=g("h5",{class:"q-mt-none q-mb-md text-center lt-md"},"\u7BA1\u7406\u9875",-1),Ne=g("div",{class:"text-subtitle2"}," \u8FC7\u6EE4\uFF1A ",-1),Oe={class:"row q-gutter-md justify-center"},je=g("div",{class:"text-subtitle2"},"\u59D3\u540D\uFF1A",-1),Ee=g("div",{class:"text-subtitle2"},"\u7535\u8BDD\uFF1A",-1),He=g("div",{class:"text-subtitle2"},"\u6027\u522B\uFF1A",-1),Re=g("div",{class:"text-subtitle2"},"\u751F\u65E5:",-1),Me=g("div",{class:"text-subtitle2"},"\u521B\u5EFA\u65F6\u95F4\uFF1A",-1),ze=g("div",{class:"text-subtitle2"},"\u6700\u540E\u767B\u5F55\uFF1A",-1),Ke={class:"row justify-around"},el={__name:"ManagementPage",setup(a){const u=Qe(),P=ke(),f=I([]),p=I(""),b=I(!1),i=I(!1),s=async(r,d,e)=>{if(b.value)return;if(!r||!d||typeof e!="boolean"){u.failureTip("\u53C2\u6570\u6709\u8BEF");return}i.value=!0;const U={id:r,field:d,value:e};await u.axios.post("/user/setuser",U).then(l=>{l.status===201&&u.successTip(l.data.msg)}).catch(l=>{u.failureTip(l.response.data.msg)}).finally(()=>{i.value=!1})},$=v(()=>{const r=p.value.toLowerCase().trim();return r?f.value.filter(d=>d.userInfo.email.toLowerCase().includes(r)):f.value}),T=async r=>{u.$q.dialog({title:"\u786E\u8BA4\u5220\u9664",message:"\u786E\u8BA4\u8981\u5220\u9664\u8BE5\u7528\u6237\u5417\uFF1F",cancel:!0,persistent:!0,ok:{push:!0,label:"\u786E\u5B9A",color:"green"},cancel:{push:!0,color:"grey",label:"\u53D6\u6D88"}}).onOk(async()=>{await u.axios.delete("/user/deleteuser",{params:{id:r}}).then(d=>{d.status===201&&(f.value=f.value.filter(e=>e._id!==r),u.successTip(d.data.msg))}).catch(d=>{u.failureTip(d.response.data.msg)})}).onCancel(()=>{}).onDismiss(()=>{})};return Ie(async()=>{await u.verifyUser().then(async()=>{u.user&&await u.axios.post("/user/alluser").then(r=>{f.value=r.data}).catch(r=>{r.response.data?u.failureTip(r.response.data.msg):u.failureTip("\u83B7\u53D6\u6570\u636E\u8D85\u65F6")})}).catch(()=>{P.push("/index")})}),(r,d)=>(_(),h(we,{class:"q-pa-md"},{default:n(()=>[De,t(x,{modelValue:p.value,"onUpdate:modelValue":d[0]||(d[0]=e=>p.value=e),dense:"",outlined:"",class:"q-py-md"},{before:n(()=>[Ne]),prepend:n(()=>[t(j,{name:"search"})]),_:1},8,["modelValue"]),g("div",Oe,[(_(!0),Pe(Ce,null,Ue($.value,(e,U)=>(_(),h($e,{key:U,item:e,bordered:"",class:"rounded-borders col-12 col-md-5 col-lg-3 shadow-3"},{default:n(()=>[g("div",{class:Se(["coloum text-center text-h6 q-pa-md",e.userInfo.banned?"text-strike":""])},[L(ye(e.userInfo.email)+" ",1),e.userPrivilege.superUser?(_(),h(B,{key:0,"text-color":"red",icon:"supervisor_account",size:"lg"},{default:n(()=>[t(D,null,{default:n(()=>[L(" \u7BA1\u7406\u5458 ")]),_:1})]),_:1})):C("",!0),e.userInfo.activationCode!=null?(_(),h(B,{key:1,"text-color":"warning",icon:"question_mark",size:"lg"},{default:n(()=>[t(D,null,{default:n(()=>[L(" \u7528\u6237\u672A\u6FC0\u6D3B ")]),_:1})]),_:1})):C("",!0),e.userInfo.banned?(_(),h(B,{key:2,"text-color":"grey",icon:"person_off",size:"lg"},{default:n(()=>[t(D,null,{default:n(()=>[L(" \u7528\u6237\u5DF2\u7981\u7528 ")]),_:1})]),_:1})):C("",!0)],2),t(O),t(A,{"expand-separator":"",icon:"perm_identity",label:"\u7528\u6237\u4FE1\u606F"},{default:n(()=>[t(S,{class:"shadow-3"},{default:n(()=>[t(y,null,{default:n(()=>[t(x,{modelValue:e.userInfo.name,"onUpdate:modelValue":l=>e.userInfo.name=l,dense:"",flat:"",readonly:"","item-aligned":""},{before:n(()=>[je]),_:2},1032,["modelValue","onUpdate:modelValue"]),t(x,{modelValue:e.userInfo.phone,"onUpdate:modelValue":l=>e.userInfo.phone=l,dense:"",flat:"",readonly:"","item-aligned":""},{before:n(()=>[Ee]),_:2},1032,["modelValue","onUpdate:modelValue"]),t(x,{modelValue:e.userInfo.gender,"onUpdate:modelValue":l=>e.userInfo.gender=l,dense:"",flat:"",readonly:"","item-aligned":""},{before:n(()=>[He]),_:2},1032,["modelValue","onUpdate:modelValue"]),t(x,{modelValue:e.userInfo.birth,"onUpdate:modelValue":l=>e.userInfo.birth=l,dense:"",flat:"",readonly:"","item-aligned":""},{before:n(()=>[Re]),_:2},1032,["modelValue","onUpdate:modelValue"]),t(x,{modelValue:e.userInfo.createdAt,"onUpdate:modelValue":l=>e.userInfo.createdAt=l,dense:"",flat:"",readonly:"","item-aligned":""},{before:n(()=>[Me]),_:2},1032,["modelValue","onUpdate:modelValue"]),t(x,{modelValue:e.userInfo.lastLogin,"onUpdate:modelValue":l=>e.userInfo.lastLogin=l,dense:"",flat:"",readonly:"","item-aligned":""},{before:n(()=>[ze]),_:2},1032,["modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024)]),_:2},1024),t(A,{"expand-separator":"",icon:"task_alt",label:"\u64CD\u4F5C\u6743\u9650","header-class":"text-primary",disable:e.userInfo.banned},{default:n(()=>[t(S,null,{default:n(()=>[t(y,null,{default:n(()=>[e.userInfo.email!=="47262243@qq.com"?(_(),h(c,{key:0,modelValue:e.userPrivilege.superUser,"onUpdate:modelValue":l=>e.userPrivilege.superUser=l,name:"user.userPrivilege.superUser",color:"green",label:"\u7BA1\u7406\u5458","left-label":"",disable:i.value,onClick:l=>s(e._id,"userPrivilege.superUser",e.userPrivilege.superUser)},null,8,["modelValue","onUpdate:modelValue","disable","onClick"])):C("",!0),t(c,{modelValue:e.userPrivilege.read,"onUpdate:modelValue":l=>e.userPrivilege.read=l,name:"user.userPrivilege.read",color:"green",label:"\u8BFB\u53D6","left-label":"",disable:i.value,onClick:l=>s(e._id,"userPrivilege.read",e.userPrivilege.read)},null,8,["modelValue","onUpdate:modelValue","disable","onClick"]),t(c,{modelValue:e.userPrivilege.add,"onUpdate:modelValue":l=>e.userPrivilege.add=l,name:"user.userPrivilege.add",color:"green",label:"\u589E\u52A0","left-label":"",disable:i.value,onClick:l=>s(e._id,"userPrivilege.add",e.userPrivilege.add)},null,8,["modelValue","onUpdate:modelValue","disable","onClick"]),t(c,{modelValue:e.userPrivilege.edit,"onUpdate:modelValue":l=>e.userPrivilege.edit=l,name:"user.userPrivilege.edit",color:"green",label:"\u7F16\u8F91","left-label":"",disable:i.value,onClick:l=>s(e._id,"userPrivilege.edit",e.userPrivilege.edit)},null,8,["modelValue","onUpdate:modelValue","disable","onClick"]),t(c,{modelValue:e.userPrivilege.delete,"onUpdate:modelValue":l=>e.userPrivilege.delete=l,name:"user.userPrivilege.delete",color:"green",label:"\u5220\u9664","left-label":"",disable:i.value,onClick:l=>s(e._id,"userPrivilege.delete",e.userPrivilege.delete)},null,8,["modelValue","onUpdate:modelValue","disable","onClick"])]),_:2},1024)]),_:2},1024)]),_:2},1032,["disable"]),t(A,{"expand-separator":"",icon:"drafts",label:"\u8BBF\u95EE\u7C7B\u578B","header-class":"text-teal",disable:e.userInfo.banned},{default:n(()=>[t(S,null,{default:n(()=>[t(y,null,{default:n(()=>[t(c,{modelValue:e.databasePermissions.IP,"onUpdate:modelValue":l=>e.databasePermissions.IP=l,color:"green",label:"\u7EC8\u7AEF","left-label":"",disable:i.value,onClick:l=>s(e._id,"databasePermissions.IP",e.databasePermissions.IP)},null,8,["modelValue","onUpdate:modelValue","disable","onClick"]),t(c,{modelValue:e.databasePermissions.Phone,"onUpdate:modelValue":l=>e.databasePermissions.Phone=l,color:"green",label:"\u7535\u8BDD","left-label":"",disable:i.value,onClick:l=>s(e._id,"databasePermissions.Phone",e.databasePermissions.Phone)},null,8,["modelValue","onUpdate:modelValue","disable","onClick"]),t(c,{modelValue:e.databasePermissions.Printer,"onUpdate:modelValue":l=>e.databasePermissions.Printer=l,color:"green",label:"\u8017\u6750","left-label":"",disable:i.value,onClick:l=>s(e._id,"databasePermissions.Printer",e.databasePermissions.Printer)},null,8,["modelValue","onUpdate:modelValue","disable","onClick"]),t(c,{modelValue:e.databasePermissions.Datacenter,"onUpdate:modelValue":l=>e.databasePermissions.Datacenter=l,color:"green",label:"\u673A\u623F","left-label":"",disable:i.value,onClick:l=>s(e._id,"databasePermissions.Datacenter",e.databasePermissions.Datacenter)},null,8,["modelValue","onUpdate:modelValue","disable","onClick"]),t(c,{modelValue:e.databasePermissions.Surveillance,"onUpdate:modelValue":l=>e.databasePermissions.Surveillance=l,color:"green",label:"\u76D1\u63A7","left-label":"",disable:i.value,onClick:l=>s(e._id,"databasePermissions.Surveillance",e.databasePermissions.Surveillance)},null,8,["modelValue","onUpdate:modelValue","disable","onClick"])]),_:2},1024)]),_:2},1024)]),_:2},1032,["disable"]),t(A,{"expand-separator":"",icon:"place",label:"\u5730\u70B9\u63A7\u5236","header-class":"text-info",disable:e.userInfo.banned},{default:n(()=>[t(S,null,{default:n(()=>[t(y,null,{default:n(()=>[t(c,{modelValue:e.customerAccess.\u79BE\u82B1,"onUpdate:modelValue":l=>e.customerAccess.\u79BE\u82B1=l,color:"green",label:"\u79BE\u82B1","left-label":"",disable:i.value,onClick:l=>s(e._id,"customerAccess.\u79BE\u82B1",e.customerAccess.\u79BE\u82B1)},null,8,["modelValue","onUpdate:modelValue","disable","onClick"]),t(c,{modelValue:e.customerAccess.\u65B0\u5357,"onUpdate:modelValue":l=>e.customerAccess.\u65B0\u5357=l,color:"green",label:"\u65B0\u5357","left-label":"",disable:i.value,onClick:l=>s(e._id,"customerAccess.\u65B0\u5357",e.customerAccess.\u65B0\u5357)},null,8,["modelValue","onUpdate:modelValue","disable","onClick"]),t(c,{modelValue:e.customerAccess.\u9E45\u516C\u5CAD,"onUpdate:modelValue":l=>e.customerAccess.\u9E45\u516C\u5CAD=l,color:"green",label:"\u9E45\u516C\u5CAD","left-label":"",disable:i.value,onClick:l=>s(e._id,"customerAccess.\u9E45\u516C\u5CAD",e.customerAccess.\u9E45\u516C\u5CAD)},null,8,["modelValue","onUpdate:modelValue","disable","onClick"]),t(c,{modelValue:e.customerAccess.\u767D\u576D\u5751,"onUpdate:modelValue":l=>e.customerAccess.\u767D\u576D\u5751=l,color:"green",label:"\u767D\u576D\u5751","left-label":"",disable:i.value,onClick:l=>s(e._id,"customerAccess.\u767D\u576D\u5751",e.customerAccess.\u767D\u576D\u5751)},null,8,["modelValue","onUpdate:modelValue","disable","onClick"]),t(c,{modelValue:e.customerAccess.\u6167\u660E,"onUpdate:modelValue":l=>e.customerAccess.\u6167\u660E=l,color:"green",label:"\u6167\u660E","left-label":"",disable:i.value,onClick:l=>s(e._id,"customerAccess.\u6167\u660E",e.customerAccess.\u6167\u660E)},null,8,["modelValue","onUpdate:modelValue","disable","onClick"]),t(c,{modelValue:e.customerAccess.\u521B\u70B9,"onUpdate:modelValue":l=>e.customerAccess.\u521B\u70B9=l,color:"green",label:"\u521B\u70B9","left-label":"",disable:i.value,onClick:l=>s(e._id,"customerAccess.\u521B\u70B9",e.customerAccess.\u521B\u70B9)},null,8,["modelValue","onUpdate:modelValue","disable","onClick"])]),_:2},1024)]),_:2},1024)]),_:2},1032,["disable"]),e.userInfo.email!==Ae(u).user.userInfo.email?(_(),h(A,{key:0,"expand-separator":"",icon:"manage_accounts",label:"\u8D26\u6237\u7BA1\u7406","header-class":"text-indigo",disable:e.userInfo.banned},{default:n(()=>[t(S,null,{default:n(()=>[t(y,null,{default:n(()=>[g("div",Ke,[t(c,{modelValue:e.userInfo.banned,"onUpdate:modelValue":l=>e.userInfo.banned=l,color:"green",label:"\u7981\u7528\u8BE5\u8D26\u6237","left-label":"",disable:i.value,onClick:l=>s(e._id,"banned",e.userInfo.banned)},null,8,["modelValue","onUpdate:modelValue","disable","onClick"]),t(Te,{label:"\u5220\u9664\u8BE5\u7528\u6237",color:"grey-4","text-color":"red",onClick:l=>T(e._id)},null,8,["onClick"])])]),_:2},1024)]),_:2},1024)]),_:2},1032,["disable"])):C("",!0)]),_:2},1032,["item"]))),128))])]),_:1}))}};export{el as default};
