import{_ as W,H as Z,r as g,q as ee,D as ae,J as d,K as m,L as a,O as c,N as e,R as p,Q as oe,b3 as x,S as _,b4 as te,Y as le,b5 as h,b6 as U,b7 as I,X as C,T as j,U as ne,b8 as se,b9 as P,P as w,t as v,ba as M,a4 as E,a5 as re,a6 as de}from"./index.9f0a642c.js";import{Q as ie,a as F}from"./QPage.8b9b498d.js";import{Q as ce,a as J}from"./QTabs.cb6b20f8.js";import{Q as b,a as r,b as k}from"./position-engine.a9eeaafd.js";import{Q as T}from"./QList.3446d70a.js";import{Q as X}from"./QBtnDropdown.add9f007.js";import{Q as ue,a as Y}from"./QTabPanels.ceadb13f.js";import{C as y}from"./ClosePopup.868bd096.js";import{u as me}from"./store.ee3c8643.js";import"./QResizeObserver.8c94f049.js";import"./rtl.b51694b1.js";import"./use-panel.841774ec.js";import"./axios.6b484fa5.js";const A=Q=>(re("data-v-dfadf4ee"),Q=Q(),de(),Q),pe=A(()=>c("p",{class:"text-h6 text-center q-pa-md"},"\u4EFB\u52A1To-Do",-1)),fe={class:"column q-pa-xs q-ma-none"},_e={class:"col q-pa-xs"},ve={class:"q-gutter-sm row justify-center"},be={class:"q-gutter-y-md q-pa-none"},ke={class:"text-italic"},ge={key:0,class:"no-tasks absolute-center"},ye=A(()=>c("div",{class:"text-h5 text-primary text-center"},"\u65E0\u4EFB\u52A1",-1)),xe={class:"text-italic"},he={key:0,class:"no-tasks absolute-center"},Ce=A(()=>c("div",{class:"text-h5 text-primary text-center"},"\u65E0\u4EFB\u52A1",-1)),we={__name:"HomePage",setup(Q){const G=Z(),l=me(),S=g(null),D=g(!1);ee(async()=>{if(l.user)await f();else try{await l.verifyUser(),l.user&&await f()}catch{G.push("/index")}});const q=g([]),$=g([]),z=g([]),f=async()=>{await l.axios.post("/todo/gettodolists",{owner:l.user.userInfo.email}).then(n=>{q.value=n.data,$.value=q.value.filter(t=>t.isDone===!1),z.value=q.value.filter(t=>t.isDone===!0)}).catch(n=>{console.log(n)})},V=g("todo"),u=ae({owner:"",todo:"",color:"text-black",createdAt:""}),B=async()=>{var n;await((n=S.value)==null?void 0:n.validate())&&(D.value=!0,u.owner=l.user.userInfo.email,u.createdAt=l.dateAndTime(),await l.axios.post("/todo/newtodo/",u).then(t=>{u.todo="",u.color="text-black",l.successTip(t.data.msg),f()}).catch(t=>{l.failureTip(t.response.data.msg)}).finally(()=>{D.value=!1}))},L=(n,t,o)=>{setTimeout(async()=>{await l.axios.put("/todo/",{id:t,field:n,value:o}).then(i=>{l.successTip(i.data.msg),f()}).catch(i=>{l.failureTip(i.response.data.msg)})},300)},O=[{label:"\u9ED1\u8272",value:"text-black",color:"black"},{label:"\u84DD\u8272",value:"text-primary",color:"primary"},{label:"\u7D2B\u8272",value:"text-accent",color:"accent"},{label:"\u7EA2\u8272",value:"text-negative",color:"negative"},{label:"\u7EFF\u8272",value:"text-positive",color:"positive"},{label:"\u9EC4\u8272",value:"text-warning",color:"warning"},{label:"\u975B\u84DD\u8272",value:"text-indigo",color:"indigo"}],R=n=>{l.$q.dialog({title:"\u786E\u5B9A",message:"\u786E\u5B9A\u8981\u5220\u9664\u8BB0\u5F55?",cancel:!0,persistent:!0,ok:{push:!0,label:"\u786E\u5B9A",color:"green"},cancel:{push:!0,color:"blue-grey",label:"\u53D6\u6D88"}}).onOk(async()=>{await l.axios.delete(`/todo/${n}`).then(t=>{l.successTip(t.data.msg),f()}).catch(t=>{l.failureTip(t.response.data.msg)})}).onCancel(()=>{})},N=async(n,t,o)=>{const i=l.dateAndTime();await l.axios.put("/todo",{id:n,field:t,value:o,createdAt:i}).then(s=>{l.successTip(s.data.msg),f()}).catch(s=>{l.failureTip(s.response.data.msg)})},H=n=>{l.$q.dialog({title:"\u7F16\u8F91\u5185\u5BB9",message:"\u8BF7\u8F93\u5165\u9700\u8981\u7F16\u8F91\u7684\u5185\u5BB9",prompt:{model:`${n.todo}`,type:"text"},cancel:!0,persistent:!0,ok:{push:!0,label:"\u786E\u5B9A",color:"green"},cancel:{push:!0,color:"blue-grey",label:"\u53D6\u6D88"}}).onOk(async t=>{if(t==="")return l.failureTip("\u5185\u5BB9\u4E0D\u80FD\u4E3A\u7A7A");N(n._id,"todo",t)}).onCancel(()=>{})},K=n=>{l.$q.dialog({title:"\u9009\u62E9\u989C\u8272",message:"\u9009\u62E9\u4F60\u9700\u8981\u6539\u53D8\u7684\u989C\u8272",options:{type:"radio",model:`${n.color}`,inline:!0,items:O},cancel:!0,persistent:!0,ok:{push:!0,label:"\u786E\u5B9A",color:"green"},cancel:{push:!0,color:"blue-grey",label:"\u53D6\u6D88"}}).onOk(t=>{N(n._id,"color",t)})};return(n,t)=>(d(),m(ie,null,{default:a(()=>[pe,c("div",fe,[e(le,{ref_key:"inputRef",ref:S,modelValue:u.todo,"onUpdate:modelValue":t[0]||(t[0]=o=>u.todo=o),"bg-color":"white",class:"col q-pa-none","bottom-slots":"","hide-bottom-space":"",rules:[o=>!!o||"\u8BF7\u8F93\u5165\u5185\u5BB9"],outlined:"",placeholder:"\u8BF7\u8F93\u5165\u60A8\u7684\u5185\u5BB9","lazy-rules":"ondemand",autocomplete:"off",onKeyup:te(B,["enter"])},{prepend:a(()=>[e(p,{name:"event"})]),append:a(()=>[e(oe,{round:"",dense:"",flat:"",icon:"send",disable:D.value,onClick:x(B,["stop"])},{default:a(()=>[e(F,null,{default:a(()=>[_(" \u53D1\u9001 ")]),_:1})]),_:1},8,["disable","onClick"])]),_:1},8,["modelValue","rules","onKeyup"]),c("div",_e,[c("div",ve,[(d(),h(I,null,U(O,(o,i)=>e(se,{key:i,modelValue:u.color,"onUpdate:modelValue":s=>u.color=s,item:o,index:i,"keep-color":"",val:o.value,color:o.color},{default:a(()=>[e(F,{class:P("bg-"+o.color)},{default:a(()=>[_(w(o.label),1)]),_:2},1032,["class"])]),_:2},1032,["modelValue","onUpdate:modelValue","item","index","val","color"])),64))])])]),c("div",be,[e(ne,null,{default:a(()=>[e(ce,{modelValue:V.value,"onUpdate:modelValue":t[1]||(t[1]=o=>V.value=o),dense:"",class:"text-grey q-pa-none","active-color":"primary","indicator-color":"primary",align:"justify","narrow-indicator":""},{default:a(()=>[e(J,{name:"todo",label:"\u4EFB\u52A1"}),e(J,{name:"done",label:"\u5DF2\u5B8C\u6210"})]),_:1},8,["modelValue"]),e(C),e(ue,{modelValue:V.value,"onUpdate:modelValue":t[4]||(t[4]=o=>V.value=o),animated:""},{default:a(()=>[e(Y,{class:"q-pa-none",name:"todo",style:{"min-height":"150px"}},{default:a(()=>[e(T,{separator:"",bordered:""},{default:a(()=>[(d(!0),h(I,null,U($.value,(o,i)=>v((d(),m(b,{key:o._id,item:o,index:i,clickable:""},{default:a(()=>[e(r,{avatar:""},{default:a(()=>[e(M,{modelValue:o.isDone,"onUpdate:modelValue":s=>o.isDone=s,name:"isDone",color:"primary",onClick:x(s=>L("isDone",o._id,o.isDone),["stop"])},null,8,["modelValue","onUpdate:modelValue","onClick"])]),_:2},1024),e(r,null,{default:a(()=>[e(k,null,{default:a(()=>[c("div",{class:P([o.color,"text-body2"])},w(o.todo),3),c("div",ke,w(o.createdAt),1)]),_:2},1024)]),_:2},1024),e(X,{color:"primary",padding:"none",flat:"",size:"sm","dropdown-icon":"change_history",onClick:t[2]||(t[2]=x(()=>{},["stop"]))},{default:a(()=>[e(T,null,{default:a(()=>[v((d(),m(b,{clickable:"",onClick:s=>H(o)},{default:a(()=>[e(r,{avatar:""},{default:a(()=>[e(p,{name:"edit_note",color:"primary",size:"sm"})]),_:1}),e(r,null,{default:a(()=>[e(k,null,{default:a(()=>[_("\u7F16\u8F91")]),_:1})]),_:1})]),_:2},1032,["onClick"])),[[y]]),e(C),v((d(),m(b,{clickable:"",onClick:s=>R(o._id)},{default:a(()=>[e(r,{avatar:""},{default:a(()=>[e(p,{name:"delete",color:"red",size:"sm"})]),_:1}),e(r,null,{default:a(()=>[e(k,null,{default:a(()=>[_("\u5220\u9664")]),_:1})]),_:1})]),_:2},1032,["onClick"])),[[y]]),e(C),v((d(),m(b,{clickable:"",onClick:s=>K(o)},{default:a(()=>[e(r,{avatar:""},{default:a(()=>[e(p,{name:"color_lens",color:"teal",size:"sm"})]),_:1}),e(r,null,{default:a(()=>[e(k,null,{default:a(()=>[_("\u989C\u8272")]),_:1})]),_:1})]),_:2},1032,["onClick"])),[[y]])]),_:2},1024)]),_:2},1024)]),_:2},1032,["item","index"])),[[E]])),128))]),_:1}),$.value.length?j("",!0):(d(),h("div",ge,[e(p,{name:"check",size:"50px",color:"primary",onClick:f}),ye]))]),_:1}),e(Y,{class:"q-pa-none",name:"done",style:{"min-height":"150px"}},{default:a(()=>[e(T,{separator:"",bordered:""},{default:a(()=>[(d(!0),h(I,null,U(z.value,(o,i)=>v((d(),m(b,{key:o._id,item:o,index:i,clickable:""},{default:a(()=>[e(r,{avatar:""},{default:a(()=>[e(M,{modelValue:o.isDone,"onUpdate:modelValue":s=>o.isDone=s,color:"primary",onClick:x(s=>L("isDone",o._id,o.isDone),["stop"])},null,8,["modelValue","onUpdate:modelValue","onClick"])]),_:2},1024),e(r,null,{default:a(()=>[e(k,null,{default:a(()=>[c("div",{class:P(o.color)},w(o.todo),3)]),_:2},1024),c("div",xe,w(o.createdAt),1)]),_:2},1024),e(X,{color:"primary",padding:"none",flat:"",size:"sm","dropdown-icon":"change_history",onClick:t[3]||(t[3]=x(()=>{},["stop"]))},{default:a(()=>[e(T,null,{default:a(()=>[v((d(),m(b,{clickable:"",onClick:s=>H(o)},{default:a(()=>[e(r,{avatar:""},{default:a(()=>[e(p,{name:"edit_note",color:"primary",size:"sm"})]),_:1}),e(r,null,{default:a(()=>[e(k,null,{default:a(()=>[_("\u7F16\u8F91")]),_:1})]),_:1})]),_:2},1032,["onClick"])),[[y]]),e(C),v((d(),m(b,{clickable:"",onClick:s=>R(o._id)},{default:a(()=>[e(r,{avatar:""},{default:a(()=>[e(p,{name:"delete",color:"red",size:"sm"})]),_:1}),e(r,null,{default:a(()=>[e(k,null,{default:a(()=>[_("\u5220\u9664")]),_:1})]),_:1})]),_:2},1032,["onClick"])),[[y]]),e(C),v((d(),m(b,{clickable:"",onClick:s=>K(o)},{default:a(()=>[e(r,{avatar:""},{default:a(()=>[e(p,{name:"color_lens",color:"teal",size:"sm"})]),_:1}),e(r,null,{default:a(()=>[e(k,null,{default:a(()=>[_("\u989C\u8272")]),_:1})]),_:1})]),_:2},1032,["onClick"])),[[y]])]),_:2},1024)]),_:2},1024)]),_:2},1032,["item","index"])),[[E]])),128))]),_:1}),z.value.length?j("",!0):(d(),h("div",he,[e(p,{name:"check",size:"50px",color:"primary",onClick:f}),Ce]))]),_:1})]),_:1},8,["modelValue"])]),_:1})])]),_:1}))}};var Le=W(we,[["__scopeId","data-v-dfadf4ee"]]);export{Le as default};
