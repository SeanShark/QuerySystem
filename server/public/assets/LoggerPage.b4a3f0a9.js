import{a as y,c as it,aB as Lt,f as st,k as ut,bz as $t,r as D,bm as Pt,w as le,d as v,aR as xe,x as ct,g as dt,bA as jt,s as Ie,Q as A,a9 as Nt,ae as Et,aI as vt,ad as tt,R as Ae,bB as Rt,q as ft,o as Ft,ah as It,aT as At,H as Vt,D as Yt,J as me,K as De,L as P,O as I,N as E,S as Ut,M as Qt,Y as Wt,b5 as at,T as $e,b6 as Kt,b7 as Jt,U as Gt,W as Pe,t as Xt,$ as Zt,P as ea}from"./index.9f0a642c.js";import{a as mt,Q as ta}from"./QPage.8b9b498d.js";import{d as aa}from"./use-panel.841774ec.js";import{p as ce,t as oa,a as ot,f as na,d as la,j as je,_ as ra,u as ia}from"./store.ee3c8643.js";import{Q as sa}from"./QSpace.ad76c9f7.js";import{Q as ua}from"./QBtnDropdown.add9f007.js";import{a as nt,Q as ca}from"./position-engine.a9eeaafd.js";import{u as da,a as va,b as fa}from"./use-fullscreen.e38f5eb6.js";import{Q as ma,a as ha}from"./QTabPanels.ceadb13f.js";import{Q as Ne}from"./QSelect.f4be1d98.js";import{C as ga}from"./ClosePopup.868bd096.js";import"./axios.6b484fa5.js";import"./rtl.b51694b1.js";const pa=["gregorian","persian"],ya={modelValue:{required:!0},mask:{type:String},locale:Object,calendar:{type:String,validator:e=>pa.includes(e),default:"gregorian"},landscape:Boolean,color:String,textColor:String,square:Boolean,flat:Boolean,bordered:Boolean,readonly:Boolean,disable:Boolean},ba=["update:modelValue"];function oe(e){return e.year+"/"+ce(e.month)+"/"+ce(e.day)}function _a(e,a){const l=y(()=>e.disable!==!0&&e.readonly!==!0),s=y(()=>l.value===!0?0:-1),m=y(()=>{const _=[];return e.color!==void 0&&_.push(`bg-${e.color}`),e.textColor!==void 0&&_.push(`text-${e.textColor}`),_.join(" ")});function C(){return e.locale!==void 0?{...a.lang.date,...e.locale}:a.lang.date}function f(_){const z=new Date,j=_===!0?null:0;if(e.calendar==="persian"){const k=oa(z);return{year:k.jy,month:k.jm,day:k.jd}}return{year:z.getFullYear(),month:z.getMonth()+1,day:z.getDate(),hour:j,minute:j,second:j,millisecond:j}}return{editable:l,tabindex:s,headerClass:m,getLocale:C,getCurrentDate:f}}const ue=20,wa=["Calendar","Years","Months"],lt=e=>wa.includes(e),Ee=e=>/^-?[\d]+\/[0-1]\d$/.test(e),he=" \u2014 ";function ne(e){return e.year+"/"+ce(e.month)}var Ca=it({name:"QDate",props:{...ya,...Lt,...st,multiple:Boolean,range:Boolean,title:String,subtitle:String,mask:{default:"YYYY/MM/DD"},defaultYearMonth:{type:String,validator:Ee},yearsInMonthView:Boolean,events:[Array,Function],eventColor:[String,Function],emitImmediately:Boolean,options:[Array,Function],navigationMinYearMonth:{type:String,validator:Ee},navigationMaxYearMonth:{type:String,validator:Ee},noUnset:Boolean,firstDayOfWeek:[String,Number],todayBtn:Boolean,minimal:Boolean,defaultView:{type:String,default:"Calendar",validator:lt}},emits:[...ba,"rangeStart","rangeEnd","navigation"],setup(e,{slots:a,emit:l}){const{proxy:s}=dt(),{$q:m}=s,C=ut(e,m),{getCache:f}=aa(),{tabindex:_,headerClass:z,getLocale:j,getCurrentDate:k}=_a(e,m);let L;const O=$t(e),T=jt(O),V=D(null),U=D(We()),H=D(j()),K=y(()=>We()),G=y(()=>j()),Q=y(()=>k()),d=D(Ke(U.value,H.value)),R=D(e.defaultView),Z=m.lang.rtl===!0?"right":"left",F=D(Z.value),re=D(Z.value),ie=d.value.year,ee=D(ie-ie%ue-(ie<0?ue:0)),Y=D(null),ge=y(()=>{const t=e.landscape===!0?"landscape":"portrait";return`q-date q-date--${t} q-date--${t}-${e.minimal===!0?"minimal":"standard"}`+(C.value===!0?" q-date--dark q-dark":"")+(e.bordered===!0?" q-date--bordered":"")+(e.square===!0?" q-date--square no-border-radius":"")+(e.flat===!0?" q-date--flat no-shadow":"")+(e.disable===!0?" disabled":e.readonly===!0?" q-date--readonly":"")}),b=y(()=>e.color||"primary"),g=y(()=>e.textColor||"white"),p=y(()=>e.emitImmediately===!0&&e.multiple!==!0&&e.range!==!0),N=y(()=>Array.isArray(e.modelValue)===!0?e.modelValue:e.modelValue!==null&&e.modelValue!==void 0?[e.modelValue]:[]),$=y(()=>N.value.filter(t=>typeof t=="string").map(t=>ze(t,U.value,H.value)).filter(t=>t.dateHash!==null&&t.day!==null&&t.month!==null&&t.year!==null)),X=y(()=>{const t=o=>ze(o,U.value,H.value);return N.value.filter(o=>Pt(o)===!0&&o.from!==void 0&&o.to!==void 0).map(o=>({from:t(o.from),to:t(o.to)})).filter(o=>o.from.dateHash!==null&&o.to.dateHash!==null&&o.from.dateHash<o.to.dateHash)}),de=y(()=>e.calendar!=="persian"?t=>new Date(t.year,t.month-1,t.day):t=>{const o=ot(t.year,t.month,t.day);return new Date(o.gy,o.gm-1,o.gd)}),pe=y(()=>e.calendar==="persian"?oe:(t,o,n)=>na(new Date(t.year,t.month-1,t.day,t.hour,t.minute,t.second,t.millisecond),o===void 0?U.value:o,n===void 0?H.value:n,t.year,t.timezoneOffset)),te=y(()=>$.value.length+X.value.reduce((t,o)=>t+1+la(de.value(o.to),de.value(o.from)),0)),ye=y(()=>{if(e.title!==void 0&&e.title!==null&&e.title.length!==0)return e.title;if(Y.value!==null){const n=Y.value.init,u=de.value(n);return H.value.daysShort[u.getDay()]+", "+H.value.monthsShort[n.month-1]+" "+n.day+he+"?"}if(te.value===0)return he;if(te.value>1)return`${te.value} ${H.value.pluralDay}`;const t=$.value[0],o=de.value(t);return isNaN(o.valueOf())===!0?he:H.value.headerTitle!==void 0?H.value.headerTitle(o,t):H.value.daysShort[o.getDay()]+", "+H.value.monthsShort[t.month-1]+" "+t.day}),be=y(()=>$.value.concat(X.value.map(o=>o.from)).sort((o,n)=>o.year-n.year||o.month-n.month)[0]),_e=y(()=>$.value.concat(X.value.map(o=>o.to)).sort((o,n)=>n.year-o.year||n.month-o.month)[0]),J=y(()=>{if(e.subtitle!==void 0&&e.subtitle!==null&&e.subtitle.length!==0)return e.subtitle;if(te.value===0)return he;if(te.value>1){const t=be.value,o=_e.value,n=H.value.monthsShort;return n[t.month-1]+(t.year!==o.year?" "+t.year+he+n[o.month-1]+" ":t.month!==o.month?he+n[o.month-1]:"")+" "+o.year}return $.value[0].year}),ae=y(()=>{const t=[m.iconSet.datetime.arrowLeft,m.iconSet.datetime.arrowRight];return m.lang.rtl===!0?t.reverse():t}),Se=y(()=>e.firstDayOfWeek!==void 0?Number(e.firstDayOfWeek):H.value.firstDayOfWeek),r=y(()=>{const t=H.value.daysShort,o=Se.value;return o>0?t.slice(o,7).concat(t.slice(0,o)):t}),i=y(()=>{const t=d.value;return e.calendar!=="persian"?new Date(t.year,t.month,0).getDate():je(t.year,t.month)}),S=y(()=>typeof e.eventColor=="function"?e.eventColor:()=>e.eventColor),x=y(()=>{if(e.navigationMinYearMonth===void 0)return null;const t=e.navigationMinYearMonth.split("/");return{year:parseInt(t[0],10),month:parseInt(t[1],10)}}),B=y(()=>{if(e.navigationMaxYearMonth===void 0)return null;const t=e.navigationMaxYearMonth.split("/");return{year:parseInt(t[0],10),month:parseInt(t[1],10)}}),we=y(()=>{const t={month:{prev:!0,next:!0},year:{prev:!0,next:!0}};return x.value!==null&&x.value.year>=d.value.year&&(t.year.prev=!1,x.value.year===d.value.year&&x.value.month>=d.value.month&&(t.month.prev=!1)),B.value!==null&&B.value.year<=d.value.year&&(t.year.next=!1,B.value.year===d.value.year&&B.value.month<=d.value.month&&(t.month.next=!1)),t}),qe=y(()=>{const t={};return $.value.forEach(o=>{const n=ne(o);t[n]===void 0&&(t[n]=[]),t[n].push(o.day)}),t}),Ye=y(()=>{const t={};return X.value.forEach(o=>{const n=ne(o.from),u=ne(o.to);if(t[n]===void 0&&(t[n]=[]),t[n].push({from:o.from.day,to:n===u?o.to.day:void 0,range:o}),n<u){let c;const{year:q,month:h}=o.from,w=h<12?{year:q,month:h+1}:{year:q+1,month:1};for(;(c=ne(w))<=u;)t[c]===void 0&&(t[c]=[]),t[c].push({from:void 0,to:c===u?o.to.day:void 0,range:o}),w.month++,w.month>12&&(w.year++,w.month=1)}}),t}),Ce=y(()=>{if(Y.value===null)return;const{init:t,initHash:o,final:n,finalHash:u}=Y.value,[c,q]=o<=u?[t,n]:[n,t],h=ne(c),w=ne(q);if(h!==W.value&&w!==W.value)return;const M={};return h===W.value?(M.from=c.day,M.includeFrom=!0):M.from=1,w===W.value?(M.to=q.day,M.includeTo=!0):M.to=i.value,M}),W=y(()=>ne(d.value)),_t=y(()=>{const t={};if(e.options===void 0){for(let n=1;n<=i.value;n++)t[n]=!0;return t}const o=typeof e.options=="function"?e.options:n=>e.options.includes(n);for(let n=1;n<=i.value;n++){const u=W.value+"/"+ce(n);t[n]=o(u)}return t}),wt=y(()=>{const t={};if(e.events===void 0)for(let o=1;o<=i.value;o++)t[o]=!1;else{const o=typeof e.events=="function"?e.events:n=>e.events.includes(n);for(let n=1;n<=i.value;n++){const u=W.value+"/"+ce(n);t[n]=o(u)===!0&&S.value(u)}}return t}),Ct=y(()=>{let t,o;const{year:n,month:u}=d.value;if(e.calendar!=="persian")t=new Date(n,u-1,1),o=new Date(n,u-1,0).getDate();else{const c=ot(n,u,1);t=new Date(c.gy,c.gm-1,c.gd);let q=u-1,h=n;q===0&&(q=12,h--),o=je(h,q)}return{days:t.getDay()-Se.value-1,endDay:o}}),Ue=y(()=>{const t=[],{days:o,endDay:n}=Ct.value,u=o<0?o+7:o;if(u<6)for(let h=n-u;h<=n;h++)t.push({i:h,fill:!0});const c=t.length;for(let h=1;h<=i.value;h++){const w={i:h,event:wt.value[h],classes:[]};_t.value[h]===!0&&(w.in=!0,w.flat=!0),t.push(w)}if(qe.value[W.value]!==void 0&&qe.value[W.value].forEach(h=>{const w=c+h-1;Object.assign(t[w],{selected:!0,unelevated:!0,flat:!1,color:b.value,textColor:g.value})}),Ye.value[W.value]!==void 0&&Ye.value[W.value].forEach(h=>{if(h.from!==void 0){const w=c+h.from-1,M=c+(h.to||i.value)-1;for(let ke=w;ke<=M;ke++)Object.assign(t[ke],{range:h.range,unelevated:!0,color:b.value,textColor:g.value});Object.assign(t[w],{rangeFrom:!0,flat:!1}),h.to!==void 0&&Object.assign(t[M],{rangeTo:!0,flat:!1})}else if(h.to!==void 0){const w=c+h.to-1;for(let M=c;M<=w;M++)Object.assign(t[M],{range:h.range,unelevated:!0,color:b.value,textColor:g.value});Object.assign(t[w],{flat:!1,rangeTo:!0})}else{const w=c+i.value-1;for(let M=c;M<=w;M++)Object.assign(t[M],{range:h.range,unelevated:!0,color:b.value,textColor:g.value})}}),Ce.value!==void 0){const h=c+Ce.value.from-1,w=c+Ce.value.to-1;for(let M=h;M<=w;M++)t[M].color=b.value,t[M].editRange=!0;Ce.value.includeFrom===!0&&(t[h].editRangeFrom=!0),Ce.value.includeTo===!0&&(t[w].editRangeTo=!0)}d.value.year===Q.value.year&&d.value.month===Q.value.month&&(t[c+Q.value.day-1].today=!0);const q=t.length%7;if(q>0){const h=7-q;for(let w=1;w<=h;w++)t.push({i:w,fill:!0})}return t.forEach(h=>{let w="q-date__calendar-item ";h.fill===!0?w+="q-date__calendar-item--fill":(w+=`q-date__calendar-item--${h.in===!0?"in":"out"}`,h.range!==void 0&&(w+=` q-date__range${h.rangeTo===!0?"-to":h.rangeFrom===!0?"-from":""}`),h.editRange===!0&&(w+=` q-date__edit-range${h.editRangeFrom===!0?"-from":""}${h.editRangeTo===!0?"-to":""}`),(h.range!==void 0||h.editRange===!0)&&(w+=` text-${h.color}`)),h.classes=w}),t}),kt=y(()=>e.disable===!0?{"aria-disabled":"true"}:{});le(()=>e.modelValue,t=>{if(L===t)L=0;else{const o=Ke(U.value,H.value);ve(o.year,o.month,o)}}),le(R,()=>{V.value!==null&&s.$el.contains(document.activeElement)===!0&&V.value.focus()}),le(()=>d.value.year+"|"+d.value.month,()=>{l("navigation",{year:d.value.year,month:d.value.month})}),le(K,t=>{et(t,H.value,"mask"),U.value=t}),le(G,t=>{et(U.value,t,"locale"),H.value=t});function Qe(){const{year:t,month:o,day:n}=Q.value,u={...d.value,year:t,month:o,day:n},c=qe.value[ne(u)];(c===void 0||c.includes(u.day)===!1)&&Be(u),He(u.year,u.month)}function xt(t){lt(t)===!0&&(R.value=t)}function St(t,o){["month","year"].includes(t)&&(t==="month"?Ge:Oe)(o===!0?-1:1)}function He(t,o){R.value="Calendar",ve(t,o)}function qt(t,o){if(e.range===!1||!t){Y.value=null;return}const n=Object.assign({...d.value},t),u=o!==void 0?Object.assign({...d.value},o):n;Y.value={init:n,initHash:oe(n),final:u,finalHash:oe(u)},He(n.year,n.month)}function We(){return e.calendar==="persian"?"YYYY/MM/DD":e.mask}function ze(t,o,n){return ra(t,o,n,e.calendar,{hour:0,minute:0,second:0,millisecond:0})}function Ke(t,o){const n=Array.isArray(e.modelValue)===!0?e.modelValue:e.modelValue?[e.modelValue]:[];if(n.length===0)return Je();const u=n[n.length-1],c=ze(u.from!==void 0?u.from:u,t,o);return c.dateHash===null?Je():c}function Je(){let t,o;if(e.defaultYearMonth!==void 0){const n=e.defaultYearMonth.split("/");t=parseInt(n[0],10),o=parseInt(n[1],10)}else{const n=Q.value!==void 0?Q.value:k();t=n.year,o=n.month}return{year:t,month:o,day:1,hour:0,minute:0,second:0,millisecond:0,dateHash:t+"/"+ce(o)+"/01"}}function Ge(t){let o=d.value.year,n=Number(d.value.month)+t;n===13?(n=1,o++):n===0&&(n=12,o--),ve(o,n),p.value===!0&&Te("month")}function Oe(t){const o=Number(d.value.year)+t;ve(o,d.value.month),p.value===!0&&Te("year")}function Tt(t){ve(t,d.value.month),R.value=e.defaultView==="Years"?"Months":"Calendar",p.value===!0&&Te("year")}function Dt(t){ve(d.value.year,t),R.value="Calendar",p.value===!0&&Te("month")}function Ht(t,o){const n=qe.value[o];(n!==void 0&&n.includes(t.day)===!0?Me:Be)(t)}function se(t){return{year:t.year,month:t.month,day:t.day}}function ve(t,o,n){if(x.value!==null&&t<=x.value.year&&((o<x.value.month||t<x.value.year)&&(o=x.value.month),t=x.value.year),B.value!==null&&t>=B.value.year&&((o>B.value.month||t>B.value.year)&&(o=B.value.month),t=B.value.year),n!==void 0){const{hour:c,minute:q,second:h,millisecond:w,timezoneOffset:M,timeHash:ke}=n;Object.assign(d.value,{hour:c,minute:q,second:h,millisecond:w,timezoneOffset:M,timeHash:ke})}const u=t+"/"+ce(o)+"/01";u!==d.value.dateHash&&(F.value=d.value.dateHash<u==(m.lang.rtl!==!0)?"left":"right",t!==d.value.year&&(re.value=F.value),Ie(()=>{ee.value=t-t%ue-(t<0?ue:0),Object.assign(d.value,{year:t,month:o,day:1,dateHash:u})}))}function Xe(t,o,n){const u=t!==null&&t.length===1&&e.multiple===!1?t[0]:t;L=u;const{reason:c,details:q}=Ze(o,n);l("update:modelValue",u,c,q)}function Te(t){const o=$.value[0]!==void 0&&$.value[0].dateHash!==null?{...$.value[0]}:{...d.value};Ie(()=>{o.year=d.value.year,o.month=d.value.month;const n=e.calendar!=="persian"?new Date(o.year,o.month,0).getDate():je(o.year,o.month);o.day=Math.min(Math.max(1,o.day),n);const u=fe(o);L=u;const{details:c}=Ze("",o);l("update:modelValue",u,t,c)})}function Ze(t,o){return o.from!==void 0?{reason:`${t}-range`,details:{...se(o.target),from:se(o.from),to:se(o.to)}}:{reason:`${t}-day`,details:se(o)}}function fe(t,o,n){return t.from!==void 0?{from:pe.value(t.from,o,n),to:pe.value(t.to,o,n)}:pe.value(t,o,n)}function Be(t){let o;if(e.multiple===!0)if(t.from!==void 0){const n=oe(t.from),u=oe(t.to),c=$.value.filter(h=>h.dateHash<n||h.dateHash>u),q=X.value.filter(({from:h,to:w})=>w.dateHash<n||h.dateHash>u);o=c.concat(q).concat(t).map(h=>fe(h))}else{const n=N.value.slice();n.push(fe(t)),o=n}else o=fe(t);Xe(o,"add",t)}function Me(t){if(e.noUnset===!0)return;let o=null;if(e.multiple===!0&&Array.isArray(e.modelValue)===!0){const n=fe(t);t.from!==void 0?o=e.modelValue.filter(u=>u.from!==void 0?u.from!==n.from&&u.to!==n.to:!0):o=e.modelValue.filter(u=>u!==n),o.length===0&&(o=null)}Xe(o,"remove",t)}function et(t,o,n){const u=$.value.concat(X.value).map(c=>fe(c,t,o)).filter(c=>c.from!==void 0?c.from.dateHash!==null&&c.to.dateHash!==null:c.dateHash!==null);l("update:modelValue",(e.multiple===!0?u:u[0])||null,n)}function zt(){if(e.minimal!==!0)return v("div",{class:"q-date__header "+z.value},[v("div",{class:"relative-position"},[v(xe,{name:"q-transition--fade"},()=>v("div",{key:"h-yr-"+J.value,class:"q-date__header-subtitle q-date__header-link "+(R.value==="Years"?"q-date__header-link--active":"cursor-pointer"),tabindex:_.value,...f("vY",{onClick(){R.value="Years"},onKeyup(t){t.keyCode===13&&(R.value="Years")}})},[J.value]))]),v("div",{class:"q-date__header-title relative-position flex no-wrap"},[v("div",{class:"relative-position col"},[v(xe,{name:"q-transition--fade"},()=>v("div",{key:"h-sub"+ye.value,class:"q-date__header-title-label q-date__header-link "+(R.value==="Calendar"?"q-date__header-link--active":"cursor-pointer"),tabindex:_.value,...f("vC",{onClick(){R.value="Calendar"},onKeyup(t){t.keyCode===13&&(R.value="Calendar")}})},[ye.value]))]),e.todayBtn===!0?v(A,{class:"q-date__header-today self-start",icon:m.iconSet.datetime.today,flat:!0,size:"sm",round:!0,tabindex:_.value,onClick:Qe}):null])])}function Le({label:t,type:o,key:n,dir:u,goTo:c,boundaries:q,cls:h}){return[v("div",{class:"row items-center q-date__arrow"},[v(A,{round:!0,dense:!0,size:"sm",flat:!0,icon:ae.value[0],tabindex:_.value,disable:q.prev===!1,...f("go-#"+o,{onClick(){c(-1)}})})]),v("div",{class:"relative-position overflow-hidden flex flex-center"+h},[v(xe,{name:"q-transition--jump-"+u},()=>v("div",{key:n},[v(A,{flat:!0,dense:!0,noCaps:!0,label:t,tabindex:_.value,...f("view#"+o,{onClick:()=>{R.value=o}})})]))]),v("div",{class:"row items-center q-date__arrow"},[v(A,{round:!0,dense:!0,size:"sm",flat:!0,icon:ae.value[1],tabindex:_.value,disable:q.next===!1,...f("go+#"+o,{onClick(){c(1)}})})])]}const Ot={Calendar:()=>[v("div",{key:"calendar-view",class:"q-date__view q-date__calendar"},[v("div",{class:"q-date__navigation row items-center no-wrap"},Le({label:H.value.months[d.value.month-1],type:"Months",key:d.value.month,dir:F.value,goTo:Ge,boundaries:we.value.month,cls:" col"}).concat(Le({label:d.value.year,type:"Years",key:d.value.year,dir:re.value,goTo:Oe,boundaries:we.value.year,cls:""}))),v("div",{class:"q-date__calendar-weekdays row items-center no-wrap"},r.value.map(t=>v("div",{class:"q-date__calendar-item"},[v("div",t)]))),v("div",{class:"q-date__calendar-days-container relative-position overflow-hidden"},[v(xe,{name:"q-transition--slide-"+F.value},()=>v("div",{key:W.value,class:"q-date__calendar-days fit"},Ue.value.map(t=>v("div",{class:t.classes},[t.in===!0?v(A,{class:t.today===!0?"q-date__today":"",dense:!0,flat:t.flat,unelevated:t.unelevated,color:t.color,textColor:t.textColor,label:t.i,tabindex:_.value,...f("day#"+t.i,{onClick:()=>{Bt(t.i)},onMouseover:()=>{Mt(t.i)}})},t.event!==!1?()=>v("div",{class:"q-date__event bg-"+t.event}):null):v("div",""+t.i)]))))])])],Months(){const t=d.value.year===Q.value.year,o=u=>x.value!==null&&d.value.year===x.value.year&&x.value.month>u||B.value!==null&&d.value.year===B.value.year&&B.value.month<u,n=H.value.monthsShort.map((u,c)=>{const q=d.value.month===c+1;return v("div",{class:"q-date__months-item flex flex-center"},[v(A,{class:t===!0&&Q.value.month===c+1?"q-date__today":null,flat:q!==!0,label:u,unelevated:q,color:q===!0?b.value:null,textColor:q===!0?g.value:null,tabindex:_.value,disable:o(c+1),...f("month#"+c,{onClick:()=>{Dt(c+1)}})})])});return e.yearsInMonthView===!0&&n.unshift(v("div",{class:"row no-wrap full-width"},[Le({label:d.value.year,type:"Years",key:d.value.year,dir:re.value,goTo:Oe,boundaries:we.value.year,cls:" col"})])),v("div",{key:"months-view",class:"q-date__view q-date__months flex flex-center"},n)},Years(){const t=ee.value,o=t+ue,n=[],u=c=>x.value!==null&&x.value.year>c||B.value!==null&&B.value.year<c;for(let c=t;c<=o;c++){const q=d.value.year===c;n.push(v("div",{class:"q-date__years-item flex flex-center"},[v(A,{key:"yr"+c,class:Q.value.year===c?"q-date__today":null,flat:!q,label:c,dense:!0,unelevated:q,color:q===!0?b.value:null,textColor:q===!0?g.value:null,tabindex:_.value,disable:u(c),...f("yr#"+c,{onClick:()=>{Tt(c)}})})]))}return v("div",{class:"q-date__view q-date__years flex flex-center"},[v("div",{class:"col-auto"},[v(A,{round:!0,dense:!0,flat:!0,icon:ae.value[0],tabindex:_.value,disable:u(t),...f("y-",{onClick:()=>{ee.value-=ue}})})]),v("div",{class:"q-date__years-content col self-stretch row items-center"},n),v("div",{class:"col-auto"},[v(A,{round:!0,dense:!0,flat:!0,icon:ae.value[1],tabindex:_.value,disable:u(o),...f("y+",{onClick:()=>{ee.value+=ue}})})])])}};function Bt(t){const o={...d.value,day:t};if(e.range===!1){Ht(o,W.value);return}if(Y.value===null){const n=Ue.value.find(c=>c.fill!==!0&&c.i===t);if(e.noUnset!==!0&&n.range!==void 0){Me({target:o,from:n.range.from,to:n.range.to});return}if(n.selected===!0){Me(o);return}const u=oe(o);Y.value={init:o,initHash:u,final:o,finalHash:u},l("rangeStart",se(o))}else{const n=Y.value.initHash,u=oe(o),c=n<=u?{from:Y.value.init,to:o}:{from:o,to:Y.value.init};Y.value=null,Be(n===u?o:{target:o,...c}),l("rangeEnd",{from:se(c.from),to:se(c.to)})}}function Mt(t){if(Y.value!==null){const o={...d.value,day:t};Object.assign(Y.value,{final:o,finalHash:oe(o)})}}return Object.assign(s,{setToday:Qe,setView:xt,offsetCalendar:St,setCalendarTo:He,setEditingRange:qt}),()=>{const t=[v("div",{class:"q-date__content col relative-position"},[v(xe,{name:"q-transition--fade"},Ot[R.value])])],o=ct(a.default);return o!==void 0&&t.push(v("div",{class:"q-date__actions"},o)),e.name!==void 0&&e.disable!==!0&&T(t,"push"),v("div",{class:ge.value,...kt.value},[zt(),v("div",{ref:V,class:"q-date__main col column",tabindex:-1},t)])}}});function ht(e,a){if(a&&e===a)return null;const l=e.nodeName.toLowerCase();if(["div","li","ul","ol","blockquote"].includes(l)===!0)return e;const s=window.getComputedStyle?window.getComputedStyle(e):e.currentStyle,m=s.display;return m==="block"||m==="table"?e:ht(e.parentNode)}function Re(e,a,l){return!e||e===document.body?!1:l===!0&&e===a||(a===document?document.body:a).contains(e.parentNode)}function gt(e,a,l){if(l||(l=document.createRange(),l.selectNode(e),l.setStart(e,0)),a.count===0)l.setEnd(e,a.count);else if(a.count>0)if(e.nodeType===Node.TEXT_NODE)e.textContent.length<a.count?a.count-=e.textContent.length:(l.setEnd(e,a.count),a.count=0);else for(let s=0;a.count!==0&&s<e.childNodes.length;s++)l=gt(e.childNodes[s],a,l);return l}const ka=/^https?:\/\//;class xa{constructor(a,l){this.el=a,this.eVm=l,this._range=null}get selection(){if(this.el){const a=document.getSelection();if(Re(a.anchorNode,this.el,!0)&&Re(a.focusNode,this.el,!0))return a}return null}get hasSelection(){return this.selection!==null?this.selection.toString().length!==0:!1}get range(){const a=this.selection;return a!==null&&a.rangeCount?a.getRangeAt(0):this._range}get parent(){const a=this.range;if(a!==null){const l=a.startContainer;return l.nodeType===document.ELEMENT_NODE?l:l.parentNode}return null}get blockParent(){const a=this.parent;return a!==null?ht(a,this.el):null}save(a=this.range){a!==null&&(this._range=a)}restore(a=this._range){const l=document.createRange(),s=document.getSelection();a!==null?(l.setStart(a.startContainer,a.startOffset),l.setEnd(a.endContainer,a.endOffset),s.removeAllRanges(),s.addRange(l)):(s.selectAllChildren(this.el),s.collapseToEnd())}savePosition(){let a=-1,l;const s=document.getSelection(),m=this.el.parentNode;if(s.focusNode&&Re(s.focusNode,m))for(l=s.focusNode,a=s.focusOffset;l&&l!==m;)l!==this.el&&l.previousSibling?(l=l.previousSibling,a+=l.textContent.length):l=l.parentNode;this.savedPos=a}restorePosition(a=0){if(this.savedPos>0&&this.savedPos<a){const l=window.getSelection(),s=gt(this.el,{count:this.savedPos});s&&(s.collapse(!1),l.removeAllRanges(),l.addRange(s))}}hasParent(a,l){const s=l?this.parent:this.blockParent;return s!==null?s.nodeName.toLowerCase()===a.toLowerCase():!1}hasParents(a,l,s=this.parent){return s===null?!1:a.includes(s.nodeName.toLowerCase())===!0?!0:l===!0?this.hasParents(a,l,s.parentNode):!1}is(a,l){if(this.selection===null)return!1;switch(a){case"formatBlock":return l==="DIV"&&this.parent===this.el||this.hasParent(l,l==="PRE");case"link":return this.hasParent("A",!0);case"fontSize":return document.queryCommandValue(a)===l;case"fontName":const s=document.queryCommandValue(a);return s===`"${l}"`||s===l;case"fullscreen":return this.eVm.inFullscreen.value;case"viewsource":return this.eVm.isViewingSource.value;case void 0:return!1;default:const m=document.queryCommandState(a);return l!==void 0?m===l:m}}getParentAttribute(a){return this.parent!==null?this.parent.getAttribute(a):null}can(a){if(a==="outdent")return this.hasParents(["blockquote","li"],!0);if(a==="indent")return this.hasParents(["li"],!0);if(a==="link")return this.selection!==null||this.is("link")}apply(a,l,s=Nt){if(a==="formatBlock")["BLOCKQUOTE","H1","H2","H3","H4","H5","H6"].includes(l)&&this.is(a,l)&&(a="outdent",l=null),l==="PRE"&&this.is(a,"PRE")&&(l="P");else if(a==="print"){s();const m=window.open();m.document.write(`
        <!doctype html>
        <html>
          <head>
            <title>Print - ${document.title}</title>
          </head>
          <body>
            <div>${this.el.innerHTML}</div>
          </body>
        </html>
      `),m.print(),m.close();return}else if(a==="link"){const m=this.getParentAttribute("href");if(m===null){const C=this.selectWord(this.selection),f=C?C.toString():"";if(!f.length&&(!this.range||!this.range.cloneContents().querySelector("img")))return;this.eVm.editLinkUrl.value=ka.test(f)?f:"https://",document.execCommand("createLink",!1,this.eVm.editLinkUrl.value),this.save(C.getRangeAt(0))}else this.eVm.editLinkUrl.value=m,this.range.selectNodeContents(this.parent),this.save();return}else if(a==="fullscreen"){this.eVm.toggleFullscreen(),s();return}else if(a==="viewsource"){this.eVm.isViewingSource.value=this.eVm.isViewingSource.value===!1,this.eVm.setContent(this.eVm.props.modelValue),s();return}document.execCommand(a,!1,l),s()}selectWord(a){if(a===null||a.isCollapsed!==!0||a.modify===void 0)return a;const l=document.createRange();l.setStart(a.anchorNode,a.anchorOffset),l.setEnd(a.focusNode,a.focusOffset);const s=l.collapsed?["backward","forward"]:["forward","backward"];l.detach();const m=a.focusNode,C=a.focusOffset;return a.collapse(a.anchorNode,a.anchorOffset),a.modify("move",s[0],"character"),a.modify("move",s[1],"word"),a.extend(m,C),a.modify("extend",s[1],"character"),a.modify("extend",s[0],"word"),a}}function pt(e,a,l){a.handler?a.handler(e,l,l.caret):l.runCmd(a.cmd,a.param)}function Ve(e){return v("div",{class:"q-editor__toolbar-group"},e)}function yt(e,a,l,s=!1){const m=s||(a.type==="toggle"?a.toggled?a.toggled(e):a.cmd&&e.caret.is(a.cmd,a.param):!1),C=[];if(a.tip&&e.$q.platform.is.desktop){const f=a.key?v("div",[v("small",`(CTRL + ${String.fromCharCode(a.key)})`)]):null;C.push(v(mt,{delay:1e3},()=>[v("div",{innerHTML:a.tip}),f]))}return v(A,{...e.buttonProps.value,icon:a.icon!==null?a.icon:void 0,color:m?a.toggleColor||e.props.toolbarToggleColor:a.color||e.props.toolbarColor,textColor:m&&!e.props.toolbarPush?null:a.textColor||e.props.toolbarTextColor,label:a.label,disable:a.disable?typeof a.disable=="function"?a.disable(e):!0:!1,size:"sm",onClick(f){l&&l(),pt(f,a,e)}},()=>C)}function Sa(e,a){const l=a.list==="only-icons";let s=a.label,m=a.icon!==null?a.icon:void 0,C,f;function _(){j.component.proxy.hide()}if(l)f=a.options.map(k=>{const L=k.type===void 0?e.caret.is(k.cmd,k.param):!1;return L&&(s=k.tip,m=k.icon!==null?k.icon:void 0),yt(e,k,_,L)}),C=e.toolbarBackgroundClass.value,f=[Ve(f)];else{const k=e.props.toolbarToggleColor!==void 0?`text-${e.props.toolbarToggleColor}`:null,L=e.props.toolbarTextColor!==void 0?`text-${e.props.toolbarTextColor}`:null,O=a.list==="no-icons";f=a.options.map(T=>{const V=T.disable?T.disable(e):!1,U=T.type===void 0?e.caret.is(T.cmd,T.param):!1;U&&(s=T.tip,m=T.icon!==null?T.icon:void 0);const H=T.htmlTip;return v(ca,{active:U,activeClass:k,clickable:!0,disable:V,dense:!0,onClick(K){_(),e.contentRef.value!==null&&e.contentRef.value.focus(),e.caret.restore(),pt(K,T,e)}},()=>[O===!0?null:v(nt,{class:U?k:L,side:!0},()=>v(Ae,{name:T.icon!==null?T.icon:void 0})),v(nt,H?()=>v("div",{class:"text-no-wrap",innerHTML:T.htmlTip}):T.tip?()=>v("div",{class:"text-no-wrap"},T.tip):void 0)])}),C=[e.toolbarBackgroundClass.value,L]}const z=a.highlight&&s!==a.label,j=v(ua,{...e.buttonProps.value,noCaps:!0,noWrap:!0,color:z?e.props.toolbarToggleColor:e.props.toolbarColor,textColor:z&&!e.props.toolbarPush?null:e.props.toolbarTextColor,label:a.fixedLabel?a.label:s,icon:a.fixedIcon?a.icon!==null?a.icon:void 0:m,contentClass:C,onShow:k=>e.emit("dropdownShow",k),onHide:k=>e.emit("dropdownHide",k),onBeforeShow:k=>e.emit("dropdownBeforeShow",k),onBeforeHide:k=>e.emit("dropdownBeforeHide",k)},()=>f);return j}function qa(e){if(e.caret)return e.buttons.value.filter(a=>!e.isViewingSource.value||a.find(l=>l.cmd==="viewsource")).map(a=>Ve(a.map(l=>e.isViewingSource.value&&l.cmd!=="viewsource"?!1:l.type==="slot"?ct(e.slots[l.slot]):l.type==="dropdown"?Sa(e,l):yt(e,l))))}function Ta(e,a,l,s={}){const m=Object.keys(s);if(m.length===0)return{};const C={default_font:{cmd:"fontName",param:e,icon:l,tip:a}};return m.forEach(f=>{const _=s[f];C[f]={cmd:"fontName",param:_,icon:l,tip:_,htmlTip:`<font face="${_}">${_}</font>`}}),C}function Da(e){if(e.caret){const a=e.props.toolbarColor||e.props.toolbarTextColor;let l=e.editLinkUrl.value;const s=()=>{e.caret.restore(),l!==e.editLinkUrl.value&&document.execCommand("createLink",!1,l===""?" ":l),e.editLinkUrl.value=null};return[v("div",{class:`q-mx-xs text-${a}`},`${e.$q.lang.editor.url}: `),v("input",{key:"qedt_btm_input",class:"col q-editor__link-input",value:l,onInput:m=>{Et(m),l=m.target.value},onKeydown:m=>{if(vt(m)!==!0)switch(m.keyCode){case 13:return tt(m),s();case 27:tt(m),e.caret.restore(),(!e.editLinkUrl.value||e.editLinkUrl.value==="https://")&&document.execCommand("unlink"),e.editLinkUrl.value=null;break}}}),Ve([v(A,{key:"qedt_btm_rem",tabindex:-1,...e.buttonProps.value,label:e.$q.lang.label.remove,noCaps:!0,onClick:()=>{e.caret.restore(),document.execCommand("unlink"),e.editLinkUrl.value=null}}),v(A,{key:"qedt_btm_upd",...e.buttonProps.value,label:e.$q.lang.label.update,noCaps:!0,onClick:s})])]}}const Ha=Object.prototype.toString,Fe=Object.prototype.hasOwnProperty,za=new Set(["Boolean","Number","String","Function","Array","Date","RegExp"].map(e=>"[object "+e+"]"));function rt(e){if(e!==Object(e)||za.has(Ha.call(e))===!0||e.constructor&&Fe.call(e,"constructor")===!1&&Fe.call(e.constructor.prototype,"isPrototypeOf")===!1)return!1;let a;for(a in e);return a===void 0||Fe.call(e,a)}function bt(){let e,a,l,s,m,C,f=arguments[0]||{},_=1,z=!1;const j=arguments.length;for(typeof f=="boolean"&&(z=f,f=arguments[1]||{},_=2),Object(f)!==f&&typeof f!="function"&&(f={}),j===_&&(f=this,_--);_<j;_++)if((e=arguments[_])!==null)for(a in e)l=f[a],s=e[a],f!==s&&(z===!0&&s&&((m=Array.isArray(s))||rt(s)===!0)?(m===!0?C=Array.isArray(l)===!0?l:[]:C=rt(l)===!0?l:{},f[a]=bt(z,C,s)):s!==void 0&&(f[a]=s));return f}var Oa=it({name:"QEditor",props:{...st,...da,modelValue:{type:String,required:!0},readonly:Boolean,disable:Boolean,minHeight:{type:String,default:"10rem"},maxHeight:String,height:String,definitions:Object,fonts:Object,placeholder:String,toolbar:{type:Array,validator:e=>e.length===0||e.every(a=>a.length),default(){return[["left","center","right","justify"],["bold","italic","underline","strike"],["undo","redo"]]}},toolbarColor:String,toolbarBg:String,toolbarTextColor:String,toolbarToggleColor:{type:String,default:"primary"},toolbarOutline:Boolean,toolbarPush:Boolean,toolbarRounded:Boolean,paragraphTag:{type:String,validator:e=>["div","p"].includes(e),default:"div"},contentStyle:Object,contentClass:[Object,Array,String],square:Boolean,flat:Boolean,dense:Boolean},emits:[...va,"update:modelValue","keydown","click","mouseup","keyup","touchend","focus","blur","dropdownShow","dropdownHide","dropdownBeforeShow","dropdownBeforeHide","linkShow","linkHide"],setup(e,{slots:a,emit:l,attrs:s}){const{proxy:m,vnode:C}=dt(),{$q:f}=m,_=ut(e,f),{inFullscreen:z,toggleFullscreen:j}=fa(),k=Rt(s,C),L=D(null),O=D(null),T=D(null),V=D(!1),U=y(()=>!e.readonly&&!e.disable);let H,K,G=e.modelValue;document.execCommand("defaultParagraphSeparator",!1,e.paragraphTag),H=window.getComputedStyle(document.body).fontFamily;const Q=y(()=>e.toolbarBg?` bg-${e.toolbarBg}`:""),d=y(()=>{const r=e.toolbarOutline!==!0&&e.toolbarPush!==!0;return{type:"a",flat:r,noWrap:!0,outline:e.toolbarOutline,push:e.toolbarPush,rounded:e.toolbarRounded,dense:!0,color:e.toolbarColor,disable:!U.value,size:"sm"}}),R=y(()=>{const r=f.lang.editor,i=f.iconSet.editor;return{bold:{cmd:"bold",icon:i.bold,tip:r.bold,key:66},italic:{cmd:"italic",icon:i.italic,tip:r.italic,key:73},strike:{cmd:"strikeThrough",icon:i.strikethrough,tip:r.strikethrough,key:83},underline:{cmd:"underline",icon:i.underline,tip:r.underline,key:85},unordered:{cmd:"insertUnorderedList",icon:i.unorderedList,tip:r.unorderedList},ordered:{cmd:"insertOrderedList",icon:i.orderedList,tip:r.orderedList},subscript:{cmd:"subscript",icon:i.subscript,tip:r.subscript,htmlTip:"x<subscript>2</subscript>"},superscript:{cmd:"superscript",icon:i.superscript,tip:r.superscript,htmlTip:"x<superscript>2</superscript>"},link:{cmd:"link",disable:S=>S.caret&&!S.caret.can("link"),icon:i.hyperlink,tip:r.hyperlink,key:76},fullscreen:{cmd:"fullscreen",icon:i.toggleFullscreen,tip:r.toggleFullscreen,key:70},viewsource:{cmd:"viewsource",icon:i.viewSource,tip:r.viewSource},quote:{cmd:"formatBlock",param:"BLOCKQUOTE",icon:i.quote,tip:r.quote,key:81},left:{cmd:"justifyLeft",icon:i.left,tip:r.left},center:{cmd:"justifyCenter",icon:i.center,tip:r.center},right:{cmd:"justifyRight",icon:i.right,tip:r.right},justify:{cmd:"justifyFull",icon:i.justify,tip:r.justify},print:{type:"no-state",cmd:"print",icon:i.print,tip:r.print,key:80},outdent:{type:"no-state",disable:S=>S.caret&&!S.caret.can("outdent"),cmd:"outdent",icon:i.outdent,tip:r.outdent},indent:{type:"no-state",disable:S=>S.caret&&!S.caret.can("indent"),cmd:"indent",icon:i.indent,tip:r.indent},removeFormat:{type:"no-state",cmd:"removeFormat",icon:i.removeFormat,tip:r.removeFormat},hr:{type:"no-state",cmd:"insertHorizontalRule",icon:i.hr,tip:r.hr},undo:{type:"no-state",cmd:"undo",icon:i.undo,tip:r.undo,key:90},redo:{type:"no-state",cmd:"redo",icon:i.redo,tip:r.redo,key:89},h1:{cmd:"formatBlock",param:"H1",icon:i.heading1||i.heading,tip:r.heading1,htmlTip:`<h1 class="q-ma-none">${r.heading1}</h1>`},h2:{cmd:"formatBlock",param:"H2",icon:i.heading2||i.heading,tip:r.heading2,htmlTip:`<h2 class="q-ma-none">${r.heading2}</h2>`},h3:{cmd:"formatBlock",param:"H3",icon:i.heading3||i.heading,tip:r.heading3,htmlTip:`<h3 class="q-ma-none">${r.heading3}</h3>`},h4:{cmd:"formatBlock",param:"H4",icon:i.heading4||i.heading,tip:r.heading4,htmlTip:`<h4 class="q-ma-none">${r.heading4}</h4>`},h5:{cmd:"formatBlock",param:"H5",icon:i.heading5||i.heading,tip:r.heading5,htmlTip:`<h5 class="q-ma-none">${r.heading5}</h5>`},h6:{cmd:"formatBlock",param:"H6",icon:i.heading6||i.heading,tip:r.heading6,htmlTip:`<h6 class="q-ma-none">${r.heading6}</h6>`},p:{cmd:"formatBlock",param:e.paragraphTag,icon:i.heading,tip:r.paragraph},code:{cmd:"formatBlock",param:"PRE",icon:i.code,htmlTip:`<code>${r.code}</code>`},"size-1":{cmd:"fontSize",param:"1",icon:i.size1||i.size,tip:r.size1,htmlTip:`<font size="1">${r.size1}</font>`},"size-2":{cmd:"fontSize",param:"2",icon:i.size2||i.size,tip:r.size2,htmlTip:`<font size="2">${r.size2}</font>`},"size-3":{cmd:"fontSize",param:"3",icon:i.size3||i.size,tip:r.size3,htmlTip:`<font size="3">${r.size3}</font>`},"size-4":{cmd:"fontSize",param:"4",icon:i.size4||i.size,tip:r.size4,htmlTip:`<font size="4">${r.size4}</font>`},"size-5":{cmd:"fontSize",param:"5",icon:i.size5||i.size,tip:r.size5,htmlTip:`<font size="5">${r.size5}</font>`},"size-6":{cmd:"fontSize",param:"6",icon:i.size6||i.size,tip:r.size6,htmlTip:`<font size="6">${r.size6}</font>`},"size-7":{cmd:"fontSize",param:"7",icon:i.size7||i.size,tip:r.size7,htmlTip:`<font size="7">${r.size7}</font>`}}}),Z=y(()=>{const r=e.definitions||{},i=e.definitions||e.fonts?bt(!0,{},R.value,r,Ta(H,f.lang.editor.defaultFont,f.iconSet.editor.font,e.fonts)):R.value;return e.toolbar.map(S=>S.map(x=>{if(x.options)return{type:"dropdown",icon:x.icon,label:x.label,size:"sm",dense:!0,fixedLabel:x.fixedLabel,fixedIcon:x.fixedIcon,highlight:x.highlight,list:x.list,options:x.options.map(we=>i[we])};const B=i[x];return B?B.type==="no-state"||r[x]&&(B.cmd===void 0||R.value[B.cmd]&&R.value[B.cmd].type==="no-state")?B:Object.assign({type:"toggle"},B):{type:"slot",slot:x}}))}),F={$q:f,props:e,slots:a,emit:l,inFullscreen:z,toggleFullscreen:j,runCmd:_e,isViewingSource:V,editLinkUrl:T,toolbarBackgroundClass:Q,buttonProps:d,contentRef:O,buttons:Z,setContent:be};le(()=>e.modelValue,r=>{G!==r&&(G=r,be(r,!0))}),le(T,r=>{l(`link${r?"Show":"Hide"}`)});const re=y(()=>e.toolbar&&e.toolbar.length!==0),ie=y(()=>{const r={},i=S=>{S.key&&(r[S.key]={cmd:S.cmd,param:S.param})};return Z.value.forEach(S=>{S.forEach(x=>{x.options?x.options.forEach(i):i(x)})}),r}),ee=y(()=>z.value?e.contentStyle:[{minHeight:e.minHeight,height:e.height,maxHeight:e.maxHeight},e.contentStyle]),Y=y(()=>`q-editor q-editor--${V.value===!0?"source":"default"}`+(e.disable===!0?" disabled":"")+(z.value===!0?" fullscreen column":"")+(e.square===!0?" q-editor--square no-border-radius":"")+(e.flat===!0?" q-editor--flat":"")+(e.dense===!0?" q-editor--dense":"")+(_.value===!0?" q-editor--dark q-dark":"")),ge=y(()=>[e.contentClass,"q-editor__content",{col:z.value,"overflow-auto":z.value||e.maxHeight}]),b=y(()=>e.disable===!0?{"aria-disabled":"true"}:{});function g(){if(O.value!==null){const r=`inner${V.value===!0?"Text":"HTML"}`,i=O.value[r];i!==e.modelValue&&(G=i,l("update:modelValue",i))}}function p(r){if(l("keydown",r),r.ctrlKey!==!0||vt(r)===!0){J();return}const i=r.keyCode,S=ie.value[i];if(S!==void 0){const{cmd:x,param:B}=S;It(r),_e(x,B,!1)}}function N(r){J(),l("click",r)}function $(r){if(O.value!==null){const{scrollTop:i,scrollHeight:S}=O.value;K=S-i}F.caret.save(),l("blur",r)}function X(r){Ie(()=>{O.value!==null&&K!==void 0&&(O.value.scrollTop=O.value.scrollHeight-K)}),l("focus",r)}function de(r){const i=L.value;if(i!==null&&i.contains(r.target)===!0&&(r.relatedTarget===null||i.contains(r.relatedTarget)!==!0)){const S=`inner${V.value===!0?"Text":"HTML"}`;F.caret.restorePosition(O.value[S].length),J()}}function pe(r){const i=L.value;i!==null&&i.contains(r.target)===!0&&(r.relatedTarget===null||i.contains(r.relatedTarget)!==!0)&&(F.caret.savePosition(),J())}function te(){K=void 0}function ye(r){F.caret.save()}function be(r,i){if(O.value!==null){i===!0&&F.caret.savePosition();const S=`inner${V.value===!0?"Text":"HTML"}`;O.value[S]=r,i===!0&&(F.caret.restorePosition(O.value[S].length),J())}}function _e(r,i,S=!0){ae(),F.caret.restore(),F.caret.apply(r,i,()=>{ae(),F.caret.save(),S&&J()})}function J(){setTimeout(()=>{T.value=null,m.$forceUpdate()},1)}function ae(){At(()=>{O.value!==null&&O.value.focus({preventScroll:!0})})}function Se(){return O.value}return ft(()=>{F.caret=m.caret=new xa(O.value,F),be(e.modelValue),J(),document.addEventListener("selectionchange",ye)}),Ft(()=>{document.removeEventListener("selectionchange",ye)}),Object.assign(m,{runCmd:_e,refreshToolbar:J,focus:ae,getContentEl:Se}),()=>{let r;if(re.value){const i=[v("div",{key:"qedt_top",class:"q-editor__toolbar row no-wrap scroll-x"+Q.value},qa(F))];T.value!==null&&i.push(v("div",{key:"qedt_btm",class:"q-editor__toolbar row no-wrap items-center scroll-x"+Q.value},Da(F))),r=v("div",{key:"toolbar_ctainer",class:"q-editor__toolbars-container"},i)}return v("div",{ref:L,class:Y.value,style:{height:z.value===!0?"100%":null},...b.value,onFocusin:de,onFocusout:pe},[r,v("div",{ref:O,style:ee.value,class:ge.value,contenteditable:U.value,placeholder:e.placeholder,...k.listeners.value,onInput:g,onKeydown:p,onClick:N,onBlur:$,onFocus:X,onMousedown:te,onTouchstartPassive:te})])}}});const Ba={class:"row q-pa-xs"},Ma={class:"col-12"},La={class:"column items-center"},$a={class:"row justify-end"},Pa={class:"col-12"},ja={key:0,class:"no-tasks text-center",style:{height:"100%"}},Na={autocorrect:"off",autocapitalize:"off",autocomplete:"off",spellcheck:"false"},Ea={class:"row justify-end q-pa-md q-gutter-x-sm"},Ra={class:"text-h5"},Fa=I("div",{class:"text-h6 text-center"},"\u8BBE \u7F6E",-1),Ia={class:"q-gutter-sm q-pa-sm"},Aa=I("div",{class:"text-subtitle2"},"\u4E8B\u4EF6\u8303\u56F4\uFF1A",-1),Va=I("div",{class:"text-subtitle2"},"\u6700\u8FD1\uFF1A",-1),Ya=I("div",{class:"text-subtitle2"},"\u6708",-1),Ua=I("div",{class:"text-subtitle2"},"\u65E5\u5386\u989C\u8272\uFF1A",-1),Qa=I("div",{class:"text-subtitle2"},null,-1),Wa=I("div",{class:"text-subtitle2"},null,-1),Ka=I("div",{class:"text-subtitle2"},"\u4E8B\u4EF6\u989C\u8272\uFF1A",-1),Ja=I("div",{class:"text-subtitle2"},null,-1),Ga=I("div",{class:"text-subtitle2"},null,-1),Xa={class:"row q-gutter-xs justify-end q-pa-sm"},fo={__name:"LoggerPage",setup(e){const a=ia(),l=Vt(),s=D(!1),m=D(!1),C=D(a.todayDate),f=D([]),_=D([]),z=D(""),j=D(""),k=D(),L=D(!1),O=D(!0),T=D(!1),V=D([]),U=[1,3,6,0],H=D(null),K=D(null),G=D(!1),Q=[{label:"\u84DD\u8272",value:"primary"},{label:"\u6A59\u8272",value:"orange"},{label:"\u7EFF\u8272",value:"green"},{label:"\u9752\u8272",value:"teal"},{label:"\u68D5\u8272",value:"brown"},{label:"\u7D2B\u8272",value:"purple"}],d=Yt({_id:"",date:"",user:"",logger:""});le(()=>C.value,b=>{for(const g of _.value)if(b===g){T.value=!0;break}else T.value=!1});const R=async()=>{var b,g;if(await((b=H.value)==null?void 0:b.validate())&&await((g=K.value)==null?void 0:g.validate())){const p={monthRange:k.value,themeColor:z.value,eventColor:j.value};await a.axios.post("/user/loggersetting",p).then(N=>{Z(),a.successTip(N.data.msg),G.value=!1}).catch(N=>{a.failureTip(N.response.data.msg)})}},Z=async()=>{await a.axios.post("/logger/logger",{month:k.value,user:a.user.userInfo.email}).then(b=>{f.value=b.data,V.value=f.value.map(g=>g.logger),_.value=f.value.map(g=>g.date)}).catch(b=>{a.failureTip(b.response.data.msg)})},F=()=>{O.value=!O.value},re=b=>{const g=f.value[b].logger,p=V.value[b];g!==p?L.value=!0:L.value=!1},ie=b=>{f.value[b].logger=V.value[b],L.value=!1},ee=async()=>{if(!C.value){a.failureTip("\u8BF7\u9009\u62E9\u65E5\u671F");return}if(d.logger.length>0){d.date=C.value,d.user=a.user.userInfo.email,m.value=!0;try{const b=await a.axios.post("/logger/newlogger",d);d._id=b.data.id,b.data.logger?d.logger=b.data.logger+"<ul><li>"+d.logger+"</li></ul>":d.logger="<ul><li>"+d.logger+"</li></ul>",f.value.unshift(JSON.parse(JSON.stringify(d))),V.value=f.value.map(g=>g.logger),_.value=f.value.map(g=>g.date),a.successTip(b.data.msg),T.value=!0,m.value=!1,d.logger=""}catch{axios.isAxiosError(err)&&err.code==="ECONNABORTED"?this.failureTip("\u7F51\u7EDC\u4E0D\u4F73\uFF0C\u8BF7\u91CD\u8BD5"):a.failureTip("\u670D\u52A1\u5668\u56DE\u5E94\u9519\u8BEF")}}},Y=async(b,g,p,N)=>{g==="<br><ul><li>"||g==="<div><br></div>"||g.length===0?ge(b,N):(m.value=!0,d._id=b,d.date=p,d.logger=g,await a.axios.post("/logger/updateLogger",d).then($=>{f.value[N].logger=g,V.value=f.value.map(X=>X.logger),a.successTip($.data.msg)}).catch($=>{a.failureTip($.response.data.msg)}).finally(()=>{d.date="",d.logger="",d._id="",L.value=!1,O.value=!0,m.value=!1}))},ge=(b,g)=>{a.$q.dialog({title:"\u786E\u5B9A",message:"\u786E\u5B9A\u8981\u5220\u9664\u8BB0\u5F55?",cancel:!0,persistent:!0,ok:{push:!0,label:"\u786E\u5B9A",color:"green"},cancel:{push:!0,color:"blue-grey",label:"\u53D6\u6D88"}}).onOk(async()=>{await a.axios.delete("/logger/deletelogger",{params:{id:b}}).then(p=>{f.value.splice(g,1),V.value=f.value.map(N=>N.logger),_.value=f.value.map(N=>N.date),a.successTip(p.data.msg),L.value=!1,T.value=!1}).catch(p=>{p.response.data.msg?a.failureTip(p.response.data.msg):a.failureTip("\u7F51\u7EDC\u9519\u8BEF\uFF0C\u83B7\u53D6\u65E5\u5FD7\u5931\u8D25")})}).onCancel(()=>{})};return ft(async()=>{await a.verifyUser().then(async()=>{a.user&&await a.axios.post("/user/alluser").then(async b=>{k.value=a.user.loggerSetting.monthRange,z.value=a.user.loggerSetting.themeColor,j.value=a.user.loggerSetting.eventColor,await Z(),T.value=!0}).catch(b=>{b.response.data?a.failureTip(b.response.data.msg):a.failureTip("\u83B7\u53D6\u6570\u636E\u8D85\u65F6")})}).catch(()=>{l.push("/index")})}),(b,g)=>(me(),De(ta,{class:"q-pa-xs column"},{default:P(()=>[I("div",Ba,[I("div",Ma,[I("div",La,[E(Ca,{modelValue:C.value,"onUpdate:modelValue":g[1]||(g[1]=p=>C.value=p),class:"item-center",landscape:Qt(a).$q.screen.gt.md,events:_.value,"years-in-month-view":"",color:z.value,"event-color":j.value,"today-btn":"",style:{width:"100%","max-width":"550px"}},{default:P(()=>[I("div",$a,[E(A,{label:"\u8BBE\u7F6E",flat:"",onClick:g[0]||(g[0]=p=>G.value=!0)}),E(A,{icon:"refresh",color:"green",flat:"",onClick:Z},{default:P(()=>[E(mt,null,{default:P(()=>[Ut(" \u5237\u65B0 ")]),_:1})]),_:1})])]),_:1},8,["modelValue","landscape","events","color","event-color"])])]),I("div",Pa,[E(Wt,{modelValue:d.logger,"onUpdate:modelValue":g[2]||(g[2]=p=>d.logger=p),outlined:"",type:"textarea",autogrow:"",class:"q-py-md",placeholder:"\u8BB0\u5F55\u70B9\u4E8B\u60C5\u5427...",onFocus:g[3]||(g[3]=p=>s.value=!0),onBlur:g[4]||(g[4]=p=>s.value=!1)},{prepend:P(()=>[E(Ae,{name:s.value?"tips_and_updates":"lightbulb",color:s.value?"orange":"grey"},null,8,["name","color"])]),append:P(()=>[E(A,{round:"",dense:"",flat:"",icon:"send",color:s.value?"primary":"grey",disable:m.value,onClick:ee},null,8,["color","disable"])]),_:1},8,["modelValue"]),T.value?$e("",!0):(me(),at("div",ja,[E(Ae,{name:"psychology_alt",size:"150px",color:"primary"})])),E(ma,{modelValue:C.value,"onUpdate:modelValue":g[5]||(g[5]=p=>C.value=p),animated:"","transition-prev":"jump-up","transition-next":"jump-up"},{default:P(()=>[(me(!0),at(Jt,null,Kt(f.value,(p,N)=>(me(),De(ha,{key:p._id,item:p,index:N,name:p.date,class:"q-pa-none"},{default:P(()=>[I("form",Na,[I("div",Ea,[I("div",Ra,ea(p.date),1),E(sa),L.value?(me(),De(A,{key:0,label:"\u4FEE \u6539",class:"q-px-md",color:"primary",disable:m.value,onClick:$=>Y(p._id,p.logger,p.date,N)},null,8,["disable","onClick"])):$e("",!0),L.value?(me(),De(A,{key:1,label:"\u53D6 \u6D88",class:"q-px-md",color:"grey",onClick:$=>ie(N)},null,8,["onClick"])):$e("",!0)]),E(Oa,{modelValue:p.logger,"onUpdate:modelValue":$=>p.logger=$,dense:b.$q.screen.lt.md,readonly:O.value,definitions:{editable:{tip:"\u5F00\u542F\u7F16\u8F91",icon:"edit",lable:"edit",color:"red",handler:F}},toolbar:[["fullscreen"],[{label:"\u529F\u80FD",size:"lg",icon:"filter_2",fixedLabel:!0,list:"only-icons",options:["left","center","right","justify","bold","italic","strike","quote","underline","unordered","ordered","outdent","indent","print","hr","link","undo","redo"]}],[{label:"\u5B57\u4F53\u5927\u5C0F",icon:b.$q.iconSet.editor.fontSize,fixedLabel:!0,size:"md",fixedIcon:!0,list:"no-icons",options:["size-1","size-2","size-3","size-4","size-5","size-6","size-7"]},"removeFormat"],["viewsource"],["editable"]],fonts:{arial:"Arial",arial_black:"Arial Black",comic_sans:"Comic Sans MS",courier_new:"Courier New",impact:"Impact",lucida_grande:"Lucida Grande",times_new_roman:"Times New Roman",verdana:"Verdana"},onInput:$=>re(N)},null,8,["modelValue","onUpdate:modelValue","dense","readonly","definitions","toolbar","onInput"])])]),_:2},1032,["item","index","name"]))),128))]),_:1},8,["modelValue"])])]),E(Zt,{modelValue:G.value,"onUpdate:modelValue":g[9]||(g[9]=p=>G.value=p),persistent:""},{default:P(()=>[E(Gt,{style:{"min-width":"400px","min-height":"350px"}},{default:P(()=>[E(Pe,null,{default:P(()=>[Fa]),_:1}),E(Pe,null,{default:P(()=>[I("div",Ia,[E(Ne,{modelValue:k.value,"onUpdate:modelValue":g[6]||(g[6]=p=>k.value=p),outlined:"",dense:"",options:U,"transition-show":"jump-up","transition-hide":"jump-up",hint:"0\u4EE3\u8868\u5168\u90E8","hide-hint":"","hide-bottom-space":""},{before:P(()=>[Aa]),prepend:P(()=>[Va]),append:P(()=>[Ya]),_:1},8,["modelValue"]),E(Ne,{ref_key:"themeColoRef",ref:H,modelValue:z.value,"onUpdate:modelValue":g[7]||(g[7]=p=>z.value=p),outlined:"",dense:"",options:Q,"hide-bottom-space":"","emit-value":"","map-options":"","option-label":"label","option-value":"value","transition-show":"jump-up","transition-hide":"jump-up",rules:[p=>!!p||"\u8BF7\u9009\u62E9\u989C\u8272"]},{before:P(()=>[Ua]),prepend:P(()=>[Qa]),append:P(()=>[Wa]),_:1},8,["modelValue","rules"]),E(Ne,{ref_key:"eventColoRef",ref:K,modelValue:j.value,"onUpdate:modelValue":g[8]||(g[8]=p=>j.value=p),outlined:"",dense:"","hide-bottom-space":"","emit-value":"","map-options":"",options:Q,"option-label":"label","option-value":"value","transition-show":"jump-up","transition-hide":"jump-up",rules:[p=>!!p||"\u8BF7\u9009\u62E9\u989C\u8272"]},{before:P(()=>[Ka]),prepend:P(()=>[Ja]),append:P(()=>[Ga]),_:1},8,["modelValue","rules"])])]),_:1}),E(Pe,null,{default:P(()=>[I("div",Xa,[E(A,{outline:"",label:"\u63D0 \u4EA4",color:"primary",onClick:R}),Xt(E(A,{outline:"",label:"\u53D6 \u6D88",color:"grey"},null,512),[[ga]])])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1}))}};export{fo as default};
