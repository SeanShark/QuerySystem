import{_ as Z,H as ee,r as g,q as ae,D as oe,J as d,K as m,L as a,O as c,N as e,R as p,Q as te,b1 as h,S as _,b2 as le,Y as ne,b3 as x,b4 as U,b5 as I,X as C,T as N,U as se,b6 as re,b7 as P,P as D,t as f,b8 as K,a4 as j,a5 as de,a6 as ie}from"./index.7a6a3dd0.js";import{Q as ce,a as E}from"./QPage.8b300c16.js";import{Q as ue,a as F}from"./QTabs.9b6126a8.js";import{Q as v,a as r,b}from"./position-engine.9859a46c.js";import{Q as V}from"./QList.9cadff6f.js";import{Q as J}from"./QBtnDropdown.efbeb369.js";import{Q as me,a as X}from"./QTabPanels.0392655e.js";import{C as k}from"./ClosePopup.9ce22368.js";import{u as pe,d as G}from"./store.a6b815dd.js";import"./QResizeObserver.f668399a.js";import"./rtl.b51694b1.js";import"./use-panel.88b60694.js";import"./touch.3df10340.js";import"./axios.7331a07d.js";const Y=w=>(de("data-v-1ece3e26"),w=w(),ie(),w),_e=Y(()=>c("p",{class:"text-h6 text-center q-pa-md"},"\u4EFB\u52A1To-Do",-1)),fe={class:"column q-pa-xs q-ma-none"},ve={class:"col q-pa-xs"},be={class:"q-gutter-sm row justify-center"},ge={class:"q-gutter-y-md q-pa-none"},ke={class:"text-italic"},ye={key:0,class:"no-tasks absolute-center"},he=Y(()=>c("div",{class:"text-h5 text-primary text-center"},"\u65E0\u4EFB\u52A1",-1)),xe={class:"text-italic"},Ce={key:0,class:"no-tasks absolute-center"},De=Y(()=>c("div",{class:"text-h5 text-primary text-center"},"\u65E0\u4EFB\u52A1",-1)),we={__name:"HomePage",setup(w){const W=ee(),l=pe(),H=g(null),T=g(!1);ae(async()=>{await l.verifyUser().then(()=>{l.user&&y()}).catch(()=>{W.push("/index")})});const q=g([]),$=g([]),z=g([]),y=async()=>{await l.axios.post("/todo/gettodolists",{owner:l.user.userInfo.email}).then(n=>{q.value=n.data,$.value=q.value.filter(t=>t.isDone===!1),z.value=q.value.filter(t=>t.isDone===!0)}).catch(n=>{console.log(n)})},Q=g("todo"),u=oe({owner:"",todo:"",color:"text-black",createdAt:""}),S=async()=>{var n;await((n=H.value)==null?void 0:n.validate())&&(T.value=!0,u.owner=l.user.userInfo.email,u.createdAt=G.formatDate(Date.now(),"YYYY-MM-DD-HH:mm:ss"),await l.axios.post("/todo/newtodo/",u).then(t=>{u.todo="",u.color="text-black",l.successTip(t.data.msg),y()}).catch(t=>{l.failureTip(t.response.data.msg)}).finally(()=>{T.value=!1}))},B=(n,t,o)=>{setTimeout(async()=>{await l.axios.put("/todo/",{id:t,field:n,value:o}).then(i=>{l.successTip(i.data.msg),y()}).catch(i=>{l.failureTip(i.response.data.msg)})},300)},A=[{label:"\u9ED1\u8272",value:"text-black",color:"black"},{label:"\u84DD\u8272",value:"text-primary",color:"primary"},{label:"\u7D2B\u8272",value:"text-accent",color:"accent"},{label:"\u7EA2\u8272",value:"text-negative",color:"negative"},{label:"\u7EFF\u8272",value:"text-positive",color:"positive"},{label:"\u9EC4\u8272",value:"text-warning",color:"warning"},{label:"\u975B\u84DD\u8272",value:"text-indigo",color:"indigo"}],L=n=>{l.$q.dialog({title:"\u786E\u5B9A",message:"\u786E\u5B9A\u8981\u5220\u9664\u8BB0\u5F55?",cancel:!0,persistent:!0,ok:{push:!0,label:"\u786E\u5B9A",color:"green"},cancel:{push:!0,color:"blue-grey",label:"\u53D6\u6D88"}}).onOk(async()=>{await l.axios.delete(`/todo/${n}`).then(t=>{l.successTip(t.data.msg),y()}).catch(t=>{l.failureTip(t.response.data.msg)})}).onCancel(()=>{})},M=async(n,t,o)=>{const i=G.formatDate(Date.now(),"YYYY-MM-DD-HH:mm:ss");await l.axios.put("/todo",{id:n,field:t,value:o,createdAt:i}).then(s=>{l.successTip(s.data.msg),y()}).catch(s=>{l.failureTip(s.response.data.msg)})},O=n=>{l.$q.dialog({title:"\u7F16\u8F91\u5185\u5BB9",message:"\u8BF7\u8F93\u5165\u9700\u8981\u7F16\u8F91\u7684\u5185\u5BB9",prompt:{model:`${n.todo}`,type:"text"},cancel:!0,persistent:!0,ok:{push:!0,label:"\u786E\u5B9A",color:"green"},cancel:{push:!0,color:"blue-grey",label:"\u53D6\u6D88"}}).onOk(async t=>{if(t==="")return l.failureTip("\u5185\u5BB9\u4E0D\u80FD\u4E3A\u7A7A");M(n._id,"todo",t)}).onCancel(()=>{})},R=n=>{l.$q.dialog({title:"\u9009\u62E9\u989C\u8272",message:"\u9009\u62E9\u4F60\u9700\u8981\u6539\u53D8\u7684\u989C\u8272",options:{type:"radio",model:`${n.color}`,inline:!0,items:A},cancel:!0,persistent:!0,ok:{push:!0,label:"\u786E\u5B9A",color:"green"},cancel:{push:!0,color:"blue-grey",label:"\u53D6\u6D88"}}).onOk(t=>{M(n._id,"color",t)})};return(n,t)=>(d(),m(ce,null,{default:a(()=>[_e,c("div",fe,[e(ne,{ref_key:"inputRef",ref:H,modelValue:u.todo,"onUpdate:modelValue":t[0]||(t[0]=o=>u.todo=o),"bg-color":"white",class:"col q-pa-none","bottom-slots":"","hide-bottom-space":"",rules:[o=>!!o||"\u8BF7\u8F93\u5165\u5185\u5BB9"],outlined:"",placeholder:"\u8BF7\u8F93\u5165\u60A8\u7684\u5185\u5BB9","lazy-rules":"ondemand",autocomplete:"off",onKeyup:le(S,["enter"])},{prepend:a(()=>[e(p,{name:"event"})]),append:a(()=>[e(te,{round:"",dense:"",flat:"",icon:"send",disable:T.value,onClick:h(S,["stop"])},{default:a(()=>[e(E,null,{default:a(()=>[_(" \u53D1\u9001 ")]),_:1})]),_:1},8,["disable","onClick"])]),_:1},8,["modelValue","rules","onKeyup"]),c("div",ve,[c("div",be,[(d(),x(I,null,U(A,(o,i)=>e(re,{key:i,modelValue:u.color,"onUpdate:modelValue":s=>u.color=s,item:o,index:i,"keep-color":"",val:o.value,color:o.color},{default:a(()=>[e(E,{class:P("bg-"+o.color)},{default:a(()=>[_(D(o.label),1)]),_:2},1032,["class"])]),_:2},1032,["modelValue","onUpdate:modelValue","item","index","val","color"])),64))])])]),c("div",ge,[e(se,null,{default:a(()=>[e(ue,{modelValue:Q.value,"onUpdate:modelValue":t[1]||(t[1]=o=>Q.value=o),dense:"",class:"text-grey q-pa-none","active-color":"primary","indicator-color":"primary",align:"justify","narrow-indicator":""},{default:a(()=>[e(F,{name:"todo",label:"\u4EFB\u52A1"}),e(F,{name:"done",label:"\u5DF2\u5B8C\u6210"})]),_:1},8,["modelValue"]),e(C),e(me,{modelValue:Q.value,"onUpdate:modelValue":t[4]||(t[4]=o=>Q.value=o),animated:""},{default:a(()=>[e(X,{class:"q-pa-none",name:"todo",style:{"min-height":"150px"}},{default:a(()=>[e(V,{separator:"",bordered:""},{default:a(()=>[(d(!0),x(I,null,U($.value,(o,i)=>f((d(),m(v,{key:o._id,item:o,index:i,clickable:""},{default:a(()=>[e(r,{avatar:""},{default:a(()=>[e(K,{modelValue:o.isDone,"onUpdate:modelValue":s=>o.isDone=s,name:"isDone",color:"primary",onClick:h(s=>B("isDone",o._id,o.isDone),["stop"])},null,8,["modelValue","onUpdate:modelValue","onClick"])]),_:2},1024),e(r,null,{default:a(()=>[e(b,null,{default:a(()=>[c("div",{class:P([o.color,"text-body2"])},D(o.todo),3),c("div",ke,D(o.createdAt),1)]),_:2},1024)]),_:2},1024),e(J,{color:"primary",padding:"none",flat:"",size:"sm","dropdown-icon":"change_history",onClick:t[2]||(t[2]=h(()=>{},["stop"]))},{default:a(()=>[e(V,null,{default:a(()=>[f((d(),m(v,{clickable:"",onClick:s=>O(o)},{default:a(()=>[e(r,{avatar:""},{default:a(()=>[e(p,{name:"edit_note",color:"primary",size:"sm"})]),_:1}),e(r,null,{default:a(()=>[e(b,null,{default:a(()=>[_("\u7F16\u8F91")]),_:1})]),_:1})]),_:2},1032,["onClick"])),[[k]]),e(C),f((d(),m(v,{clickable:"",onClick:s=>L(o._id)},{default:a(()=>[e(r,{avatar:""},{default:a(()=>[e(p,{name:"delete",color:"red",size:"sm"})]),_:1}),e(r,null,{default:a(()=>[e(b,null,{default:a(()=>[_("\u5220\u9664")]),_:1})]),_:1})]),_:2},1032,["onClick"])),[[k]]),e(C),f((d(),m(v,{clickable:"",onClick:s=>R(o)},{default:a(()=>[e(r,{avatar:""},{default:a(()=>[e(p,{name:"color_lens",color:"teal",size:"sm"})]),_:1}),e(r,null,{default:a(()=>[e(b,null,{default:a(()=>[_("\u989C\u8272")]),_:1})]),_:1})]),_:2},1032,["onClick"])),[[k]])]),_:2},1024)]),_:2},1024)]),_:2},1032,["item","index"])),[[j]])),128))]),_:1}),$.value.length?N("",!0):(d(),x("div",ye,[e(p,{name:"check",size:"50px",color:"primary"}),he]))]),_:1}),e(X,{class:"q-pa-none",name:"done",style:{"min-height":"150px"}},{default:a(()=>[e(V,{separator:"",bordered:""},{default:a(()=>[(d(!0),x(I,null,U(z.value,(o,i)=>f((d(),m(v,{key:o._id,item:o,index:i,clickable:""},{default:a(()=>[e(r,{avatar:""},{default:a(()=>[e(K,{modelValue:o.isDone,"onUpdate:modelValue":s=>o.isDone=s,color:"primary",onClick:h(s=>B("isDone",o._id,o.isDone),["stop"])},null,8,["modelValue","onUpdate:modelValue","onClick"])]),_:2},1024),e(r,null,{default:a(()=>[e(b,null,{default:a(()=>[c("div",{class:P(o.color)},D(o.todo),3)]),_:2},1024),c("div",xe,D(o.createdAt),1)]),_:2},1024),e(J,{color:"primary",padding:"none",flat:"",size:"sm","dropdown-icon":"change_history",onClick:t[3]||(t[3]=h(()=>{},["stop"]))},{default:a(()=>[e(V,null,{default:a(()=>[f((d(),m(v,{clickable:"",onClick:s=>O(o)},{default:a(()=>[e(r,{avatar:""},{default:a(()=>[e(p,{name:"edit_note",color:"primary",size:"sm"})]),_:1}),e(r,null,{default:a(()=>[e(b,null,{default:a(()=>[_("\u7F16\u8F91")]),_:1})]),_:1})]),_:2},1032,["onClick"])),[[k]]),e(C),f((d(),m(v,{clickable:"",onClick:s=>L(o._id)},{default:a(()=>[e(r,{avatar:""},{default:a(()=>[e(p,{name:"delete",color:"red",size:"sm"})]),_:1}),e(r,null,{default:a(()=>[e(b,null,{default:a(()=>[_("\u5220\u9664")]),_:1})]),_:1})]),_:2},1032,["onClick"])),[[k]]),e(C),f((d(),m(v,{clickable:"",onClick:s=>R(o)},{default:a(()=>[e(r,{avatar:""},{default:a(()=>[e(p,{name:"color_lens",color:"teal",size:"sm"})]),_:1}),e(r,null,{default:a(()=>[e(b,null,{default:a(()=>[_("\u989C\u8272")]),_:1})]),_:1})]),_:2},1032,["onClick"])),[[k]])]),_:2},1024)]),_:2},1024)]),_:2},1032,["item","index"])),[[j]])),128))]),_:1}),z.value.length?N("",!0):(d(),x("div",Ce,[e(p,{name:"check",size:"50px",color:"primary"}),De]))]),_:1})]),_:1},8,["modelValue"])]),_:1})])]),_:1}))}};var Le=Z(we,[["__scopeId","data-v-1ece3e26"]]);export{Le as default};
