import{c as ne,u as se,f as ue,aq as ie,j as le,r as w,a as c,k as re,ar as ce,m as de,as as fe,n as ve,at as he,w as D,au as ge,af as me,av as ye,aw as _,ai as Pe,ax as ke,d as K,x as xe,ay as Ce,o as Te,g as qe,az as pe,aA as Se,aB as Ee,ah as Oe,a7 as be,aC as Be,aD as Fe,ao as we}from"./index.041d41de.js";import{u as De,v as M,c as _e,d as Ke,e as Me,p as A,r as R,s as Ae,f as Re}from"./QItemLabel.f32048db.js";var Qe=ne({name:"QMenu",inheritAttrs:!1,props:{...De,...se,...ue,...ie,persistent:Boolean,autoClose:Boolean,separateClosePopup:Boolean,noRouteDismiss:Boolean,noRefocus:Boolean,noFocus:Boolean,fit:Boolean,cover:Boolean,square:Boolean,anchor:{type:String,validator:M},self:{type:String,validator:M},offset:{type:Array,validator:_e},scrollTarget:{default:void 0},touchPosition:Boolean,maxHeight:{type:String,default:null},maxWidth:{type:String,default:null}},emits:[...le,"click","escapeKey"],setup(e,{slots:a,emit:o,attrs:s}){let n=null,v,d,h;const x=qe(),{proxy:g}=x,{$q:u}=g,i=w(null),l=w(!1),L=c(()=>e.persistent!==!0&&e.noRouteDismiss!==!0),Q=re(e,u),{registerTick:W,removeTick:j}=ce(),{registerTimeout:C}=de(),{transitionProps:I,transitionStyle:N}=fe(e),{localScrollTarget:T,changeScrollEvent:U,unconfigureScrollTarget:z}=Ke(e,B),{anchorEl:r,canShow:$}=Me({showing:l}),{hide:q}=ve({showing:l,canShow:$,handleShow:Y,handleHide:Z,hideOnRouteChange:L,processOnMount:!0}),{showPortal:p,hidePortal:S,renderPortal:G}=he(x,i,te,"menu"),m={anchorEl:r,innerRef:i,onClickOutside(t){if(e.persistent!==!0&&l.value===!0)return q(t),(t.type==="touchstart"||t.target.classList.contains("q-dialog__backdrop"))&&Oe(t),!0}},E=c(()=>A(e.anchor||(e.cover===!0?"center middle":"bottom start"),u.lang.rtl)),J=c(()=>e.cover===!0?E.value:A(e.self||"top start",u.lang.rtl)),V=c(()=>(e.square===!0?" q-menu--square":"")+(Q.value===!0?" q-menu--dark q-dark":"")),X=c(()=>e.autoClose===!0?{onClick:ee}:{}),O=c(()=>l.value===!0&&e.persistent!==!0);D(O,t=>{t===!0?(pe(P),Re(m)):(_(P),R(m))});function y(){Se(()=>{let t=i.value;t&&t.contains(document.activeElement)!==!0&&(t=t.querySelector("[autofocus][tabindex], [data-autofocus][tabindex]")||t.querySelector("[autofocus] [tabindex], [data-autofocus] [tabindex]")||t.querySelector("[autofocus], [data-autofocus]")||t,t.focus({preventScroll:!0}))})}function Y(t){if(n=e.noRefocus===!1?document.activeElement:null,ge(F),p(),B(),v=void 0,t!==void 0&&(e.touchPosition||e.contextMenu)){const k=me(t);if(k.left!==void 0){const{top:oe,left:ae}=r.value.getBoundingClientRect();v={left:k.left-ae,top:k.top-oe}}}d===void 0&&(d=D(()=>u.screen.width+"|"+u.screen.height+"|"+e.self+"|"+e.anchor+"|"+u.lang.rtl,f)),e.noFocus!==!0&&document.activeElement.blur(),W(()=>{f(),e.noFocus!==!0&&y()}),C(()=>{u.platform.is.ios===!0&&(h=e.autoClose,i.value.click()),f(),p(!0),o("show",t)},e.transitionDuration)}function Z(t){j(),S(),b(!0),n!==null&&(t===void 0||t.qClickOutside!==!0)&&(((t&&t.type.indexOf("key")===0?n.closest('[tabindex]:not([tabindex^="-"])'):void 0)||n).focus(),n=null),C(()=>{S(!0),o("hide",t)},e.transitionDuration)}function b(t){v=void 0,d!==void 0&&(d(),d=void 0),(t===!0||l.value===!0)&&(ye(F),z(),R(m),_(P)),t!==!0&&(n=null)}function B(){(r.value!==null||e.scrollTarget!==void 0)&&(T.value=Pe(r.value,e.scrollTarget),U(T.value,f))}function ee(t){h!==!0?(ke(g,t),o("click",t)):h=!1}function F(t){O.value===!0&&e.noFocus!==!0&&Ee(i.value,t.target)!==!0&&y()}function P(t){o("escapeKey"),q(t)}function f(){const t=i.value;t===null||r.value===null||Ae({el:t,offset:e.offset,anchorEl:r.value,anchorOrigin:E.value,selfOrigin:J.value,absoluteOffset:v,fit:e.fit,cover:e.cover,maxHeight:e.maxHeight,maxWidth:e.maxWidth})}function te(){return K(Ce,I.value,()=>l.value===!0?K("div",{role:"menu",...s,ref:i,tabindex:-1,class:["q-menu q-position-engine scroll"+V.value,s.class],style:[s.style,N.value],...X.value},xe(a.default)):null)}return Te(b),Object.assign(g,{focus:y,updatePosition:f}),G}});function H(e){if(e===!1)return 0;if(e===!0||e===void 0)return 1;const a=parseInt(e,10);return isNaN(a)?0:a}var We=be({name:"close-popup",beforeMount(e,{value:a}){const o={depth:H(a),handler(s){o.depth!==0&&setTimeout(()=>{const n=Be(e);n!==void 0&&Fe(n,s,o.depth)})},handlerKey(s){we(s,13)===!0&&o.handler(s)}};e.__qclosepopup=o,e.addEventListener("click",o.handler),e.addEventListener("keyup",o.handlerKey)},updated(e,{value:a,oldValue:o}){a!==o&&(e.__qclosepopup.depth=H(a))},beforeUnmount(e){const a=e.__qclosepopup;e.removeEventListener("click",a.handler),e.removeEventListener("keyup",a.handlerKey),delete e.__qclosepopup}});export{We as C,Qe as Q};
