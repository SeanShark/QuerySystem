import{a as p,c as it,aP as $t,f as st,k as ut,bv as Lt,r as H,bm as Pt,w as re,d as v,ay as xe,x as ct,g as dt,bw as jt,s as Ve,Q as I,a9 as Nt,ae as Et,aW as vt,ad as at,R as Ae,bx as Ft,q as ft,o as Rt,ah as It,aA as Vt,H as At,D as Yt,J as ce,K as De,L as $,O as R,N as j,M as Ut,X as Qt,b4 as Pe,T as He,b5 as Wt,b6 as Kt,U as Jt,V as je,t as Gt,Z as Xt,P as Zt,S as ea}from"./index.041d41de.js";import{d as ta}from"./use-panel.53fd5102.js";import{p as ve,t as aa,a as ot,f as oa,g as na,j as Ne,_ as la,u as ra}from"./store.3e61fac0.js";import{Q as ia}from"./QSpace.7ab9aa9c.js";import{a as mt,Q as sa}from"./QPage.ac29651e.js";import{Q as ua}from"./QBtnDropdown.d88f905f.js";import{a as nt,Q as ca}from"./QItemLabel.f32048db.js";import{u as da,a as va,b as fa}from"./use-fullscreen.39640926.js";import{Q as ma,a as ha}from"./QTabPanels.50a1817e.js";import{Q as Ee}from"./QSelect.e978f1f3.js";import{C as ga}from"./ClosePopup.aa9dcd01.js";import"./touch.3df10340.js";import"./axios.7331a07d.js";import"./rtl.b51694b1.js";const ya=["gregorian","persian"],pa={modelValue:{required:!0},mask:{type:String},locale:Object,calendar:{type:String,validator:e=>ya.includes(e),default:"gregorian"},landscape:Boolean,color:String,textColor:String,square:Boolean,flat:Boolean,bordered:Boolean,readonly:Boolean,disable:Boolean},ba=["update:modelValue"];function ne(e){return e.year+"/"+ve(e.month)+"/"+ve(e.day)}function _a(e,a){const l=p(()=>e.disable!==!0&&e.readonly!==!0),s=p(()=>l.value===!0?0:-1),f=p(()=>{const _=[];return e.color!==void 0&&_.push(`bg-${e.color}`),e.textColor!==void 0&&_.push(`text-${e.textColor}`),_.join(" ")});function b(){return e.locale!==void 0?{...a.lang.date,...e.locale}:a.lang.date}function g(_){const M=new Date,P=_===!0?null:0;if(e.calendar==="persian"){const k=aa(M);return{year:k.jy,month:k.jm,day:k.jd}}return{year:M.getFullYear(),month:M.getMonth()+1,day:M.getDate(),hour:P,minute:P,second:P,millisecond:P}}return{editable:l,tabindex:s,headerClass:f,getLocale:b,getCurrentDate:g}}const de=20,Ca=["Calendar","Years","Months"],lt=e=>Ca.includes(e),Fe=e=>/^-?[\d]+\/[0-1]\d$/.test(e),ge=" \u2014 ";function le(e){return e.year+"/"+ve(e.month)}var ka=it({name:"QDate",props:{...pa,...$t,...st,multiple:Boolean,range:Boolean,title:String,subtitle:String,mask:{default:"YYYY/MM/DD"},defaultYearMonth:{type:String,validator:Fe},yearsInMonthView:Boolean,events:[Array,Function],eventColor:[String,Function],emitImmediately:Boolean,options:[Array,Function],navigationMinYearMonth:{type:String,validator:Fe},navigationMaxYearMonth:{type:String,validator:Fe},noUnset:Boolean,firstDayOfWeek:[String,Number],todayBtn:Boolean,minimal:Boolean,defaultView:{type:String,default:"Calendar",validator:lt}},emits:[...ba,"rangeStart","rangeEnd","navigation"],setup(e,{slots:a,emit:l}){const{proxy:s}=dt(),{$q:f}=s,b=ut(e,f),{getCache:g}=ta(),{tabindex:_,headerClass:M,getLocale:P,getCurrentDate:k}=_a(e,f);let N;const D=Lt(e),T=jt(D),W=H(null),A=H(Ke()),z=H(P()),J=p(()=>Ke()),X=p(()=>P()),Y=p(()=>k()),c=H(Je(A.value,z.value)),E=H(e.defaultView),Z=f.lang.rtl===!0?"right":"left",F=H(Z.value),ie=H(Z.value),se=c.value.year,ee=H(se-se%de-(se<0?de:0)),V=H(null),w=p(()=>{const t=e.landscape===!0?"landscape":"portrait";return`q-date q-date--${t} q-date--${t}-${e.minimal===!0?"minimal":"standard"}`+(b.value===!0?" q-date--dark q-dark":"")+(e.bordered===!0?" q-date--bordered":"")+(e.square===!0?" q-date--square no-border-radius":"")+(e.flat===!0?" q-date--flat no-shadow":"")+(e.disable===!0?" disabled":e.readonly===!0?" q-date--readonly":"")}),h=p(()=>e.color||"primary"),y=p(()=>e.textColor||"white"),L=p(()=>e.emitImmediately===!0&&e.multiple!==!0&&e.range!==!0),U=p(()=>Array.isArray(e.modelValue)===!0?e.modelValue:e.modelValue!==null&&e.modelValue!==void 0?[e.modelValue]:[]),Q=p(()=>U.value.filter(t=>typeof t=="string").map(t=>Me(t,A.value,z.value)).filter(t=>t.dateHash!==null&&t.day!==null&&t.month!==null&&t.year!==null)),te=p(()=>{const t=o=>Me(o,A.value,z.value);return U.value.filter(o=>Pt(o)===!0&&o.from!==void 0&&o.to!==void 0).map(o=>({from:t(o.from),to:t(o.to)})).filter(o=>o.from.dateHash!==null&&o.to.dateHash!==null&&o.from.dateHash<o.to.dateHash)}),fe=p(()=>e.calendar!=="persian"?t=>new Date(t.year,t.month-1,t.day):t=>{const o=ot(t.year,t.month,t.day);return new Date(o.gy,o.gm-1,o.gd)}),ye=p(()=>e.calendar==="persian"?ne:(t,o,n)=>oa(new Date(t.year,t.month-1,t.day,t.hour,t.minute,t.second,t.millisecond),o===void 0?A.value:o,n===void 0?z.value:n,t.year,t.timezoneOffset)),ae=p(()=>Q.value.length+te.value.reduce((t,o)=>t+1+na(fe.value(o.to),fe.value(o.from)),0)),pe=p(()=>{if(e.title!==void 0&&e.title!==null&&e.title.length!==0)return e.title;if(V.value!==null){const n=V.value.init,d=fe.value(n);return z.value.daysShort[d.getDay()]+", "+z.value.monthsShort[n.month-1]+" "+n.day+ge+"?"}if(ae.value===0)return ge;if(ae.value>1)return`${ae.value} ${z.value.pluralDay}`;const t=Q.value[0],o=fe.value(t);return isNaN(o.valueOf())===!0?ge:z.value.headerTitle!==void 0?z.value.headerTitle(o,t):z.value.daysShort[o.getDay()]+", "+z.value.monthsShort[t.month-1]+" "+t.day}),be=p(()=>Q.value.concat(te.value.map(o=>o.from)).sort((o,n)=>o.year-n.year||o.month-n.month)[0]),_e=p(()=>Q.value.concat(te.value.map(o=>o.to)).sort((o,n)=>n.year-o.year||n.month-o.month)[0]),G=p(()=>{if(e.subtitle!==void 0&&e.subtitle!==null&&e.subtitle.length!==0)return e.subtitle;if(ae.value===0)return ge;if(ae.value>1){const t=be.value,o=_e.value,n=z.value.monthsShort;return n[t.month-1]+(t.year!==o.year?" "+t.year+ge+n[o.month-1]+" ":t.month!==o.month?ge+n[o.month-1]:"")+" "+o.year}return Q.value[0].year}),oe=p(()=>{const t=[f.iconSet.datetime.arrowLeft,f.iconSet.datetime.arrowRight];return f.lang.rtl===!0?t.reverse():t}),qe=p(()=>e.firstDayOfWeek!==void 0?Number(e.firstDayOfWeek):z.value.firstDayOfWeek),r=p(()=>{const t=z.value.daysShort,o=qe.value;return o>0?t.slice(o,7).concat(t.slice(0,o)):t}),i=p(()=>{const t=c.value;return e.calendar!=="persian"?new Date(t.year,t.month,0).getDate():Ne(t.year,t.month)}),q=p(()=>typeof e.eventColor=="function"?e.eventColor:()=>e.eventColor),x=p(()=>{if(e.navigationMinYearMonth===void 0)return null;const t=e.navigationMinYearMonth.split("/");return{year:parseInt(t[0],10),month:parseInt(t[1],10)}}),B=p(()=>{if(e.navigationMaxYearMonth===void 0)return null;const t=e.navigationMaxYearMonth.split("/");return{year:parseInt(t[0],10),month:parseInt(t[1],10)}}),Ce=p(()=>{const t={month:{prev:!0,next:!0},year:{prev:!0,next:!0}};return x.value!==null&&x.value.year>=c.value.year&&(t.year.prev=!1,x.value.year===c.value.year&&x.value.month>=c.value.month&&(t.month.prev=!1)),B.value!==null&&B.value.year<=c.value.year&&(t.year.next=!1,B.value.year===c.value.year&&B.value.month<=c.value.month&&(t.month.next=!1)),t}),Se=p(()=>{const t={};return Q.value.forEach(o=>{const n=le(o);t[n]===void 0&&(t[n]=[]),t[n].push(o.day)}),t}),Ue=p(()=>{const t={};return te.value.forEach(o=>{const n=le(o.from),d=le(o.to);if(t[n]===void 0&&(t[n]=[]),t[n].push({from:o.from.day,to:n===d?o.to.day:void 0,range:o}),n<d){let u;const{year:S,month:m}=o.from,C=m<12?{year:S,month:m+1}:{year:S+1,month:1};for(;(u=le(C))<=d;)t[u]===void 0&&(t[u]=[]),t[u].push({from:void 0,to:u===d?o.to.day:void 0,range:o}),C.month++,C.month>12&&(C.year++,C.month=1)}}),t}),ke=p(()=>{if(V.value===null)return;const{init:t,initHash:o,final:n,finalHash:d}=V.value,[u,S]=o<=d?[t,n]:[n,t],m=le(u),C=le(S);if(m!==K.value&&C!==K.value)return;const O={};return m===K.value?(O.from=u.day,O.includeFrom=!0):O.from=1,C===K.value?(O.to=S.day,O.includeTo=!0):O.to=i.value,O}),K=p(()=>le(c.value)),_t=p(()=>{const t={};if(e.options===void 0){for(let n=1;n<=i.value;n++)t[n]=!0;return t}const o=typeof e.options=="function"?e.options:n=>e.options.includes(n);for(let n=1;n<=i.value;n++){const d=K.value+"/"+ve(n);t[n]=o(d)}return t}),Ct=p(()=>{const t={};if(e.events===void 0)for(let o=1;o<=i.value;o++)t[o]=!1;else{const o=typeof e.events=="function"?e.events:n=>e.events.includes(n);for(let n=1;n<=i.value;n++){const d=K.value+"/"+ve(n);t[n]=o(d)===!0&&q.value(d)}}return t}),kt=p(()=>{let t,o;const{year:n,month:d}=c.value;if(e.calendar!=="persian")t=new Date(n,d-1,1),o=new Date(n,d-1,0).getDate();else{const u=ot(n,d,1);t=new Date(u.gy,u.gm-1,u.gd);let S=d-1,m=n;S===0&&(S=12,m--),o=Ne(m,S)}return{days:t.getDay()-qe.value-1,endDay:o}}),Qe=p(()=>{const t=[],{days:o,endDay:n}=kt.value,d=o<0?o+7:o;if(d<6)for(let m=n-d;m<=n;m++)t.push({i:m,fill:!0});const u=t.length;for(let m=1;m<=i.value;m++){const C={i:m,event:Ct.value[m],classes:[]};_t.value[m]===!0&&(C.in=!0,C.flat=!0),t.push(C)}if(Se.value[K.value]!==void 0&&Se.value[K.value].forEach(m=>{const C=u+m-1;Object.assign(t[C],{selected:!0,unelevated:!0,flat:!1,color:h.value,textColor:y.value})}),Ue.value[K.value]!==void 0&&Ue.value[K.value].forEach(m=>{if(m.from!==void 0){const C=u+m.from-1,O=u+(m.to||i.value)-1;for(let we=C;we<=O;we++)Object.assign(t[we],{range:m.range,unelevated:!0,color:h.value,textColor:y.value});Object.assign(t[C],{rangeFrom:!0,flat:!1}),m.to!==void 0&&Object.assign(t[O],{rangeTo:!0,flat:!1})}else if(m.to!==void 0){const C=u+m.to-1;for(let O=u;O<=C;O++)Object.assign(t[O],{range:m.range,unelevated:!0,color:h.value,textColor:y.value});Object.assign(t[C],{flat:!1,rangeTo:!0})}else{const C=u+i.value-1;for(let O=u;O<=C;O++)Object.assign(t[O],{range:m.range,unelevated:!0,color:h.value,textColor:y.value})}}),ke.value!==void 0){const m=u+ke.value.from-1,C=u+ke.value.to-1;for(let O=m;O<=C;O++)t[O].color=h.value,t[O].editRange=!0;ke.value.includeFrom===!0&&(t[m].editRangeFrom=!0),ke.value.includeTo===!0&&(t[C].editRangeTo=!0)}c.value.year===Y.value.year&&c.value.month===Y.value.month&&(t[u+Y.value.day-1].today=!0);const S=t.length%7;if(S>0){const m=7-S;for(let C=1;C<=m;C++)t.push({i:C,fill:!0})}return t.forEach(m=>{let C="q-date__calendar-item ";m.fill===!0?C+="q-date__calendar-item--fill":(C+=`q-date__calendar-item--${m.in===!0?"in":"out"}`,m.range!==void 0&&(C+=` q-date__range${m.rangeTo===!0?"-to":m.rangeFrom===!0?"-from":""}`),m.editRange===!0&&(C+=` q-date__edit-range${m.editRangeFrom===!0?"-from":""}${m.editRangeTo===!0?"-to":""}`),(m.range!==void 0||m.editRange===!0)&&(C+=` text-${m.color}`)),m.classes=C}),t}),wt=p(()=>e.disable===!0?{"aria-disabled":"true"}:e.readonly===!0?{"aria-readonly":"true"}:{});re(()=>e.modelValue,t=>{if(N===t)N=0;else{const o=Je(A.value,z.value);me(o.year,o.month,o)}}),re(E,()=>{W.value!==null&&s.$el.contains(document.activeElement)===!0&&W.value.focus()}),re(()=>c.value.year+"|"+c.value.month,()=>{l("navigation",{year:c.value.year,month:c.value.month})}),re(J,t=>{tt(t,z.value,"mask"),A.value=t}),re(X,t=>{tt(A.value,t,"locale"),z.value=t});function We(){const t=Y.value,o=Se.value[le(t)];(o===void 0||o.includes(t.day)===!1)&&Be(t),ze(t.year,t.month)}function xt(t){lt(t)===!0&&(E.value=t)}function qt(t,o){["month","year"].includes(t)&&(t==="month"?Xe:Oe)(o===!0?-1:1)}function ze(t,o){E.value="Calendar",me(t,o)}function St(t,o){if(e.range===!1||!t){V.value=null;return}const n=Object.assign({...c.value},t),d=o!==void 0?Object.assign({...c.value},o):n;V.value={init:n,initHash:ne(n),final:d,finalHash:ne(d)},ze(n.year,n.month)}function Ke(){return e.calendar==="persian"?"YYYY/MM/DD":e.mask}function Me(t,o,n){return la(t,o,n,e.calendar,{hour:0,minute:0,second:0,millisecond:0})}function Je(t,o){const n=Array.isArray(e.modelValue)===!0?e.modelValue:e.modelValue?[e.modelValue]:[];if(n.length===0)return Ge();const d=n[n.length-1],u=Me(d.from!==void 0?d.from:d,t,o);return u.dateHash===null?Ge():u}function Ge(){let t,o;if(e.defaultYearMonth!==void 0){const n=e.defaultYearMonth.split("/");t=parseInt(n[0],10),o=parseInt(n[1],10)}else{const n=Y.value!==void 0?Y.value:k();t=n.year,o=n.month}return{year:t,month:o,day:1,hour:0,minute:0,second:0,millisecond:0,dateHash:t+"/"+ve(o)+"/01"}}function Xe(t){let o=c.value.year,n=Number(c.value.month)+t;n===13?(n=1,o++):n===0&&(n=12,o--),me(o,n),L.value===!0&&Te("month")}function Oe(t){const o=Number(c.value.year)+t;me(o,c.value.month),L.value===!0&&Te("year")}function Tt(t){me(t,c.value.month),E.value=e.defaultView==="Years"?"Months":"Calendar",L.value===!0&&Te("year")}function Dt(t){me(c.value.year,t),E.value="Calendar",L.value===!0&&Te("month")}function Ht(t,o){const n=Se.value[o];(n!==void 0&&n.includes(t.day)===!0?$e:Be)(t)}function ue(t){return{year:t.year,month:t.month,day:t.day}}function me(t,o,n){if(x.value!==null&&t<=x.value.year&&(t=x.value.year,o<x.value.month&&(o=x.value.month)),B.value!==null&&t>=B.value.year&&(t=B.value.year,o>B.value.month&&(o=B.value.month)),n!==void 0){const{hour:u,minute:S,second:m,millisecond:C,timezoneOffset:O,timeHash:we}=n;Object.assign(c.value,{hour:u,minute:S,second:m,millisecond:C,timezoneOffset:O,timeHash:we})}const d=t+"/"+ve(o)+"/01";d!==c.value.dateHash&&(F.value=c.value.dateHash<d==(f.lang.rtl!==!0)?"left":"right",t!==c.value.year&&(ie.value=F.value),Ve(()=>{ee.value=t-t%de-(t<0?de:0),Object.assign(c.value,{year:t,month:o,day:1,dateHash:d})}))}function Ze(t,o,n){const d=t!==null&&t.length===1&&e.multiple===!1?t[0]:t;N=d;const{reason:u,details:S}=et(o,n);l("update:modelValue",d,u,S)}function Te(t){const o=Q.value[0]!==void 0&&Q.value[0].dateHash!==null?{...Q.value[0]}:{...c.value};Ve(()=>{o.year=c.value.year,o.month=c.value.month;const n=e.calendar!=="persian"?new Date(o.year,o.month,0).getDate():Ne(o.year,o.month);o.day=Math.min(Math.max(1,o.day),n);const d=he(o);N=d;const{details:u}=et("",o);l("update:modelValue",d,t,u)})}function et(t,o){return o.from!==void 0?{reason:`${t}-range`,details:{...ue(o.target),from:ue(o.from),to:ue(o.to)}}:{reason:`${t}-day`,details:ue(o)}}function he(t,o,n){return t.from!==void 0?{from:ye.value(t.from,o,n),to:ye.value(t.to,o,n)}:ye.value(t,o,n)}function Be(t){let o;if(e.multiple===!0)if(t.from!==void 0){const n=ne(t.from),d=ne(t.to),u=Q.value.filter(m=>m.dateHash<n||m.dateHash>d),S=te.value.filter(({from:m,to:C})=>C.dateHash<n||m.dateHash>d);o=u.concat(S).concat(t).map(m=>he(m))}else{const n=U.value.slice();n.push(he(t)),o=n}else o=he(t);Ze(o,"add",t)}function $e(t){if(e.noUnset===!0)return;let o=null;if(e.multiple===!0&&Array.isArray(e.modelValue)===!0){const n=he(t);t.from!==void 0?o=e.modelValue.filter(d=>d.from!==void 0?d.from!==n.from&&d.to!==n.to:!0):o=e.modelValue.filter(d=>d!==n),o.length===0&&(o=null)}Ze(o,"remove",t)}function tt(t,o,n){const d=Q.value.concat(te.value).map(u=>he(u,t,o)).filter(u=>u.from!==void 0?u.from.dateHash!==null&&u.to.dateHash!==null:u.dateHash!==null);l("update:modelValue",(e.multiple===!0?d:d[0])||null,n)}function zt(){if(e.minimal!==!0)return v("div",{class:"q-date__header "+M.value},[v("div",{class:"relative-position"},[v(xe,{name:"q-transition--fade"},()=>v("div",{key:"h-yr-"+G.value,class:"q-date__header-subtitle q-date__header-link "+(E.value==="Years"?"q-date__header-link--active":"cursor-pointer"),tabindex:_.value,...g("vY",{onClick(){E.value="Years"},onKeyup(t){t.keyCode===13&&(E.value="Years")}})},[G.value]))]),v("div",{class:"q-date__header-title relative-position flex no-wrap"},[v("div",{class:"relative-position col"},[v(xe,{name:"q-transition--fade"},()=>v("div",{key:"h-sub"+pe.value,class:"q-date__header-title-label q-date__header-link "+(E.value==="Calendar"?"q-date__header-link--active":"cursor-pointer"),tabindex:_.value,...g("vC",{onClick(){E.value="Calendar"},onKeyup(t){t.keyCode===13&&(E.value="Calendar")}})},[pe.value]))]),e.todayBtn===!0?v(I,{class:"q-date__header-today self-start",icon:f.iconSet.datetime.today,flat:!0,size:"sm",round:!0,tabindex:_.value,onClick:We}):null])])}function Le({label:t,type:o,key:n,dir:d,goTo:u,boundaries:S,cls:m}){return[v("div",{class:"row items-center q-date__arrow"},[v(I,{round:!0,dense:!0,size:"sm",flat:!0,icon:oe.value[0],tabindex:_.value,disable:S.prev===!1,...g("go-#"+o,{onClick(){u(-1)}})})]),v("div",{class:"relative-position overflow-hidden flex flex-center"+m},[v(xe,{name:"q-transition--jump-"+d},()=>v("div",{key:n},[v(I,{flat:!0,dense:!0,noCaps:!0,label:t,tabindex:_.value,...g("view#"+o,{onClick:()=>{E.value=o}})})]))]),v("div",{class:"row items-center q-date__arrow"},[v(I,{round:!0,dense:!0,size:"sm",flat:!0,icon:oe.value[1],tabindex:_.value,disable:S.next===!1,...g("go+#"+o,{onClick(){u(1)}})})])]}const Mt={Calendar:()=>[v("div",{key:"calendar-view",class:"q-date__view q-date__calendar"},[v("div",{class:"q-date__navigation row items-center no-wrap"},Le({label:z.value.months[c.value.month-1],type:"Months",key:c.value.month,dir:F.value,goTo:Xe,boundaries:Ce.value.month,cls:" col"}).concat(Le({label:c.value.year,type:"Years",key:c.value.year,dir:ie.value,goTo:Oe,boundaries:Ce.value.year,cls:""}))),v("div",{class:"q-date__calendar-weekdays row items-center no-wrap"},r.value.map(t=>v("div",{class:"q-date__calendar-item"},[v("div",t)]))),v("div",{class:"q-date__calendar-days-container relative-position overflow-hidden"},[v(xe,{name:"q-transition--slide-"+F.value},()=>v("div",{key:K.value,class:"q-date__calendar-days fit"},Qe.value.map(t=>v("div",{class:t.classes},[t.in===!0?v(I,{class:t.today===!0?"q-date__today":"",dense:!0,flat:t.flat,unelevated:t.unelevated,color:t.color,textColor:t.textColor,label:t.i,tabindex:_.value,...g("day#"+t.i,{onClick:()=>{Ot(t.i)},onMouseover:()=>{Bt(t.i)}})},t.event!==!1?()=>v("div",{class:"q-date__event bg-"+t.event}):null):v("div",""+t.i)]))))])])],Months(){const t=c.value.year===Y.value.year,o=d=>x.value!==null&&c.value.year===x.value.year&&x.value.month>d||B.value!==null&&c.value.year===B.value.year&&B.value.month<d,n=z.value.monthsShort.map((d,u)=>{const S=c.value.month===u+1;return v("div",{class:"q-date__months-item flex flex-center"},[v(I,{class:t===!0&&Y.value.month===u+1?"q-date__today":null,flat:S!==!0,label:d,unelevated:S,color:S===!0?h.value:null,textColor:S===!0?y.value:null,tabindex:_.value,disable:o(u+1),...g("month#"+u,{onClick:()=>{Dt(u+1)}})})])});return e.yearsInMonthView===!0&&n.unshift(v("div",{class:"row no-wrap full-width"},[Le({label:c.value.year,type:"Years",key:c.value.year,dir:ie.value,goTo:Oe,boundaries:Ce.value.year,cls:" col"})])),v("div",{key:"months-view",class:"q-date__view q-date__months flex flex-center"},n)},Years(){const t=ee.value,o=t+de,n=[],d=u=>x.value!==null&&x.value.year>u||B.value!==null&&B.value.year<u;for(let u=t;u<=o;u++){const S=c.value.year===u;n.push(v("div",{class:"q-date__years-item flex flex-center"},[v(I,{key:"yr"+u,class:Y.value.year===u?"q-date__today":null,flat:!S,label:u,dense:!0,unelevated:S,color:S===!0?h.value:null,textColor:S===!0?y.value:null,tabindex:_.value,disable:d(u),...g("yr#"+u,{onClick:()=>{Tt(u)}})})]))}return v("div",{class:"q-date__view q-date__years flex flex-center"},[v("div",{class:"col-auto"},[v(I,{round:!0,dense:!0,flat:!0,icon:oe.value[0],tabindex:_.value,disable:d(t),...g("y-",{onClick:()=>{ee.value-=de}})})]),v("div",{class:"q-date__years-content col self-stretch row items-center"},n),v("div",{class:"col-auto"},[v(I,{round:!0,dense:!0,flat:!0,icon:oe.value[1],tabindex:_.value,disable:d(o),...g("y+",{onClick:()=>{ee.value+=de}})})])])}};function Ot(t){const o={...c.value,day:t};if(e.range===!1){Ht(o,K.value);return}if(V.value===null){const n=Qe.value.find(u=>u.fill!==!0&&u.i===t);if(e.noUnset!==!0&&n.range!==void 0){$e({target:o,from:n.range.from,to:n.range.to});return}if(n.selected===!0){$e(o);return}const d=ne(o);V.value={init:o,initHash:d,final:o,finalHash:d},l("rangeStart",ue(o))}else{const n=V.value.initHash,d=ne(o),u=n<=d?{from:V.value.init,to:o}:{from:o,to:V.value.init};V.value=null,Be(n===d?o:{target:o,...u}),l("rangeEnd",{from:ue(u.from),to:ue(u.to)})}}function Bt(t){if(V.value!==null){const o={...c.value,day:t};Object.assign(V.value,{final:o,finalHash:ne(o)})}}return Object.assign(s,{setToday:We,setView:xt,offsetCalendar:qt,setCalendarTo:ze,setEditingRange:St}),()=>{const t=[v("div",{class:"q-date__content col relative-position"},[v(xe,{name:"q-transition--fade"},Mt[E.value])])],o=ct(a.default);return o!==void 0&&t.push(v("div",{class:"q-date__actions"},o)),e.name!==void 0&&e.disable!==!0&&T(t,"push"),v("div",{class:w.value,...wt.value},[zt(),v("div",{ref:W,class:"q-date__main col column",tabindex:-1},t)])}}});function ht(e,a){if(a&&e===a)return null;const l=e.nodeName.toLowerCase();if(["div","li","ul","ol","blockquote"].includes(l)===!0)return e;const s=window.getComputedStyle?window.getComputedStyle(e):e.currentStyle,f=s.display;return f==="block"||f==="table"?e:ht(e.parentNode)}function Re(e,a,l){return!e||e===document.body?!1:l===!0&&e===a||(a===document?document.body:a).contains(e.parentNode)}function gt(e,a,l){if(l||(l=document.createRange(),l.selectNode(e),l.setStart(e,0)),a.count===0)l.setEnd(e,a.count);else if(a.count>0)if(e.nodeType===Node.TEXT_NODE)e.textContent.length<a.count?a.count-=e.textContent.length:(l.setEnd(e,a.count),a.count=0);else for(let s=0;a.count!==0&&s<e.childNodes.length;s++)l=gt(e.childNodes[s],a,l);return l}const wa=/^https?:\/\//;class xa{constructor(a,l){this.el=a,this.eVm=l,this._range=null}get selection(){if(this.el){const a=document.getSelection();if(Re(a.anchorNode,this.el,!0)&&Re(a.focusNode,this.el,!0))return a}return null}get hasSelection(){return this.selection!==null?this.selection.toString().length!==0:!1}get range(){const a=this.selection;return a!==null&&a.rangeCount?a.getRangeAt(0):this._range}get parent(){const a=this.range;if(a!==null){const l=a.startContainer;return l.nodeType===document.ELEMENT_NODE?l:l.parentNode}return null}get blockParent(){const a=this.parent;return a!==null?ht(a,this.el):null}save(a=this.range){a!==null&&(this._range=a)}restore(a=this._range){const l=document.createRange(),s=document.getSelection();a!==null?(l.setStart(a.startContainer,a.startOffset),l.setEnd(a.endContainer,a.endOffset),s.removeAllRanges(),s.addRange(l)):(s.selectAllChildren(this.el),s.collapseToEnd())}savePosition(){let a=-1,l;const s=document.getSelection(),f=this.el.parentNode;if(s.focusNode&&Re(s.focusNode,f))for(l=s.focusNode,a=s.focusOffset;l&&l!==f;)l!==this.el&&l.previousSibling?(l=l.previousSibling,a+=l.textContent.length):l=l.parentNode;this.savedPos=a}restorePosition(a=0){if(this.savedPos>0&&this.savedPos<a){const l=window.getSelection(),s=gt(this.el,{count:this.savedPos});s&&(s.collapse(!1),l.removeAllRanges(),l.addRange(s))}}hasParent(a,l){const s=l?this.parent:this.blockParent;return s!==null?s.nodeName.toLowerCase()===a.toLowerCase():!1}hasParents(a,l,s=this.parent){return s===null?!1:a.includes(s.nodeName.toLowerCase())===!0?!0:l===!0?this.hasParents(a,l,s.parentNode):!1}is(a,l){if(this.selection===null)return!1;switch(a){case"formatBlock":return l==="DIV"&&this.parent===this.el||this.hasParent(l,l==="PRE");case"link":return this.hasParent("A",!0);case"fontSize":return document.queryCommandValue(a)===l;case"fontName":const s=document.queryCommandValue(a);return s===`"${l}"`||s===l;case"fullscreen":return this.eVm.inFullscreen.value;case"viewsource":return this.eVm.isViewingSource.value;case void 0:return!1;default:const f=document.queryCommandState(a);return l!==void 0?f===l:f}}getParentAttribute(a){return this.parent!==null?this.parent.getAttribute(a):null}can(a){if(a==="outdent")return this.hasParents(["blockquote","li"],!0);if(a==="indent")return this.hasParents(["li"],!0);if(a==="link")return this.selection!==null||this.is("link")}apply(a,l,s=Nt){if(a==="formatBlock")["BLOCKQUOTE","H1","H2","H3","H4","H5","H6"].includes(l)&&this.is(a,l)&&(a="outdent",l=null),l==="PRE"&&this.is(a,"PRE")&&(l="P");else if(a==="print"){s();const f=window.open();f.document.write(`
        <!doctype html>
        <html>
          <head>
            <title>Print - ${document.title}</title>
          </head>
          <body>
            <div>${this.el.innerHTML}</div>
          </body>
        </html>
      `),f.print(),f.close();return}else if(a==="link"){const f=this.getParentAttribute("href");if(f===null){const b=this.selectWord(this.selection),g=b?b.toString():"";if(!g.length&&(!this.range||!this.range.cloneContents().querySelector("img")))return;this.eVm.editLinkUrl.value=wa.test(g)?g:"https://",document.execCommand("createLink",!1,this.eVm.editLinkUrl.value),this.save(b.getRangeAt(0))}else this.eVm.editLinkUrl.value=f,this.range.selectNodeContents(this.parent),this.save();return}else if(a==="fullscreen"){this.eVm.toggleFullscreen(),s();return}else if(a==="viewsource"){this.eVm.isViewingSource.value=this.eVm.isViewingSource.value===!1,this.eVm.setContent(this.eVm.props.modelValue),s();return}document.execCommand(a,!1,l),s()}selectWord(a){if(a===null||a.isCollapsed!==!0||a.modify===void 0)return a;const l=document.createRange();l.setStart(a.anchorNode,a.anchorOffset),l.setEnd(a.focusNode,a.focusOffset);const s=l.collapsed?["backward","forward"]:["forward","backward"];l.detach();const f=a.focusNode,b=a.focusOffset;return a.collapse(a.anchorNode,a.anchorOffset),a.modify("move",s[0],"character"),a.modify("move",s[1],"word"),a.extend(f,b),a.modify("extend",s[1],"character"),a.modify("extend",s[0],"word"),a}}function yt(e,a,l){a.handler?a.handler(e,l,l.caret):l.runCmd(a.cmd,a.param)}function Ye(e){return v("div",{class:"q-editor__toolbar-group"},e)}function pt(e,a,l,s=!1){const f=s||(a.type==="toggle"?a.toggled?a.toggled(e):a.cmd&&e.caret.is(a.cmd,a.param):!1),b=[];if(a.tip&&e.$q.platform.is.desktop){const g=a.key?v("div",[v("small",`(CTRL + ${String.fromCharCode(a.key)})`)]):null;b.push(v(mt,{delay:1e3},()=>[v("div",{innerHTML:a.tip}),g]))}return v(I,{...e.buttonProps.value,icon:a.icon!==null?a.icon:void 0,color:f?a.toggleColor||e.props.toolbarToggleColor:a.color||e.props.toolbarColor,textColor:f&&!e.props.toolbarPush?null:a.textColor||e.props.toolbarTextColor,label:a.label,disable:a.disable?typeof a.disable=="function"?a.disable(e):!0:!1,size:"sm",onClick(g){l&&l(),yt(g,a,e)}},()=>b)}function qa(e,a){const l=a.list==="only-icons";let s=a.label,f=a.icon!==null?a.icon:void 0,b,g;function _(){P.component.proxy.hide()}if(l)g=a.options.map(k=>{const N=k.type===void 0?e.caret.is(k.cmd,k.param):!1;return N&&(s=k.tip,f=k.icon!==null?k.icon:void 0),pt(e,k,_,N)}),b=e.toolbarBackgroundClass.value,g=[Ye(g)];else{const k=e.props.toolbarToggleColor!==void 0?`text-${e.props.toolbarToggleColor}`:null,N=e.props.toolbarTextColor!==void 0?`text-${e.props.toolbarTextColor}`:null,D=a.list==="no-icons";g=a.options.map(T=>{const W=T.disable?T.disable(e):!1,A=T.type===void 0?e.caret.is(T.cmd,T.param):!1;A&&(s=T.tip,f=T.icon!==null?T.icon:void 0);const z=T.htmlTip;return v(ca,{active:A,activeClass:k,clickable:!0,disable:W,dense:!0,onClick(J){_(),e.contentRef.value!==null&&e.contentRef.value.focus(),e.caret.restore(),yt(J,T,e)}},()=>[D===!0?null:v(nt,{class:A?k:N,side:!0},()=>v(Ae,{name:T.icon!==null?T.icon:void 0})),v(nt,z?()=>v("div",{class:"text-no-wrap",innerHTML:T.htmlTip}):T.tip?()=>v("div",{class:"text-no-wrap"},T.tip):void 0)])}),b=[e.toolbarBackgroundClass.value,N]}const M=a.highlight&&s!==a.label,P=v(ua,{...e.buttonProps.value,noCaps:!0,noWrap:!0,color:M?e.props.toolbarToggleColor:e.props.toolbarColor,textColor:M&&!e.props.toolbarPush?null:e.props.toolbarTextColor,label:a.fixedLabel?a.label:s,icon:a.fixedIcon?a.icon!==null?a.icon:void 0:f,contentClass:b,onShow:k=>e.emit("dropdownShow",k),onHide:k=>e.emit("dropdownHide",k),onBeforeShow:k=>e.emit("dropdownBeforeShow",k),onBeforeHide:k=>e.emit("dropdownBeforeHide",k)},()=>g);return P}function Sa(e){if(e.caret)return e.buttons.value.filter(a=>!e.isViewingSource.value||a.find(l=>l.cmd==="viewsource")).map(a=>Ye(a.map(l=>e.isViewingSource.value&&l.cmd!=="viewsource"?!1:l.type==="slot"?ct(e.slots[l.slot]):l.type==="dropdown"?qa(e,l):pt(e,l))))}function Ta(e,a,l,s={}){const f=Object.keys(s);if(f.length===0)return{};const b={default_font:{cmd:"fontName",param:e,icon:l,tip:a}};return f.forEach(g=>{const _=s[g];b[g]={cmd:"fontName",param:_,icon:l,tip:_,htmlTip:`<font face="${_}">${_}</font>`}}),b}function Da(e){if(e.caret){const a=e.props.toolbarColor||e.props.toolbarTextColor;let l=e.editLinkUrl.value;const s=()=>{e.caret.restore(),l!==e.editLinkUrl.value&&document.execCommand("createLink",!1,l===""?" ":l),e.editLinkUrl.value=null};return[v("div",{class:`q-mx-xs text-${a}`},`${e.$q.lang.editor.url}: `),v("input",{key:"qedt_btm_input",class:"col q-editor__link-input",value:l,onInput:f=>{Et(f),l=f.target.value},onKeydown:f=>{if(vt(f)!==!0)switch(f.keyCode){case 13:return at(f),s();case 27:at(f),e.caret.restore(),(!e.editLinkUrl.value||e.editLinkUrl.value==="https://")&&document.execCommand("unlink"),e.editLinkUrl.value=null;break}}}),Ye([v(I,{key:"qedt_btm_rem",tabindex:-1,...e.buttonProps.value,label:e.$q.lang.label.remove,noCaps:!0,onClick:()=>{e.caret.restore(),document.execCommand("unlink"),e.editLinkUrl.value=null}}),v(I,{key:"qedt_btm_upd",...e.buttonProps.value,label:e.$q.lang.label.update,noCaps:!0,onClick:s})])]}}const Ha=Object.prototype.toString,Ie=Object.prototype.hasOwnProperty,za=new Set(["Boolean","Number","String","Function","Array","Date","RegExp"].map(e=>"[object "+e+"]"));function rt(e){if(e!==Object(e)||za.has(Ha.call(e))===!0||e.constructor&&Ie.call(e,"constructor")===!1&&Ie.call(e.constructor.prototype,"isPrototypeOf")===!1)return!1;let a;for(a in e);return a===void 0||Ie.call(e,a)}function bt(){let e,a,l,s,f,b,g=arguments[0]||{},_=1,M=!1;const P=arguments.length;for(typeof g=="boolean"&&(M=g,g=arguments[1]||{},_=2),Object(g)!==g&&typeof g!="function"&&(g={}),P===_&&(g=this,_--);_<P;_++)if((e=arguments[_])!==null)for(a in e)l=g[a],s=e[a],g!==s&&(M===!0&&s&&((f=Array.isArray(s))||rt(s)===!0)?(f===!0?b=Array.isArray(l)===!0?l:[]:b=rt(l)===!0?l:{},g[a]=bt(M,b,s)):s!==void 0&&(g[a]=s));return g}var Ma=it({name:"QEditor",props:{...st,...da,modelValue:{type:String,required:!0},readonly:Boolean,disable:Boolean,minHeight:{type:String,default:"10rem"},maxHeight:String,height:String,definitions:Object,fonts:Object,placeholder:String,toolbar:{type:Array,validator:e=>e.length===0||e.every(a=>a.length),default(){return[["left","center","right","justify"],["bold","italic","underline","strike"],["undo","redo"]]}},toolbarColor:String,toolbarBg:String,toolbarTextColor:String,toolbarToggleColor:{type:String,default:"primary"},toolbarOutline:Boolean,toolbarPush:Boolean,toolbarRounded:Boolean,paragraphTag:{type:String,validator:e=>["div","p"].includes(e),default:"div"},contentStyle:Object,contentClass:[Object,Array,String],square:Boolean,flat:Boolean,dense:Boolean},emits:[...va,"update:modelValue","keydown","click","mouseup","keyup","touchend","focus","blur","dropdownShow","dropdownHide","dropdownBeforeShow","dropdownBeforeHide","linkShow","linkHide"],setup(e,{slots:a,emit:l,attrs:s}){const{proxy:f,vnode:b}=dt(),{$q:g}=f,_=ut(e,g),{inFullscreen:M,toggleFullscreen:P}=fa(),k=Ft(s,b),N=H(null),D=H(null),T=H(null),W=H(!1),A=p(()=>!e.readonly&&!e.disable);let z,J,X=e.modelValue;document.execCommand("defaultParagraphSeparator",!1,e.paragraphTag),z=window.getComputedStyle(document.body).fontFamily;const Y=p(()=>e.toolbarBg?` bg-${e.toolbarBg}`:""),c=p(()=>{const r=e.toolbarOutline!==!0&&e.toolbarPush!==!0;return{type:"a",flat:r,noWrap:!0,outline:e.toolbarOutline,push:e.toolbarPush,rounded:e.toolbarRounded,dense:!0,color:e.toolbarColor,disable:!A.value,size:"sm"}}),E=p(()=>{const r=g.lang.editor,i=g.iconSet.editor;return{bold:{cmd:"bold",icon:i.bold,tip:r.bold,key:66},italic:{cmd:"italic",icon:i.italic,tip:r.italic,key:73},strike:{cmd:"strikeThrough",icon:i.strikethrough,tip:r.strikethrough,key:83},underline:{cmd:"underline",icon:i.underline,tip:r.underline,key:85},unordered:{cmd:"insertUnorderedList",icon:i.unorderedList,tip:r.unorderedList},ordered:{cmd:"insertOrderedList",icon:i.orderedList,tip:r.orderedList},subscript:{cmd:"subscript",icon:i.subscript,tip:r.subscript,htmlTip:"x<subscript>2</subscript>"},superscript:{cmd:"superscript",icon:i.superscript,tip:r.superscript,htmlTip:"x<superscript>2</superscript>"},link:{cmd:"link",disable:q=>q.caret&&!q.caret.can("link"),icon:i.hyperlink,tip:r.hyperlink,key:76},fullscreen:{cmd:"fullscreen",icon:i.toggleFullscreen,tip:r.toggleFullscreen,key:70},viewsource:{cmd:"viewsource",icon:i.viewSource,tip:r.viewSource},quote:{cmd:"formatBlock",param:"BLOCKQUOTE",icon:i.quote,tip:r.quote,key:81},left:{cmd:"justifyLeft",icon:i.left,tip:r.left},center:{cmd:"justifyCenter",icon:i.center,tip:r.center},right:{cmd:"justifyRight",icon:i.right,tip:r.right},justify:{cmd:"justifyFull",icon:i.justify,tip:r.justify},print:{type:"no-state",cmd:"print",icon:i.print,tip:r.print,key:80},outdent:{type:"no-state",disable:q=>q.caret&&!q.caret.can("outdent"),cmd:"outdent",icon:i.outdent,tip:r.outdent},indent:{type:"no-state",disable:q=>q.caret&&!q.caret.can("indent"),cmd:"indent",icon:i.indent,tip:r.indent},removeFormat:{type:"no-state",cmd:"removeFormat",icon:i.removeFormat,tip:r.removeFormat},hr:{type:"no-state",cmd:"insertHorizontalRule",icon:i.hr,tip:r.hr},undo:{type:"no-state",cmd:"undo",icon:i.undo,tip:r.undo,key:90},redo:{type:"no-state",cmd:"redo",icon:i.redo,tip:r.redo,key:89},h1:{cmd:"formatBlock",param:"H1",icon:i.heading1||i.heading,tip:r.heading1,htmlTip:`<h1 class="q-ma-none">${r.heading1}</h1>`},h2:{cmd:"formatBlock",param:"H2",icon:i.heading2||i.heading,tip:r.heading2,htmlTip:`<h2 class="q-ma-none">${r.heading2}</h2>`},h3:{cmd:"formatBlock",param:"H3",icon:i.heading3||i.heading,tip:r.heading3,htmlTip:`<h3 class="q-ma-none">${r.heading3}</h3>`},h4:{cmd:"formatBlock",param:"H4",icon:i.heading4||i.heading,tip:r.heading4,htmlTip:`<h4 class="q-ma-none">${r.heading4}</h4>`},h5:{cmd:"formatBlock",param:"H5",icon:i.heading5||i.heading,tip:r.heading5,htmlTip:`<h5 class="q-ma-none">${r.heading5}</h5>`},h6:{cmd:"formatBlock",param:"H6",icon:i.heading6||i.heading,tip:r.heading6,htmlTip:`<h6 class="q-ma-none">${r.heading6}</h6>`},p:{cmd:"formatBlock",param:e.paragraphTag,icon:i.heading,tip:r.paragraph},code:{cmd:"formatBlock",param:"PRE",icon:i.code,htmlTip:`<code>${r.code}</code>`},"size-1":{cmd:"fontSize",param:"1",icon:i.size1||i.size,tip:r.size1,htmlTip:`<font size="1">${r.size1}</font>`},"size-2":{cmd:"fontSize",param:"2",icon:i.size2||i.size,tip:r.size2,htmlTip:`<font size="2">${r.size2}</font>`},"size-3":{cmd:"fontSize",param:"3",icon:i.size3||i.size,tip:r.size3,htmlTip:`<font size="3">${r.size3}</font>`},"size-4":{cmd:"fontSize",param:"4",icon:i.size4||i.size,tip:r.size4,htmlTip:`<font size="4">${r.size4}</font>`},"size-5":{cmd:"fontSize",param:"5",icon:i.size5||i.size,tip:r.size5,htmlTip:`<font size="5">${r.size5}</font>`},"size-6":{cmd:"fontSize",param:"6",icon:i.size6||i.size,tip:r.size6,htmlTip:`<font size="6">${r.size6}</font>`},"size-7":{cmd:"fontSize",param:"7",icon:i.size7||i.size,tip:r.size7,htmlTip:`<font size="7">${r.size7}</font>`}}}),Z=p(()=>{const r=e.definitions||{},i=e.definitions||e.fonts?bt(!0,{},E.value,r,Ta(z,g.lang.editor.defaultFont,g.iconSet.editor.font,e.fonts)):E.value;return e.toolbar.map(q=>q.map(x=>{if(x.options)return{type:"dropdown",icon:x.icon,label:x.label,size:"sm",dense:!0,fixedLabel:x.fixedLabel,fixedIcon:x.fixedIcon,highlight:x.highlight,list:x.list,options:x.options.map(Ce=>i[Ce])};const B=i[x];return B?B.type==="no-state"||r[x]&&(B.cmd===void 0||E.value[B.cmd]&&E.value[B.cmd].type==="no-state")?B:Object.assign({type:"toggle"},B):{type:"slot",slot:x}}))}),F={$q:g,props:e,slots:a,emit:l,inFullscreen:M,toggleFullscreen:P,runCmd:_e,isViewingSource:W,editLinkUrl:T,toolbarBackgroundClass:Y,buttonProps:c,contentRef:D,buttons:Z,setContent:be};re(()=>e.modelValue,r=>{X!==r&&(X=r,be(r,!0))}),re(T,r=>{l(`link-${r?"Show":"Hide"}`)});const ie=p(()=>e.toolbar&&e.toolbar.length!==0),se=p(()=>{const r={},i=q=>{q.key&&(r[q.key]={cmd:q.cmd,param:q.param})};return Z.value.forEach(q=>{q.forEach(x=>{x.options?x.options.forEach(i):i(x)})}),r}),ee=p(()=>M.value?e.contentStyle:[{minHeight:e.minHeight,height:e.height,maxHeight:e.maxHeight},e.contentStyle]),V=p(()=>`q-editor q-editor--${W.value===!0?"source":"default"}`+(e.disable===!0?" disabled":"")+(M.value===!0?" fullscreen column":"")+(e.square===!0?" q-editor--square no-border-radius":"")+(e.flat===!0?" q-editor--flat":"")+(e.dense===!0?" q-editor--dense":"")+(_.value===!0?" q-editor--dark q-dark":"")),w=p(()=>[e.contentClass,"q-editor__content",{col:M.value,"overflow-auto":M.value||e.maxHeight}]),h=p(()=>e.disable===!0?{"aria-disabled":"true"}:e.readonly===!0?{"aria-readonly":"true"}:{});function y(){if(D.value!==null){const r=`inner${W.value===!0?"Text":"HTML"}`,i=D.value[r];i!==e.modelValue&&(X=i,l("update:modelValue",i))}}function L(r){if(l("keydown",r),r.ctrlKey!==!0||vt(r)===!0){G();return}const i=r.keyCode,q=se.value[i];if(q!==void 0){const{cmd:x,param:B}=q;It(r),_e(x,B,!1)}}function U(r){G(),l("click",r)}function Q(r){if(D.value!==null){const{scrollTop:i,scrollHeight:q}=D.value;J=q-i}F.caret.save(),l("blur",r)}function te(r){Ve(()=>{D.value!==null&&J!==void 0&&(D.value.scrollTop=D.value.scrollHeight-J)}),l("focus",r)}function fe(r){const i=N.value;if(i!==null&&i.contains(r.target)===!0&&(r.relatedTarget===null||i.contains(r.relatedTarget)!==!0)){const q=`inner${W.value===!0?"Text":"HTML"}`;F.caret.restorePosition(D.value[q].length),G()}}function ye(r){const i=N.value;i!==null&&i.contains(r.target)===!0&&(r.relatedTarget===null||i.contains(r.relatedTarget)!==!0)&&(F.caret.savePosition(),G())}function ae(){J=void 0}function pe(r){F.caret.save()}function be(r,i){if(D.value!==null){i===!0&&F.caret.savePosition();const q=`inner${W.value===!0?"Text":"HTML"}`;D.value[q]=r,i===!0&&(F.caret.restorePosition(D.value[q].length),G())}}function _e(r,i,q=!0){oe(),F.caret.restore(),F.caret.apply(r,i,()=>{oe(),F.caret.save(),q&&G()})}function G(){setTimeout(()=>{T.value=null,f.$forceUpdate()},1)}function oe(){Vt(()=>{D.value!==null&&D.value.focus({preventScroll:!0})})}function qe(){return D.value}return ft(()=>{F.caret=f.caret=new xa(D.value,F),be(e.modelValue),G(),document.addEventListener("selectionchange",pe)}),Rt(()=>{document.removeEventListener("selectionchange",pe)}),Object.assign(f,{runCmd:_e,refreshToolbar:G,focus:oe,getContentEl:qe}),()=>{let r;if(ie.value){const i=[v("div",{key:"qedt_top",class:"q-editor__toolbar row no-wrap scroll-x"+Y.value},Sa(F))];T.value!==null&&i.push(v("div",{key:"qedt_btm",class:"q-editor__toolbar row no-wrap items-center scroll-x"+Y.value},Da(F))),r=v("div",{key:"toolbar_ctainer",class:"q-editor__toolbars-container"},i)}return v("div",{ref:N,class:V.value,style:{height:M.value===!0?"100%":null},...h.value,onFocusin:fe,onFocusout:ye},[r,v("div",{ref:D,style:ee.value,class:w.value,contenteditable:A.value,placeholder:e.placeholder,...k.listeners.value,onInput:y,onKeydown:L,onClick:U,onBlur:Q,onFocus:te,onMousedown:ae,onTouchstartPassive:ae})])}}});const Oa={class:"row q-pa-xs"},Ba={class:"col-12"},$a={class:"column items-center"},La={class:"row justify-end"},Pa={class:"col-12"},ja={key:0,class:"no-tasks text-center",style:{height:"100%"}},Na={autocorrect:"off",autocapitalize:"off",autocomplete:"off",spellcheck:"false"},Ea={class:"row justify-end q-pa-md q-gutter-x-sm"},Fa={class:"text-h5"},Ra={key:0},Ia=R("div",{class:"text-h6 text-center"},"\u8BBE \u7F6E",-1),Va={class:"q-gutter-sm q-pa-sm"},Aa=R("div",{class:"text-subtitle2"},"\u4E8B\u4EF6\u8303\u56F4\uFF1A",-1),Ya=R("div",{class:"text-subtitle2"},"\u6700\u8FD1\uFF1A",-1),Ua=R("div",{class:"text-subtitle2"},"\u6708",-1),Qa=R("div",{class:"text-subtitle2"},"\u65E5\u5386\u989C\u8272\uFF1A",-1),Wa=R("div",{class:"text-subtitle2"},null,-1),Ka=R("div",{class:"text-subtitle2"},null,-1),Ja=R("div",{class:"text-subtitle2"},"\u4E8B\u4EF6\u989C\u8272\uFF1A",-1),Ga=R("div",{class:"text-subtitle2"},null,-1),Xa=R("div",{class:"text-subtitle2"},null,-1),Za={class:"row q-gutter-xs justify-end q-pa-sm"},ho={__name:"LoggerPage",setup(e){const a=ra(),l=At(),s=H(!1),f=H(a.todayDate),b=H([]),g=H([]),_=H(""),M=H(""),P=H(),k=H(!1),N=H(!0),D=H(!1),T=H([]),W=H(!1),A=[1,3,6,0],z=H(null),J=H(null),X=H(!1),Y=[{label:"\u84DD\u8272",value:"primary"},{label:"\u6A59\u8272",value:"orange"},{label:"\u7EFF\u8272",value:"green"},{label:"\u9752\u8272",value:"teal"},{label:"\u68D5\u8272",value:"brown"},{label:"\u7D2B\u8272",value:"purple"}],c=Yt({_id:"",date:"",user:"",logger:""});re(()=>f.value,w=>{for(const h of g.value)if(w===h){D.value=!0;break}else D.value=!1});const E=async()=>{var w,h;if(await((w=z.value)==null?void 0:w.validate())&&await((h=J.value)==null?void 0:h.validate())){const y={user:a.user.email,monthRange:P.value,themeColor:_.value,eventColor:M.value};await a.axios.post("/user/loggersetting",y).then(L=>{Z(),a.successTip(L.data.msg),X.value=!1}).catch(L=>{a.failureTip(L.response.data.msg)})}},Z=async()=>{await a.axios.get("/query/logger",{params:{user:a.user.email,month:P.value}}).then(w=>{b.value=w.data,T.value=b.value.map(h=>h.logger),g.value=b.value.map(h=>h.date)}).catch(w=>{a.failureTip(w.response.data.msg)})},F=w=>{const h=b.value[w].logger,y=T.value[w];h!==y?k.value=!0:k.value=!1},ie=w=>{b.value[w].logger=T.value[w],k.value=!1},se=async()=>{if(!f.value){a.failureTip("\u8BF7\u9009\u62E9\u65E5\u671F");return}c.logger.length>0&&(c.date=f.value,c.user=a.user.email,await a.axios.post("/query/addlogger",c).then(w=>{w.data.id&&(c._id=w.data.id),w.data.logger?c.logger=w.data.logger+"<ul><li>"+c.logger+"</li></ul>":c.logger="<ul><li>"+c.logger+"</li></ul>",b.value.unshift(JSON.parse(JSON.stringify(c))),T.value=b.value.map(h=>h.logger),g.value=b.value.map(h=>h.date),a.successTip(w.data.msg),D.value=!0}).catch(w=>{a.failureTip(w.response.data.msg)}).finally(()=>{c.logger=""}))},ee=async(w,h,y,L)=>{h==="<br><ul><li>"||h==="<div><br></div>"||h.length===0?V(w,L):(c._id=w,c.date=y,c.user=a.user.email,c.logger=h,await a.axios.post("/query/editlogger",c).then(U=>{b.value[L].logger=h,T.value=b.value.map(Q=>Q.logger),a.successTip(U.data.msg)}).catch(U=>{a.failureTip(U.response.data.msg)}).finally(()=>{c.date="",c.logger="",c._id="",k.value=!1,N.value=!0}))},V=(w,h)=>{a.$q.dialog({title:"\u786E\u5B9A",message:"\u786E\u5B9A\u8981\u5220\u9664\u8BB0\u5F55?",cancel:!0,persistent:!0,ok:{push:!0,label:"\u786E\u5B9A",color:"green"},cancel:{push:!0,color:"blue-grey",label:"\u53D6\u6D88"}}).onOk(async()=>{await a.axios.delete("/query/deletelogger",{params:{id:w,user:a.user.email}}).then(y=>{b.value.splice(h,1),T.value=b.value.map(L=>L.logger),g.value=b.value.map(L=>L.date),a.successTip(y.data.msg),k.value=!1,D.value=!1}).catch(y=>{a.failureTip(y.response.data.msg)})}).onCancel(()=>{})};return ft(async()=>{if(localStorage.getItem("token")!==null)try{await a.verifyUser().then(()=>{a.user?(P.value=a.user.loggerSetting.monthRange,_.value=a.user.loggerSetting.themeColor,M.value=a.user.loggerSetting.eventColor,Z()):l.push("/index")}).catch(()=>{l.push("/index")})}catch(h){console.log(h),l.push("/index")}else l.push("/index");D.value=!0}),(w,h)=>(ce(),De(sa,{class:"q-pa-xs column"},{default:$(()=>[R("div",Oa,[R("div",Ba,[R("div",$a,[j(ka,{modelValue:f.value,"onUpdate:modelValue":h[1]||(h[1]=y=>f.value=y),class:"item-center",landscape:Ut(a).$q.screen.gt.md,events:g.value,"years-in-month-view":"",color:_.value,"event-color":M.value,"today-btn":"",style:{width:"100%","max-width":"550px"}},{default:$(()=>[R("div",La,[j(I,{label:"\u8BBE\u7F6E",flat:"",onClick:h[0]||(h[0]=y=>X.value=!0)})])]),_:1},8,["modelValue","landscape","events","color","event-color"])])]),R("div",Pa,[j(Qt,{modelValue:c.logger,"onUpdate:modelValue":h[2]||(h[2]=y=>c.logger=y),outlined:"",type:"textarea",autogrow:"",class:"q-py-md",placeholder:"\u8BB0\u5F55\u70B9\u4E8B\u60C5\u5427...",onFocus:h[3]||(h[3]=y=>s.value=!0),onBlur:h[4]||(h[4]=y=>s.value=!1)},{prepend:$(()=>[j(Ae,{name:s.value?"tips_and_updates":"lightbulb",color:s.value?"orange":"grey"},null,8,["name","color"])]),append:$(()=>[j(I,{round:"",dense:"",flat:"",icon:"send",color:s.value?"primary":"grey",onClick:se},null,8,["color"])]),_:1},8,["modelValue"]),D.value?He("",!0):(ce(),Pe("div",ja,[j(Ae,{name:"psychology_alt",size:"150px",color:"primary"})])),j(ma,{modelValue:f.value,"onUpdate:modelValue":h[6]||(h[6]=y=>f.value=y),animated:"","transition-prev":"jump-up","transition-next":"jump-up"},{default:$(()=>[(ce(!0),Pe(Kt,null,Wt(b.value,(y,L)=>(ce(),De(ha,{key:y._id,item:y,index:L,name:y.date,class:"q-pa-none"},{default:$(()=>[R("form",Na,[R("div",Ea,[R("div",Fa,Zt(y.date),1),j(ia),k.value?(ce(),De(I,{key:0,label:"\u4FEE \u6539",class:"q-px-md",color:"primary",disable:W.value,onClick:U=>ee(y._id,y.logger,y.date,L)},null,8,["disable","onClick"])):He("",!0),k.value?(ce(),De(I,{key:1,label:"\u53D6 \u6D88",class:"q-px-md",color:"grey",onClick:U=>ie(L)},null,8,["onClick"])):He("",!0)]),j(Ma,{modelValue:y.logger,"onUpdate:modelValue":U=>y.logger=U,dense:w.$q.screen.lt.md,readonly:N.value,toolbar:[["fullscreen"],[{label:"\u529F\u80FD",size:"lg",icon:"filter_2",fixedLabel:!0,list:"only-icons",options:["left","center","right","justify","bold","italic","strike","quote","underline","unordered","ordered","outdent","indent","print","hr","link","undo","redo"]}],[{label:"\u5B57\u4F53\u5927\u5C0F",icon:w.$q.iconSet.editor.fontSize,fixedLabel:!0,size:"md",fixedIcon:!0,list:"no-icons",options:["size-1","size-2","size-3","size-4","size-5","size-6","size-7"]},"removeFormat"],["viewsource"],["edit"]],fonts:{arial:"Arial",arial_black:"Arial Black",comic_sans:"Comic Sans MS",courier_new:"Courier New",impact:"Impact",lucida_grande:"Lucida Grande",times_new_roman:"Times New Roman",verdana:"Verdana"},onInput:U=>F(L)},{edit:$(()=>[j(I,{icon:"edit",color:"primary",size:"sm",flat:"",padding:"none",onClick:h[5]||(h[5]=U=>N.value=!N.value)},{default:$(()=>[N.value?He("",!0):(ce(),Pe("div",Ra,".....")),j(mt,null,{default:$(()=>[ea(" \u70B9\u51FB\u5F00\u59CB\u7F16\u8F91 ")]),_:1})]),_:1})]),_:2},1032,["modelValue","onUpdate:modelValue","dense","readonly","toolbar","onInput"])])]),_:2},1032,["item","index","name"]))),128))]),_:1},8,["modelValue"])])]),j(Xt,{modelValue:X.value,"onUpdate:modelValue":h[10]||(h[10]=y=>X.value=y),persistent:""},{default:$(()=>[j(Jt,{style:{"min-width":"400px","min-height":"350px"}},{default:$(()=>[j(je,null,{default:$(()=>[Ia]),_:1}),j(je,null,{default:$(()=>[R("div",Va,[j(Ee,{modelValue:P.value,"onUpdate:modelValue":h[7]||(h[7]=y=>P.value=y),outlined:"",dense:"",options:A,"transition-show":"jump-up","transition-hide":"jump-up",hint:"0\u4EE3\u8868\u5168\u90E8","hide-hint":"","hide-bottom-space":""},{before:$(()=>[Aa]),prepend:$(()=>[Ya]),append:$(()=>[Ua]),_:1},8,["modelValue"]),j(Ee,{ref_key:"themeColoRef",ref:z,modelValue:_.value,"onUpdate:modelValue":h[8]||(h[8]=y=>_.value=y),outlined:"",dense:"",options:Y,"hide-bottom-space":"","emit-value":"","map-options":"","option-label":"label","option-value":"value","transition-show":"jump-up","transition-hide":"jump-up",rules:[y=>!!y||"\u8BF7\u9009\u62E9\u989C\u8272"]},{before:$(()=>[Qa]),prepend:$(()=>[Wa]),append:$(()=>[Ka]),_:1},8,["modelValue","rules"]),j(Ee,{ref_key:"eventColoRef",ref:J,modelValue:M.value,"onUpdate:modelValue":h[9]||(h[9]=y=>M.value=y),outlined:"",dense:"","hide-bottom-space":"","emit-value":"","map-options":"",options:Y,"option-label":"label","option-value":"value","transition-show":"jump-up","transition-hide":"jump-up",rules:[y=>!!y||"\u8BF7\u9009\u62E9\u989C\u8272"]},{before:$(()=>[Ja]),prepend:$(()=>[Ga]),append:$(()=>[Xa]),_:1},8,["modelValue","rules"])])]),_:1}),j(je,null,{default:$(()=>[R("div",Za,[j(I,{outline:"",label:"\u63D0 \u4EA4",color:"primary",onClick:E}),Gt(j(I,{outline:"",label:"\u53D6 \u6D88",color:"grey"},null,512),[[ga]])])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1}))}};export{ho as default};
