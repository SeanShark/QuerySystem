import{c as ne,u as se,f as ue,aJ as ie,j as le,r as K,a as c,k as re,aK as ce,m as de,aL as fe,n as ve,aM as he,w as M,aN as ge,af as me,aO as ye,aP as _,ai as Pe,aQ as ke,d as w,x as xe,aR as Te,o as Ce,g as Se,aS as pe,aT as qe,aU as Oe,ah as Ee,a7 as be,aV as Be,aW as Fe,ao as Ke}from"./index.faa5a0cc.js";import{u as Me,v as D,c as _e,d as we,e as De,p as R,r as A,s as Re,f as Ae}from"./position-engine.33b2a5fa.js";var Qe=ne({name:"QMenu",inheritAttrs:!1,props:{...Me,...se,...ue,...ie,persistent:Boolean,autoClose:Boolean,separateClosePopup:Boolean,noRouteDismiss:Boolean,noRefocus:Boolean,noFocus:Boolean,fit:Boolean,cover:Boolean,square:Boolean,anchor:{type:String,validator:D},self:{type:String,validator:D},offset:{type:Array,validator:_e},scrollTarget:{default:void 0},touchPosition:Boolean,maxHeight:{type:String,default:null},maxWidth:{type:String,default:null}},emits:[...le,"click","escapeKey"],setup(e,{slots:a,emit:o,attrs:s}){let n=null,v,d,h;const x=Se(),{proxy:g}=x,{$q:u}=g,i=K(null),l=K(!1),H=c(()=>e.persistent!==!0&&e.noRouteDismiss!==!0),Q=re(e,u),{registerTick:W,removeTick:N}=ce(),{registerTimeout:T}=de(),{transitionProps:U,transitionStyle:j}=fe(e),{localScrollTarget:C,changeScrollEvent:I,unconfigureScrollTarget:J}=we(e,B),{anchorEl:r,canShow:V}=De({showing:l}),{hide:S}=ve({showing:l,canShow:V,handleShow:Y,handleHide:Z,hideOnRouteChange:H,processOnMount:!0}),{showPortal:p,hidePortal:q,renderPortal:$}=he(x,i,te,"menu"),m={anchorEl:r,innerRef:i,onClickOutside(t){if(e.persistent!==!0&&l.value===!0)return S(t),(t.type==="touchstart"||t.target.classList.contains("q-dialog__backdrop"))&&Ee(t),!0}},O=c(()=>R(e.anchor||(e.cover===!0?"center middle":"bottom start"),u.lang.rtl)),z=c(()=>e.cover===!0?O.value:R(e.self||"top start",u.lang.rtl)),G=c(()=>(e.square===!0?" q-menu--square":"")+(Q.value===!0?" q-menu--dark q-dark":"")),X=c(()=>e.autoClose===!0?{onClick:ee}:{}),E=c(()=>l.value===!0&&e.persistent!==!0);M(E,t=>{t===!0?(pe(P),Ae(m)):(_(P),A(m))});function y(){qe(()=>{let t=i.value;t&&t.contains(document.activeElement)!==!0&&(t=t.querySelector("[autofocus][tabindex], [data-autofocus][tabindex]")||t.querySelector("[autofocus] [tabindex], [data-autofocus] [tabindex]")||t.querySelector("[autofocus], [data-autofocus]")||t,t.focus({preventScroll:!0}))})}function Y(t){if(n=e.noRefocus===!1?document.activeElement:null,ge(F),p(),B(),v=void 0,t!==void 0&&(e.touchPosition||e.contextMenu)){const k=me(t);if(k.left!==void 0){const{top:oe,left:ae}=r.value.getBoundingClientRect();v={left:k.left-ae,top:k.top-oe}}}d===void 0&&(d=M(()=>u.screen.width+"|"+u.screen.height+"|"+e.self+"|"+e.anchor+"|"+u.lang.rtl,f)),e.noFocus!==!0&&document.activeElement.blur(),W(()=>{f(),e.noFocus!==!0&&y()}),T(()=>{u.platform.is.ios===!0&&(h=e.autoClose,i.value.click()),f(),p(!0),o("show",t)},e.transitionDuration)}function Z(t){N(),q(),b(!0),n!==null&&(t===void 0||t.qClickOutside!==!0)&&(((t&&t.type.indexOf("key")===0?n.closest('[tabindex]:not([tabindex^="-"])'):void 0)||n).focus(),n=null),T(()=>{q(!0),o("hide",t)},e.transitionDuration)}function b(t){v=void 0,d!==void 0&&(d(),d=void 0),(t===!0||l.value===!0)&&(ye(F),J(),A(m),_(P)),t!==!0&&(n=null)}function B(){(r.value!==null||e.scrollTarget!==void 0)&&(C.value=Pe(r.value,e.scrollTarget),I(C.value,f))}function ee(t){h!==!0?(ke(g,t),o("click",t)):h=!1}function F(t){E.value===!0&&e.noFocus!==!0&&Oe(i.value,t.target)!==!0&&y()}function P(t){o("escapeKey"),S(t)}function f(){const t=i.value;t===null||r.value===null||Re({el:t,offset:e.offset,anchorEl:r.value,anchorOrigin:O.value,selfOrigin:z.value,absoluteOffset:v,fit:e.fit,cover:e.cover,maxHeight:e.maxHeight,maxWidth:e.maxWidth})}function te(){return w(Te,U.value,()=>l.value===!0?w("div",{role:"menu",...s,ref:i,tabindex:-1,class:["q-menu q-position-engine scroll"+G.value,s.class],style:[s.style,j.value],...X.value},xe(a.default)):null)}return Ce(b),Object.assign(g,{focus:y,updatePosition:f}),$}});function L(e){if(e===!1)return 0;if(e===!0||e===void 0)return 1;const a=parseInt(e,10);return isNaN(a)?0:a}var We=be({name:"close-popup",beforeMount(e,{value:a}){const o={depth:L(a),handler(s){o.depth!==0&&setTimeout(()=>{const n=Be(e);n!==void 0&&Fe(n,s,o.depth)})},handlerKey(s){Ke(s,13)===!0&&o.handler(s)}};e.__qclosepopup=o,e.addEventListener("click",o.handler),e.addEventListener("keyup",o.handlerKey)},updated(e,{value:a,oldValue:o}){a!==o&&(e.__qclosepopup.depth=L(a))},beforeUnmount(e){const a=e.__qclosepopup;e.removeEventListener("click",a.handler),e.removeEventListener("keyup",a.handlerKey),delete e.__qclosepopup}});export{We as C,Qe as Q};
