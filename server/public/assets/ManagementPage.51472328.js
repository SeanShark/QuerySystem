import{bx as se,c as ce,am as K,u as ue,f as re,j as me,k as be,r as I,ba as M,n as ge,a as v,w as Q,o as fe,d as m,g as ve,X as j,t as pe,br as Ve,x as _e,R as D,ah as he,H as xe,q as ke,J as V,K as h,L as o,N as t,Y as x,O as g,b3 as Ie,b4 as Ue,b5 as Ce,b7 as Pe,S as L,P as ye,be as B,T as P,U as y,W as S,bf as u,M as Se,Q as Ae}from"./index.7a6a3dd0.js";import{Q as Te,a as N}from"./QPage.8b300c16.js";import{Q as qe,b as z,a as O}from"./position-engine.9859a46c.js";import{Q as we}from"./QSlideTransition.207a261d.js";import{Q as Le}from"./QList.9cadff6f.js";import{u as $e}from"./store.a6b815dd.js";import"./axios.7331a07d.js";const k=se({}),Qe=Object.keys(K);var A=ce({name:"QExpansionItem",props:{...K,...ue,...re,icon:String,label:String,labelLines:[Number,String],caption:String,captionLines:[Number,String],dense:Boolean,toggleAriaLabel:String,expandIcon:String,expandedIcon:String,expandIconClass:[Array,String,Object],duration:Number,headerInsetLevel:Number,contentInsetLevel:Number,expandSeparator:Boolean,defaultOpened:Boolean,hideExpandIcon:Boolean,expandIconToggle:Boolean,switchToggleSide:Boolean,denseToggle:Boolean,group:String,popup:Boolean,headerStyle:[Array,String,Object],headerClass:[Array,String,Object]},emits:[...me,"click","afterShow","afterHide"],setup(a,{slots:r,emit:U}){const{proxy:{$q:f}}=ve(),_=be(a,f),b=I(a.modelValue!==null?a.modelValue:a.defaultOpened),i=I(null),s=M(),{show:$,hide:T,toggle:c}=ge({showing:b});let d,e;const C=v(()=>`q-expansion-item q-item-type q-expansion-item--${b.value===!0?"expanded":"collapsed"} q-expansion-item--${a.popup===!0?"popup":"standard"}`),l=v(()=>{if(a.contentInsetLevel===void 0)return null;const n=f.lang.rtl===!0?"Right":"Left";return{["padding"+n]:a.contentInsetLevel*56+"px"}}),q=v(()=>a.disable!==!0&&(a.href!==void 0||a.to!==void 0&&a.to!==null&&a.to!=="")),G=v(()=>{const n={};return Qe.forEach(p=>{n[p]=a[p]}),n}),F=v(()=>q.value===!0||a.expandIconToggle!==!0),J=v(()=>a.expandedIcon!==void 0&&b.value===!0?a.expandedIcon:a.expandIcon||f.iconSet.expansionItem[a.denseToggle===!0?"denseIcon":"icon"]),W=v(()=>a.disable!==!0&&(q.value===!0||a.expandIconToggle===!0)),X=v(()=>({expanded:b.value===!0,detailsId:a.targetUid,toggle:c,show:$,hide:T})),E=v(()=>{const n=a.toggleAriaLabel!==void 0?a.toggleAriaLabel:f.lang.label[b.value===!0?"collapse":"expand"](a.label);return{role:"button","aria-expanded":b.value===!0?"true":"false","aria-controls":s,"aria-label":n}});Q(()=>a.group,n=>{e!==void 0&&e(),n!==void 0&&R()});function Y(n){q.value!==!0&&c(n),U("click",n)}function Z(n){n.keyCode===13&&H(n,!0)}function H(n,p){p!==!0&&i.value!==null&&i.value.focus(),c(n),he(n)}function ee(){U("afterShow")}function le(){U("afterHide")}function R(){d===void 0&&(d=M()),b.value===!0&&(k[a.group]=d);const n=Q(b,w=>{w===!0?k[a.group]=d:k[a.group]===d&&delete k[a.group]}),p=Q(()=>k[a.group],(w,de)=>{de===d&&w!==void 0&&w!==d&&T()});e=()=>{n(),p(),k[a.group]===d&&delete k[a.group],e=void 0}}function ae(){const n={class:[`q-focusable relative-position cursor-pointer${a.denseToggle===!0&&a.switchToggleSide===!0?" items-end":""}`,a.expandIconClass],side:a.switchToggleSide!==!0,avatar:a.switchToggleSide},p=[m(D,{class:"q-expansion-item__toggle-icon"+(a.expandedIcon===void 0&&b.value===!0?" q-expansion-item__toggle-icon--rotated":""),name:J.value})];return W.value===!0&&(Object.assign(n,{tabindex:0,...E.value,onClick:H,onKeyup:Z}),p.unshift(m("div",{ref:i,class:"q-expansion-item__toggle-focus q-icon q-focus-helper q-focus-helper--rounded",tabindex:-1}))),m(O,n,()=>p)}function te(){let n;return r.header!==void 0?n=[].concat(r.header(X.value)):(n=[m(O,()=>[m(z,{lines:a.labelLines},()=>a.label||""),a.caption?m(z,{lines:a.captionLines,caption:!0},()=>a.caption):null])],a.icon&&n[a.switchToggleSide===!0?"push":"unshift"](m(O,{side:a.switchToggleSide===!0,avatar:a.switchToggleSide!==!0},()=>m(D,{name:a.icon})))),a.disable!==!0&&a.hideExpandIcon!==!0&&n[a.switchToggleSide===!0?"unshift":"push"](ae()),n}function ne(){const n={ref:"item",style:a.headerStyle,class:a.headerClass,dark:_.value,disable:a.disable,dense:a.dense,insetLevel:a.headerInsetLevel};return F.value===!0&&(n.clickable=!0,n.onClick=Y,Object.assign(n,q.value===!0?G.value:E.value)),m(qe,n,te)}function oe(){return pe(m("div",{key:"e-content",class:"q-expansion-item__content relative-position",style:l.value,id:s},_e(r.default)),[[Ve,b.value]])}function ie(){const n=[ne(),m(we,{duration:a.duration,onShow:ee,onHide:le},oe)];return a.expandSeparator===!0&&n.push(m(j,{class:"q-expansion-item__border q-expansion-item__border--top absolute-top",dark:_.value}),m(j,{class:"q-expansion-item__border q-expansion-item__border--bottom absolute-bottom",dark:_.value})),n}return a.group!==void 0&&R(),fe(()=>{e!==void 0&&e()}),()=>m("div",{class:C.value},[m("div",{class:"q-expansion-item__container relative-position"},ie())])}});const Be=g("h5",{class:"q-mt-none q-mb-md text-center lt-md"},"\u7BA1\u7406\u9875",-1),Ne=g("div",{class:"text-subtitle2"}," \u8FC7\u6EE4\uFF1A ",-1),Oe={class:"row q-gutter-md justify-center"},je=g("div",{class:"text-subtitle2"},"\u59D3\u540D\uFF1A",-1),De=g("div",{class:"text-subtitle2"},"\u7535\u8BDD\uFF1A",-1),Ee=g("div",{class:"text-subtitle2"},"\u6027\u522B\uFF1A",-1),He=g("div",{class:"text-subtitle2"},"\u751F\u65E5:",-1),Re=g("div",{class:"text-subtitle2"},"\u521B\u5EFA\u65F6\u95F4\uFF1A",-1),Me=g("div",{class:"text-subtitle2"},"\u6700\u540E\u767B\u5F55\uFF1A",-1),ze={class:"row justify-around"},Ze={__name:"ManagementPage",setup(a){const r=$e(),U=xe(),f=I([]),_=I(""),b=I(!1),i=I(!1),s=async(c,d,e)=>{if(b.value)return;if(!c||!d||typeof e!="boolean"){r.failureTip("\u53C2\u6570\u6709\u8BEF");return}i.value=!0;const C={id:c,field:d,value:e};await r.axios.post("/user/setuser",C).then(l=>{l.status===201&&r.successTip(l.data.msg)}).catch(l=>{r.failureTip(l.response.data.msg)}).finally(()=>{i.value=!1})},$=v(()=>{const c=_.value.toLowerCase().trim();return c?f.value.filter(d=>d.userInfo.email.toLowerCase().includes(c)):f.value}),T=async c=>{r.$q.dialog({title:"\u786E\u8BA4\u5220\u9664",message:"\u786E\u8BA4\u8981\u5220\u9664\u8BE5\u7528\u6237\u5417\uFF1F",cancel:!0,persistent:!0,ok:{push:!0,label:"\u786E\u5B9A",color:"green"},cancel:{push:!0,color:"grey",label:"\u53D6\u6D88"}}).onOk(async()=>{await r.axios.delete("/user/deleteuser",{params:{id:c}}).then(d=>{d.status===201&&(f.value=f.value.filter(e=>e._id!==c),r.successTip(d.data.msg))}).catch(d=>{r.failureTip(d.response.data.msg)})}).onCancel(()=>{}).onDismiss(()=>{})};return ke(async()=>{await r.verifyUser().then(()=>{r.user&&r.axios.post("/user/alluser").then(c=>{f.value=c.data}).catch(c=>{console.log(c.response.data.msg)})}).catch(()=>{U.push("/index")})}),(c,d)=>(V(),h(Te,{class:"q-pa-md"},{default:o(()=>[Be,t(x,{modelValue:_.value,"onUpdate:modelValue":d[0]||(d[0]=e=>_.value=e),dense:"",outlined:"",class:"q-py-md"},{before:o(()=>[Ne]),prepend:o(()=>[t(D,{name:"search"})]),_:1},8,["modelValue"]),g("div",Oe,[(V(!0),Ie(Ce,null,Ue($.value,(e,C)=>(V(),h(Le,{key:C,item:e,bordered:"",class:"rounded-borders col-12 col-md-5 col-lg-3 shadow-3"},{default:o(()=>[g("div",{class:Pe(["coloum text-center text-h6 q-pa-md",e.userInfo.banned?"text-strike":""])},[L(ye(e.userInfo.email)+" ",1),e.userPrivilege.superUser?(V(),h(B,{key:0,"text-color":"red",icon:"supervisor_account",size:"lg"},{default:o(()=>[t(N,null,{default:o(()=>[L(" \u7BA1\u7406\u5458 ")]),_:1})]),_:1})):P("",!0),e.userInfo.activationCode!=null?(V(),h(B,{key:1,"text-color":"warning",icon:"question_mark",size:"lg"},{default:o(()=>[t(N,null,{default:o(()=>[L(" \u7528\u6237\u672A\u6FC0\u6D3B ")]),_:1})]),_:1})):P("",!0),e.userInfo.banned?(V(),h(B,{key:2,"text-color":"grey",icon:"person_off",size:"lg"},{default:o(()=>[t(N,null,{default:o(()=>[L(" \u7528\u6237\u5DF2\u7981\u7528 ")]),_:1})]),_:1})):P("",!0)],2),t(j),t(A,{"expand-separator":"",icon:"perm_identity",label:"\u7528\u6237\u4FE1\u606F"},{default:o(()=>[t(y,{class:"shadow-3"},{default:o(()=>[t(S,null,{default:o(()=>[t(x,{modelValue:e.userInfo.name,"onUpdate:modelValue":l=>e.userInfo.name=l,dense:"",flat:"",readonly:"","item-aligned":""},{before:o(()=>[je]),_:2},1032,["modelValue","onUpdate:modelValue"]),t(x,{modelValue:e.userInfo.phone,"onUpdate:modelValue":l=>e.userInfo.phone=l,dense:"",flat:"",readonly:"","item-aligned":""},{before:o(()=>[De]),_:2},1032,["modelValue","onUpdate:modelValue"]),t(x,{modelValue:e.userInfo.gender,"onUpdate:modelValue":l=>e.userInfo.gender=l,dense:"",flat:"",readonly:"","item-aligned":""},{before:o(()=>[Ee]),_:2},1032,["modelValue","onUpdate:modelValue"]),t(x,{modelValue:e.userInfo.birth,"onUpdate:modelValue":l=>e.userInfo.birth=l,dense:"",flat:"",readonly:"","item-aligned":""},{before:o(()=>[He]),_:2},1032,["modelValue","onUpdate:modelValue"]),t(x,{modelValue:e.userInfo.createdAt,"onUpdate:modelValue":l=>e.userInfo.createdAt=l,dense:"",flat:"",readonly:"","item-aligned":""},{before:o(()=>[Re]),_:2},1032,["modelValue","onUpdate:modelValue"]),t(x,{modelValue:e.userInfo.lastLogin,"onUpdate:modelValue":l=>e.userInfo.lastLogin=l,dense:"",flat:"",readonly:"","item-aligned":""},{before:o(()=>[Me]),_:2},1032,["modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024)]),_:2},1024),t(A,{"expand-separator":"",icon:"task_alt",label:"\u64CD\u4F5C\u6743\u9650","header-class":"text-primary",disable:e.userInfo.banned},{default:o(()=>[t(y,null,{default:o(()=>[t(S,null,{default:o(()=>[e.userInfo.email!=="47262243@qq.com"?(V(),h(u,{key:0,modelValue:e.userPrivilege.superUser,"onUpdate:modelValue":l=>e.userPrivilege.superUser=l,name:"user.userPrivilege.superUser",color:"green",label:"\u7BA1\u7406\u5458","left-label":"",disable:i.value,onClick:l=>s(e._id,"userPrivilege.superUser",e.userPrivilege.superUser)},null,8,["modelValue","onUpdate:modelValue","disable","onClick"])):P("",!0),t(u,{modelValue:e.userPrivilege.read,"onUpdate:modelValue":l=>e.userPrivilege.read=l,name:"user.userPrivilege.read",color:"green",label:"\u8BFB\u53D6","left-label":"",disable:i.value,onClick:l=>s(e._id,"userPrivilege.read",e.userPrivilege.read)},null,8,["modelValue","onUpdate:modelValue","disable","onClick"]),t(u,{modelValue:e.userPrivilege.add,"onUpdate:modelValue":l=>e.userPrivilege.add=l,name:"user.userPrivilege.add",color:"green",label:"\u589E\u52A0","left-label":"",disable:i.value,onClick:l=>s(e._id,"userPrivilege.add",e.userPrivilege.add)},null,8,["modelValue","onUpdate:modelValue","disable","onClick"]),t(u,{modelValue:e.userPrivilege.edit,"onUpdate:modelValue":l=>e.userPrivilege.edit=l,name:"user.userPrivilege.edit",color:"green",label:"\u7F16\u8F91","left-label":"",disable:i.value,onClick:l=>s(e._id,"userPrivilege.edit",e.userPrivilege.edit)},null,8,["modelValue","onUpdate:modelValue","disable","onClick"]),t(u,{modelValue:e.userPrivilege.delete,"onUpdate:modelValue":l=>e.userPrivilege.delete=l,name:"user.userPrivilege.delete",color:"green",label:"\u5220\u9664","left-label":"",disable:i.value,onClick:l=>s(e._id,"userPrivilege.delete",e.userPrivilege.delete)},null,8,["modelValue","onUpdate:modelValue","disable","onClick"])]),_:2},1024)]),_:2},1024)]),_:2},1032,["disable"]),t(A,{"expand-separator":"",icon:"drafts",label:"\u8BBF\u95EE\u7C7B\u578B","header-class":"text-teal",disable:e.userInfo.banned},{default:o(()=>[t(y,null,{default:o(()=>[t(S,null,{default:o(()=>[t(u,{modelValue:e.databasePermissions.ip,"onUpdate:modelValue":l=>e.databasePermissions.ip=l,color:"green",label:"\u7EC8\u7AEF","left-label":"",disable:i.value,onClick:l=>s(e._id,"databasePermissions.ip",e.databasePermissions.ip)},null,8,["modelValue","onUpdate:modelValue","disable","onClick"]),t(u,{modelValue:e.databasePermissions.phone,"onUpdate:modelValue":l=>e.databasePermissions.phone=l,color:"green",label:"\u7535\u8BDD","left-label":"",disable:i.value,onClick:l=>s(e._id,"databasePermissions.phone",e.databasePermissions.phone)},null,8,["modelValue","onUpdate:modelValue","disable","onClick"]),t(u,{modelValue:e.databasePermissions.printer,"onUpdate:modelValue":l=>e.databasePermissions.printer=l,color:"green",label:"\u8017\u6750","left-label":"",disable:i.value,onClick:l=>s(e._id,"databasePermissions.printer",e.databasePermissions.printer)},null,8,["modelValue","onUpdate:modelValue","disable","onClick"]),t(u,{modelValue:e.databasePermissions.datacenter,"onUpdate:modelValue":l=>e.databasePermissions.datacenter=l,color:"green",label:"\u673A\u623F","left-label":"",disable:i.value,onClick:l=>s(e._id,"databasePermissions.datacenter",e.databasePermissions.datacenter)},null,8,["modelValue","onUpdate:modelValue","disable","onClick"]),t(u,{modelValue:e.databasePermissions.surveillance,"onUpdate:modelValue":l=>e.databasePermissions.surveillance=l,color:"green",label:"\u76D1\u63A7","left-label":"",disable:i.value,onClick:l=>s(e._id,"databasePermissions.surveillance",e.databasePermissions.surveillance)},null,8,["modelValue","onUpdate:modelValue","disable","onClick"])]),_:2},1024)]),_:2},1024)]),_:2},1032,["disable"]),t(A,{"expand-separator":"",icon:"place",label:"\u5730\u70B9\u63A7\u5236","header-class":"text-info",disable:e.userInfo.banned},{default:o(()=>[t(y,null,{default:o(()=>[t(S,null,{default:o(()=>[t(u,{modelValue:e.customerAccess.\u79BE\u82B1,"onUpdate:modelValue":l=>e.customerAccess.\u79BE\u82B1=l,color:"green",label:"\u79BE\u82B1","left-label":"",disable:i.value,onClick:l=>s(e._id,"customerAccess.\u79BE\u82B1",e.customerAccess.\u79BE\u82B1)},null,8,["modelValue","onUpdate:modelValue","disable","onClick"]),t(u,{modelValue:e.customerAccess.\u65B0\u5357,"onUpdate:modelValue":l=>e.customerAccess.\u65B0\u5357=l,color:"green",label:"\u65B0\u5357","left-label":"",disable:i.value,onClick:l=>s(e._id,"customerAccess.\u65B0\u5357",e.customerAccess.\u65B0\u5357)},null,8,["modelValue","onUpdate:modelValue","disable","onClick"]),t(u,{modelValue:e.customerAccess.\u9E45\u516C\u5CAD,"onUpdate:modelValue":l=>e.customerAccess.\u9E45\u516C\u5CAD=l,color:"green",label:"\u9E45\u516C\u5CAD","left-label":"",disable:i.value,onClick:l=>s(e._id,"customerAccess.\u9E45\u516C\u5CAD",e.customerAccess.\u9E45\u516C\u5CAD)},null,8,["modelValue","onUpdate:modelValue","disable","onClick"]),t(u,{modelValue:e.customerAccess.\u767D\u576D\u5751,"onUpdate:modelValue":l=>e.customerAccess.\u767D\u576D\u5751=l,color:"green",label:"\u767D\u576D\u5751","left-label":"",disable:i.value,onClick:l=>s(e._id,"customerAccess.\u767D\u576D\u5751",e.customerAccess.\u767D\u576D\u5751)},null,8,["modelValue","onUpdate:modelValue","disable","onClick"]),t(u,{modelValue:e.customerAccess.\u6167\u660E,"onUpdate:modelValue":l=>e.customerAccess.\u6167\u660E=l,color:"green",label:"\u6167\u660E","left-label":"",disable:i.value,onClick:l=>s(e._id,"customerAccess.\u6167\u660E",e.customerAccess.\u6167\u660E)},null,8,["modelValue","onUpdate:modelValue","disable","onClick"]),t(u,{modelValue:e.customerAccess.\u521B\u70B9,"onUpdate:modelValue":l=>e.customerAccess.\u521B\u70B9=l,color:"green",label:"\u521B\u70B9","left-label":"",disable:i.value,onClick:l=>s(e._id,"customerAccess.\u521B\u70B9",e.customerAccess.\u521B\u70B9)},null,8,["modelValue","onUpdate:modelValue","disable","onClick"])]),_:2},1024)]),_:2},1024)]),_:2},1032,["disable"]),e.userInfo.email!==Se(r).user.userInfo.email?(V(),h(A,{key:0,"expand-separator":"",icon:"manage_accounts",label:"\u8D26\u6237\u7BA1\u7406","header-class":"text-indigo",disable:e.userInfo.banned},{default:o(()=>[t(y,null,{default:o(()=>[t(S,null,{default:o(()=>[g("div",ze,[t(u,{modelValue:e.userInfo.banned,"onUpdate:modelValue":l=>e.userInfo.banned=l,color:"green",label:"\u7981\u7528\u8BE5\u8D26\u6237","left-label":"",disable:i.value,onClick:l=>s(e._id,"banned",e.userInfo.banned)},null,8,["modelValue","onUpdate:modelValue","disable","onClick"]),t(Ae,{label:"\u5220\u9664\u8BE5\u7528\u6237",color:"grey-4","text-color":"red",onClick:l=>T(e._id)},null,8,["onClick"])])]),_:2},1024)]),_:2},1024)]),_:2},1032,["disable"])):P("",!0)]),_:2},1032,["item"]))),128))])]),_:1}))}};export{Ze as default};
